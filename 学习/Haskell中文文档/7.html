<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.61" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://hahg2000.github.io/%E5%AD%A6%E4%B9%A0/Haskell%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/7.html"><meta property="og:title" content="ç¬¬ 7 ç« ï¼šI/O"><meta property="og:description" content="ç¬¬ 7 ç« ï¼šI/O å°±ç®—ä¸æ˜¯å…¨éƒ¨ï¼Œç»å¤§å¤šæ•°çš„ç¨‹åºå‘˜æ˜¾ç„¶è¿˜æ˜¯è‡´åŠ›äºä»å¤–ç•Œæ”¶é›†æ•°æ®ï¼Œå¤„ç†è¿™äº›æ•°æ®ï¼Œç„¶åæŠŠç»“æœä¼ å›å¤–ç•Œã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå…³é”®å°±æ˜¯è¾“å…¥è¾“å‡ºã€‚ Haskellçš„I/Oç³»ç»Ÿæ˜¯å¾ˆå¼ºå¤§å’Œå¯Œæœ‰è¡¨ç°åŠ›çš„ã€‚ å®ƒæ˜“äºä½¿ç”¨ï¼Œä¹Ÿå¾ˆæœ‰å¿…è¦å»ç†è§£ã€‚Haskellä¸¥æ ¼åœ°æŠŠçº¯ä»£ç ä»é‚£äº›ä¼šè®©å¤–éƒ¨ä¸–ç•Œå‘ç”Ÿäº‹æƒ…çš„ä»£ç ä¸­åˆ†éš”å¼€ã€‚å°±æ˜¯è¯´ï¼Œå®ƒç»™çº¯ä»£ç æä¾›äº†å®Œå…¨çš„å‰¯ä½œç”¨éš”ç¦»ã€‚é™¤äº†å¸®åŠ©ç¨‹åºå‘˜æ¨æ–­ä»–ä»¬è‡ªå·±ä»£ç çš„æ­£ç¡®æ€§ï¼Œå®ƒè¿˜ä½¿ç¼–è¯‘å™¨å¯ä»¥è‡ªåŠ¨é‡‡å–ä¼˜åŒ–å’Œå¹¶è¡ŒåŒ–æˆä¸ºå¯èƒ½ã€‚ æˆ‘ä»¬å°†ç”¨ç®€å•æ ‡å‡†çš„I/Oæ¥å¼€å§‹è¿™ä¸€ç« ã€‚ç„¶åæˆ‘ä»¬è¦è®¨è®ºä¸‹ä¸€äº›æ›´å¼ºå¤§çš„é€‰é¡¹ï¼Œä»¥åŠæä¾›æ›´å¤šI/Oæ˜¯æ€ä¹ˆé€‚åº”çº¯çš„ï¼Œæƒ°æ€§çš„ï¼Œå‡½æ•°å¼çš„Haskellä¸–ç•Œçš„ç»†èŠ‚ã€‚"><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2023-12-17T11:18:34.000Z"><meta property="article:modified_time" content="2023-12-17T11:18:34.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"ç¬¬ 7 ç« ï¼šI/O","image":[""],"dateModified":"2023-12-17T11:18:34.000Z","author":[]}</script><title>ç¬¬ 7 ç« ï¼šI/O</title><meta name="description" content="ç¬¬ 7 ç« ï¼šI/O å°±ç®—ä¸æ˜¯å…¨éƒ¨ï¼Œç»å¤§å¤šæ•°çš„ç¨‹åºå‘˜æ˜¾ç„¶è¿˜æ˜¯è‡´åŠ›äºä»å¤–ç•Œæ”¶é›†æ•°æ®ï¼Œå¤„ç†è¿™äº›æ•°æ®ï¼Œç„¶åæŠŠç»“æœä¼ å›å¤–ç•Œã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå…³é”®å°±æ˜¯è¾“å…¥è¾“å‡ºã€‚ Haskellçš„I/Oç³»ç»Ÿæ˜¯å¾ˆå¼ºå¤§å’Œå¯Œæœ‰è¡¨ç°åŠ›çš„ã€‚ å®ƒæ˜“äºä½¿ç”¨ï¼Œä¹Ÿå¾ˆæœ‰å¿…è¦å»ç†è§£ã€‚Haskellä¸¥æ ¼åœ°æŠŠçº¯ä»£ç ä»é‚£äº›ä¼šè®©å¤–éƒ¨ä¸–ç•Œå‘ç”Ÿäº‹æƒ…çš„ä»£ç ä¸­åˆ†éš”å¼€ã€‚å°±æ˜¯è¯´ï¼Œå®ƒç»™çº¯ä»£ç æä¾›äº†å®Œå…¨çš„å‰¯ä½œç”¨éš”ç¦»ã€‚é™¤äº†å¸®åŠ©ç¨‹åºå‘˜æ¨æ–­ä»–ä»¬è‡ªå·±ä»£ç çš„æ­£ç¡®æ€§ï¼Œå®ƒè¿˜ä½¿ç¼–è¯‘å™¨å¯ä»¥è‡ªåŠ¨é‡‡å–ä¼˜åŒ–å’Œå¹¶è¡ŒåŒ–æˆä¸ºå¯èƒ½ã€‚ æˆ‘ä»¬å°†ç”¨ç®€å•æ ‡å‡†çš„I/Oæ¥å¼€å§‹è¿™ä¸€ç« ã€‚ç„¶åæˆ‘ä»¬è¦è®¨è®ºä¸‹ä¸€äº›æ›´å¼ºå¤§çš„é€‰é¡¹ï¼Œä»¥åŠæä¾›æ›´å¤šI/Oæ˜¯æ€ä¹ˆé€‚åº”çº¯çš„ï¼Œæƒ°æ€§çš„ï¼Œå‡½æ•°å¼çš„Haskellä¸–ç•Œçš„ç»†èŠ‚ã€‚">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d1e1f;
      }

      html,
      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="preload" href="/assets/style-ab8bf0f6.css" as="style"><link rel="stylesheet" href="/assets/style-ab8bf0f6.css">
    <link rel="modulepreload" href="/assets/app-2f283e0c.js"><link rel="modulepreload" href="/assets/framework-0bc3c581.js"><link rel="modulepreload" href="/assets/7.html-22f9dc39.js"><link rel="modulepreload" href="/assets/7.html-db8fe707.js"><link rel="prefetch" href="/assets/index.html-9df45166.js" as="script"><link rel="prefetch" href="/assets/intro.html-adbbf85d.js" as="script"><link rel="prefetch" href="/assets/slides.html-7f638638.js" as="script"><link rel="prefetch" href="/assets/index.html-3ab04f5b.js" as="script"><link rel="prefetch" href="/assets/disable.html-d80e5a91.js" as="script"><link rel="prefetch" href="/assets/encrypt.html-06c77061.js" as="script"><link rel="prefetch" href="/assets/markdown.html-11a50f88.js" as="script"><link rel="prefetch" href="/assets/page.html-6d440c97.js" as="script"><link rel="prefetch" href="/assets/cherry.html-b82e5dcd.js" as="script"><link rel="prefetch" href="/assets/dragonfruit.html-795be693.js" as="script"><link rel="prefetch" href="/assets/strawberry.html-4bc18b47.js" as="script"><link rel="prefetch" href="/assets/tomato.html-02af87f0.js" as="script"><link rel="prefetch" href="/assets/index.html-2e360864.js" as="script"><link rel="prefetch" href="/assets/çœ‹ç•ªæ—¶é—´è½´.html-595fe83f.js" as="script"><link rel="prefetch" href="/assets/1.html-276cd7b0.js" as="script"><link rel="prefetch" href="/assets/2.html-849f10d5.js" as="script"><link rel="prefetch" href="/assets/3.html-7d86b04d.js" as="script"><link rel="prefetch" href="/assets/4.html-99899815.js" as="script"><link rel="prefetch" href="/assets/1.html-7ba0c550.js" as="script"><link rel="prefetch" href="/assets/2.html-ff39ab51.js" as="script"><link rel="prefetch" href="/assets/3.html-10475dc5.js" as="script"><link rel="prefetch" href="/assets/4.html-762a2722.js" as="script"><link rel="prefetch" href="/assets/1.html-2f127a72.js" as="script"><link rel="prefetch" href="/assets/10.html-3f2d6160.js" as="script"><link rel="prefetch" href="/assets/2.html-ba1e89f2.js" as="script"><link rel="prefetch" href="/assets/3.html-6aab9138.js" as="script"><link rel="prefetch" href="/assets/4.html-e5dba378.js" as="script"><link rel="prefetch" href="/assets/5.html-349d5069.js" as="script"><link rel="prefetch" href="/assets/6.html-28d01c2a.js" as="script"><link rel="prefetch" href="/assets/8.html-18ecc1fb.js" as="script"><link rel="prefetch" href="/assets/9.html-8af46d59.js" as="script"><link rel="prefetch" href="/assets/index.html-ee05ccd0.js" as="script"><link rel="prefetch" href="/assets/é‡å­¦CSS-ä¸Š.html-0770cf73.js" as="script"><link rel="prefetch" href="/assets/é‡å­¦CSS-ä¸­.html-1af91934.js" as="script"><link rel="prefetch" href="/assets/é‡å­¦HTML-ä¸Š.html-d68447f3.js" as="script"><link rel="prefetch" href="/assets/é‡å­¦HTML-ä¸‹.html-1787ce5a.js" as="script"><link rel="prefetch" href="/assets/é”™é¢˜ä¸€.html-200f929c.js" as="script"><link rel="prefetch" href="/assets/é¢è¯•é¢˜ä¸€.html-47cd9406.js" as="script"><link rel="prefetch" href="/assets/SQLé€Ÿè®°.html-f882422f.js" as="script"><link rel="prefetch" href="/assets/Gitå­¦ä¹ .html-7401275c.js" as="script"><link rel="prefetch" href="/assets/ç¼–ç¨‹è§„èŒƒ.html-58fb792d.js" as="script"><link rel="prefetch" href="/assets/index.html-ab3bec7a.js" as="script"><link rel="prefetch" href="/assets/ç®—æ³•ä¸€-6æœˆ24.html-9207e104.js" as="script"><link rel="prefetch" href="/assets/ç®—æ³•ä¸ƒ.html-71570a22.js" as="script"><link rel="prefetch" href="/assets/ç®—æ³•ä¸‰-7æœˆ28.html-00aca81f.js" as="script"><link rel="prefetch" href="/assets/ç®—æ³•äºŒ-7æœˆ11.html-8b6980e9.js" as="script"><link rel="prefetch" href="/assets/ç®—æ³•äº”-8æœˆ28.html-e98a0560.js" as="script"><link rel="prefetch" href="/assets/ç®—æ³•å…­-10æœˆ3.html-d2e63f98.js" as="script"><link rel="prefetch" href="/assets/ç®—æ³•å››-8æœˆ11-åŠ¨æ€è§„åˆ’åˆé›†.html-45425672.js" as="script"><link rel="prefetch" href="/assets/Vue-ä¸Š.html-cdb1e86c.js" as="script"><link rel="prefetch" href="/assets/Vue-ä¸‹ä¹‹æºç åˆ†æ.html-cfaf3f55.js" as="script"><link rel="prefetch" href="/assets/Vue-ä¸­ä¹‹é¡¹ç›®å¼€å‘.html-d57d84e3.js" as="script"><link rel="prefetch" href="/assets/jQuery-ä¸Š.html-a9ca9cdf.js" as="script"><link rel="prefetch" href="/assets/jQuery-ä¸‹.html-7e47047e.js" as="script"><link rel="prefetch" href="/assets/jQuery-ä¸­.html-c7a042db.js" as="script"><link rel="prefetch" href="/assets/ES6-ä¸Š.html-f92c9a52.js" as="script"><link rel="prefetch" href="/assets/ES6-ä¸­.html-93da71e0.js" as="script"><link rel="prefetch" href="/assets/åŸç”ŸJS-ä¸‹.html-6c91736e.js" as="script"><link rel="prefetch" href="/assets/åŸç”ŸJSé«˜çº§-ä¸Š.html-68422655.js" as="script"><link rel="prefetch" href="/assets/åŸç”ŸJSé«˜çº§-ä¸­.html-d8bffee8.js" as="script"><link rel="prefetch" href="/assets/Node-ä¸Šä¹‹åŸºæœ¬çŸ¥è¯†.html-0934aaff.js" as="script"><link rel="prefetch" href="/assets/Node-ä¸‹ä¹‹ç»¼åˆWebé¡¹ç›®.html-36d2a263.js" as="script"><link rel="prefetch" href="/assets/Node-ä¸­ä¹‹æ¡†æ¶ä½¿ç”¨.html-89176d5b.js" as="script"><link rel="prefetch" href="/assets/ä¸€ã€å…¥é—¨.html-43476536.js" as="script"><link rel="prefetch" href="/assets/ä¸€ã€MyBatiså…¥é—¨.html-271cb533.js" as="script"><link rel="prefetch" href="/assets/äºŒã€å•è¡¨çš„ CURD æ“ä½œ.html-fe7c5e66.js" as="script"><link rel="prefetch" href="/assets/äº”ã€Mybatisæ³¨è§£å¼å¼€å‘.html-ca54046f.js" as="script"><link rel="prefetch" href="/assets/å››ã€æŸ¥è¯¢ç¼“å­˜.html-52cf5ba5.js" as="script"><link rel="prefetch" href="/assets/ä¸€ã€SSMæ¡†æ¶å‰è¨€-ç³»ç»Ÿæ¶æ„.html-382de181.js" as="script"><link rel="prefetch" href="/assets/ä¸‰ã€SSMæ¡†æ¶å‰è¨€-ä»£ç†æ¨¡å¼.html-9e9961e1.js" as="script"><link rel="prefetch" href="/assets/äº”ã€SSMæ¡†æ¶å‰è¨€-æ¨¡æ¿æ–¹æ³•è®¾è®¡æ¨¡å¼.html-a32252a1.js" as="script"><link rel="prefetch" href="/assets/å…­ã€JUnitæµ‹è¯•.html-403114f5.js" as="script"><link rel="prefetch" href="/assets/ä¸€ã€Springæ¦‚è¿°.html-ba031fdc.js" as="script"><link rel="prefetch" href="/assets/ä¸‰ã€Springä¸AOP.html-f93458aa.js" as="script"><link rel="prefetch" href="/assets/äºŒã€Springä¸IoC.html-655c6465.js" as="script"><link rel="prefetch" href="/assets/äº”ã€Springä¸MyBatis.html-09d6b6cb.js" as="script"><link rel="prefetch" href="/assets/å…­ã€Springä¸Web.html-995200ab.js" as="script"><link rel="prefetch" href="/assets/ä¸€ã€SpringMVCæ¦‚è¿°.html-7c5c24f6.js" as="script"><link rel="prefetch" href="/assets/ä¸‰ã€SpringMVCæ³¨è§£å¼å¼€å‘.html-a0d5c2aa.js" as="script"><link rel="prefetch" href="/assets/äºŒã€SpringMVCé…ç½®å¼å¼€å‘.html-70a08a4f.js" as="script"><link rel="prefetch" href="/assets/404.html-efcc4ebc.js" as="script"><link rel="prefetch" href="/assets/index.html-bd04a936.js" as="script"><link rel="prefetch" href="/assets/index.html-6f92be97.js" as="script"><link rel="prefetch" href="/assets/index.html-6c35a0bc.js" as="script"><link rel="prefetch" href="/assets/index.html-1e5f0076.js" as="script"><link rel="prefetch" href="/assets/index.html-bf280449.js" as="script"><link rel="prefetch" href="/assets/index.html-81aecb1c.js" as="script"><link rel="prefetch" href="/assets/index.html-3d87b291.js" as="script"><link rel="prefetch" href="/assets/index.html-97643c41.js" as="script"><link rel="prefetch" href="/assets/index.html-c905224a.js" as="script"><link rel="prefetch" href="/assets/index.html-f0da6d98.js" as="script"><link rel="prefetch" href="/assets/index.html-2c8bb604.js" as="script"><link rel="prefetch" href="/assets/index.html-b3c88545.js" as="script"><link rel="prefetch" href="/assets/index.html-4ae9c5d9.js" as="script"><link rel="prefetch" href="/assets/index.html-76586c71.js" as="script"><link rel="prefetch" href="/assets/index.html-aa72d960.js" as="script"><link rel="prefetch" href="/assets/index.html-c20dbb5c.js" as="script"><link rel="prefetch" href="/assets/index.html-93e2d5b2.js" as="script"><link rel="prefetch" href="/assets/index.html-141ec11b.js" as="script"><link rel="prefetch" href="/assets/index.html-78921856.js" as="script"><link rel="prefetch" href="/assets/index.html-90b68312.js" as="script"><link rel="prefetch" href="/assets/index.html-b1b6febe.js" as="script"><link rel="prefetch" href="/assets/index.html-7e39f4a3.js" as="script"><link rel="prefetch" href="/assets/index.html-65f13d8b.js" as="script"><link rel="prefetch" href="/assets/index.html-46f1fd5e.js" as="script"><link rel="prefetch" href="/assets/index.html-f74a679d.js" as="script"><link rel="prefetch" href="/assets/index.html-58bda7ed.js" as="script"><link rel="prefetch" href="/assets/index.html-6000d147.js" as="script"><link rel="prefetch" href="/assets/index.html-f61bc6c6.js" as="script"><link rel="prefetch" href="/assets/index.html-6653f22b.js" as="script"><link rel="prefetch" href="/assets/index.html-b960d5c5.js" as="script"><link rel="prefetch" href="/assets/index.html-26872c0c.js" as="script"><link rel="prefetch" href="/assets/index.html-26a45014.js" as="script"><link rel="prefetch" href="/assets/index.html-24ae2900.js" as="script"><link rel="prefetch" href="/assets/index.html-c949d1bd.js" as="script"><link rel="prefetch" href="/assets/index.html-0d148fa7.js" as="script"><link rel="prefetch" href="/assets/index.html-de7271a1.js" as="script"><link rel="prefetch" href="/assets/index.html-303ab87b.js" as="script"><link rel="prefetch" href="/assets/index.html-49058c9d.js" as="script"><link rel="prefetch" href="/assets/index.html-b3a32933.js" as="script"><link rel="prefetch" href="/assets/index.html-d25738e1.js" as="script"><link rel="prefetch" href="/assets/index.html-62bf9664.js" as="script"><link rel="prefetch" href="/assets/index.html-af24ef5c.js" as="script"><link rel="prefetch" href="/assets/index.html-b4c58504.js" as="script"><link rel="prefetch" href="/assets/index.html-1f6e8605.js" as="script"><link rel="prefetch" href="/assets/index.html-48a5c7a9.js" as="script"><link rel="prefetch" href="/assets/index.html-a2542a15.js" as="script"><link rel="prefetch" href="/assets/intro.html-0e3a0a94.js" as="script"><link rel="prefetch" href="/assets/slides.html-c46f1fa5.js" as="script"><link rel="prefetch" href="/assets/index.html-96088dc1.js" as="script"><link rel="prefetch" href="/assets/disable.html-6c8e9d4a.js" as="script"><link rel="prefetch" href="/assets/encrypt.html-bb38061b.js" as="script"><link rel="prefetch" href="/assets/markdown.html-4b1416c3.js" as="script"><link rel="prefetch" href="/assets/page.html-c52847ad.js" as="script"><link rel="prefetch" href="/assets/cherry.html-1910e521.js" as="script"><link rel="prefetch" href="/assets/dragonfruit.html-900e0fa2.js" as="script"><link rel="prefetch" href="/assets/strawberry.html-3b3dcb67.js" as="script"><link rel="prefetch" href="/assets/tomato.html-56c553fc.js" as="script"><link rel="prefetch" href="/assets/index.html-c21f464d.js" as="script"><link rel="prefetch" href="/assets/çœ‹ç•ªæ—¶é—´è½´.html-c616c056.js" as="script"><link rel="prefetch" href="/assets/1.html-ce58a1ec.js" as="script"><link rel="prefetch" href="/assets/2.html-00cbb83a.js" as="script"><link rel="prefetch" href="/assets/3.html-2048db5d.js" as="script"><link rel="prefetch" href="/assets/4.html-be2ec801.js" as="script"><link rel="prefetch" href="/assets/1.html-91a450b8.js" as="script"><link rel="prefetch" href="/assets/2.html-c885e308.js" as="script"><link rel="prefetch" href="/assets/3.html-55c7ca4b.js" as="script"><link rel="prefetch" href="/assets/4.html-9139a7a6.js" as="script"><link rel="prefetch" href="/assets/1.html-ffe0c455.js" as="script"><link rel="prefetch" href="/assets/10.html-4b603992.js" as="script"><link rel="prefetch" href="/assets/2.html-70fb7a43.js" as="script"><link rel="prefetch" href="/assets/3.html-07bdeaeb.js" as="script"><link rel="prefetch" href="/assets/4.html-543a36e2.js" as="script"><link rel="prefetch" href="/assets/5.html-35710787.js" as="script"><link rel="prefetch" href="/assets/6.html-7700904a.js" as="script"><link rel="prefetch" href="/assets/8.html-4e8390f7.js" as="script"><link rel="prefetch" href="/assets/9.html-da45aa11.js" as="script"><link rel="prefetch" href="/assets/index.html-5a242ae6.js" as="script"><link rel="prefetch" href="/assets/é‡å­¦CSS-ä¸Š.html-342c2455.js" as="script"><link rel="prefetch" href="/assets/é‡å­¦CSS-ä¸­.html-04311e7a.js" as="script"><link rel="prefetch" href="/assets/é‡å­¦HTML-ä¸Š.html-afe7de8e.js" as="script"><link rel="prefetch" href="/assets/é‡å­¦HTML-ä¸‹.html-9c3d1244.js" as="script"><link rel="prefetch" href="/assets/é”™é¢˜ä¸€.html-48cd8b87.js" as="script"><link rel="prefetch" href="/assets/é¢è¯•é¢˜ä¸€.html-13340517.js" as="script"><link rel="prefetch" href="/assets/SQLé€Ÿè®°.html-f0b780d2.js" as="script"><link rel="prefetch" href="/assets/Gitå­¦ä¹ .html-cd4eec14.js" as="script"><link rel="prefetch" href="/assets/ç¼–ç¨‹è§„èŒƒ.html-3512881a.js" as="script"><link rel="prefetch" href="/assets/index.html-6c1e2f4d.js" as="script"><link rel="prefetch" href="/assets/ç®—æ³•ä¸€-6æœˆ24.html-48e284f5.js" as="script"><link rel="prefetch" href="/assets/ç®—æ³•ä¸ƒ.html-24f23d69.js" as="script"><link rel="prefetch" href="/assets/ç®—æ³•ä¸‰-7æœˆ28.html-171f529f.js" as="script"><link rel="prefetch" href="/assets/ç®—æ³•äºŒ-7æœˆ11.html-e0d3275c.js" as="script"><link rel="prefetch" href="/assets/ç®—æ³•äº”-8æœˆ28.html-f4ef53d2.js" as="script"><link rel="prefetch" href="/assets/ç®—æ³•å…­-10æœˆ3.html-fac88cf9.js" as="script"><link rel="prefetch" href="/assets/ç®—æ³•å››-8æœˆ11-åŠ¨æ€è§„åˆ’åˆé›†.html-e8f73f5c.js" as="script"><link rel="prefetch" href="/assets/Vue-ä¸Š.html-931622d1.js" as="script"><link rel="prefetch" href="/assets/Vue-ä¸‹ä¹‹æºç åˆ†æ.html-5c3a16aa.js" as="script"><link rel="prefetch" href="/assets/Vue-ä¸­ä¹‹é¡¹ç›®å¼€å‘.html-2ac7290b.js" as="script"><link rel="prefetch" href="/assets/jQuery-ä¸Š.html-ab024659.js" as="script"><link rel="prefetch" href="/assets/jQuery-ä¸‹.html-0370e9e1.js" as="script"><link rel="prefetch" href="/assets/jQuery-ä¸­.html-ae849b87.js" as="script"><link rel="prefetch" href="/assets/ES6-ä¸Š.html-f2be8bab.js" as="script"><link rel="prefetch" href="/assets/ES6-ä¸­.html-e74d8a0e.js" as="script"><link rel="prefetch" href="/assets/åŸç”ŸJS-ä¸‹.html-add4807a.js" as="script"><link rel="prefetch" href="/assets/åŸç”ŸJSé«˜çº§-ä¸Š.html-4e665d5d.js" as="script"><link rel="prefetch" href="/assets/åŸç”ŸJSé«˜çº§-ä¸­.html-c4949f16.js" as="script"><link rel="prefetch" href="/assets/Node-ä¸Šä¹‹åŸºæœ¬çŸ¥è¯†.html-bd48d4f2.js" as="script"><link rel="prefetch" href="/assets/Node-ä¸‹ä¹‹ç»¼åˆWebé¡¹ç›®.html-ede8b33f.js" as="script"><link rel="prefetch" href="/assets/Node-ä¸­ä¹‹æ¡†æ¶ä½¿ç”¨.html-3ecd7b29.js" as="script"><link rel="prefetch" href="/assets/ä¸€ã€å…¥é—¨.html-87eb92ff.js" as="script"><link rel="prefetch" href="/assets/ä¸€ã€MyBatiså…¥é—¨.html-7439291f.js" as="script"><link rel="prefetch" href="/assets/äºŒã€å•è¡¨çš„ CURD æ“ä½œ.html-ee016dbd.js" as="script"><link rel="prefetch" href="/assets/äº”ã€Mybatisæ³¨è§£å¼å¼€å‘.html-16c45e66.js" as="script"><link rel="prefetch" href="/assets/å››ã€æŸ¥è¯¢ç¼“å­˜.html-cfae64dd.js" as="script"><link rel="prefetch" href="/assets/ä¸€ã€SSMæ¡†æ¶å‰è¨€-ç³»ç»Ÿæ¶æ„.html-80eca685.js" as="script"><link rel="prefetch" href="/assets/ä¸‰ã€SSMæ¡†æ¶å‰è¨€-ä»£ç†æ¨¡å¼.html-e1caba00.js" as="script"><link rel="prefetch" href="/assets/äº”ã€SSMæ¡†æ¶å‰è¨€-æ¨¡æ¿æ–¹æ³•è®¾è®¡æ¨¡å¼.html-39b04b99.js" as="script"><link rel="prefetch" href="/assets/å…­ã€JUnitæµ‹è¯•.html-76bafbaf.js" as="script"><link rel="prefetch" href="/assets/ä¸€ã€Springæ¦‚è¿°.html-08ef918a.js" as="script"><link rel="prefetch" href="/assets/ä¸‰ã€Springä¸AOP.html-af5faaa2.js" as="script"><link rel="prefetch" href="/assets/äºŒã€Springä¸IoC.html-11ef3a07.js" as="script"><link rel="prefetch" href="/assets/äº”ã€Springä¸MyBatis.html-99fdc89f.js" as="script"><link rel="prefetch" href="/assets/å…­ã€Springä¸Web.html-1cc20aee.js" as="script"><link rel="prefetch" href="/assets/ä¸€ã€SpringMVCæ¦‚è¿°.html-10fe1df4.js" as="script"><link rel="prefetch" href="/assets/ä¸‰ã€SpringMVCæ³¨è§£å¼å¼€å‘.html-548eab08.js" as="script"><link rel="prefetch" href="/assets/äºŒã€SpringMVCé…ç½®å¼å¼€å‘.html-5f176ceb.js" as="script"><link rel="prefetch" href="/assets/404.html-3983e255.js" as="script"><link rel="prefetch" href="/assets/index.html-6765b87b.js" as="script"><link rel="prefetch" href="/assets/index.html-58f620f5.js" as="script"><link rel="prefetch" href="/assets/index.html-9fe7551c.js" as="script"><link rel="prefetch" href="/assets/index.html-873e4041.js" as="script"><link rel="prefetch" href="/assets/index.html-0bdf1a93.js" as="script"><link rel="prefetch" href="/assets/index.html-cdf863ac.js" as="script"><link rel="prefetch" href="/assets/index.html-6a3c1a9d.js" as="script"><link rel="prefetch" href="/assets/index.html-1531aedb.js" as="script"><link rel="prefetch" href="/assets/index.html-c7bee957.js" as="script"><link rel="prefetch" href="/assets/index.html-c87fb8e7.js" as="script"><link rel="prefetch" href="/assets/index.html-dcfa8837.js" as="script"><link rel="prefetch" href="/assets/index.html-ad1e451f.js" as="script"><link rel="prefetch" href="/assets/index.html-64fd6aef.js" as="script"><link rel="prefetch" href="/assets/index.html-e3941249.js" as="script"><link rel="prefetch" href="/assets/index.html-5fb822c8.js" as="script"><link rel="prefetch" href="/assets/index.html-02d89180.js" as="script"><link rel="prefetch" href="/assets/index.html-cc8b4310.js" as="script"><link rel="prefetch" href="/assets/index.html-1a50878f.js" as="script"><link rel="prefetch" href="/assets/index.html-32b97a04.js" as="script"><link rel="prefetch" href="/assets/index.html-584974e7.js" as="script"><link rel="prefetch" href="/assets/index.html-14ccab1e.js" as="script"><link rel="prefetch" href="/assets/index.html-1f214b66.js" as="script"><link rel="prefetch" href="/assets/index.html-f150d250.js" as="script"><link rel="prefetch" href="/assets/index.html-cf1ab53a.js" as="script"><link rel="prefetch" href="/assets/index.html-7d5ca31e.js" as="script"><link rel="prefetch" href="/assets/index.html-8211b2d9.js" as="script"><link rel="prefetch" href="/assets/index.html-ab2884cb.js" as="script"><link rel="prefetch" href="/assets/index.html-d1fab6fe.js" as="script"><link rel="prefetch" href="/assets/index.html-b7c8eb3a.js" as="script"><link rel="prefetch" href="/assets/index.html-54c80a17.js" as="script"><link rel="prefetch" href="/assets/index.html-f4d43e4f.js" as="script"><link rel="prefetch" href="/assets/index.html-4311916c.js" as="script"><link rel="prefetch" href="/assets/index.html-d7f37f62.js" as="script"><link rel="prefetch" href="/assets/index.html-c5276b56.js" as="script"><link rel="prefetch" href="/assets/index.html-93c33bee.js" as="script"><link rel="prefetch" href="/assets/index.html-08dc8ff8.js" as="script"><link rel="prefetch" href="/assets/index.html-35dc1e46.js" as="script"><link rel="prefetch" href="/assets/index.html-0774687b.js" as="script"><link rel="prefetch" href="/assets/index.html-40d20088.js" as="script"><link rel="prefetch" href="/assets/index.html-20910d66.js" as="script"><link rel="prefetch" href="/assets/index.html-e4a30286.js" as="script"><link rel="prefetch" href="/assets/index.html-b1b854bf.js" as="script"><link rel="prefetch" href="/assets/index.html-743d5d41.js" as="script"><link rel="prefetch" href="/assets/index.html-4a1f0917.js" as="script"><link rel="prefetch" href="/assets/index.html-30932015.js" as="script"><link rel="prefetch" href="/assets/giscus-9b97f17f.js" as="script"><link rel="prefetch" href="/assets/auto-ba5ecab5.js" as="script"><link rel="prefetch" href="/assets/index-8764208e.js" as="script"><link rel="prefetch" href="/assets/flowchart-35969cab.js" as="script"><link rel="prefetch" href="/assets/mermaid.core-5575ed6d.js" as="script"><link rel="prefetch" href="/assets/highlight.esm-a794bb63.js" as="script"><link rel="prefetch" href="/assets/markdown.esm-d92a2fc9.js" as="script"><link rel="prefetch" href="/assets/math.esm-70a288c8.js" as="script"><link rel="prefetch" href="/assets/notes.esm-224f94d9.js" as="script"><link rel="prefetch" href="/assets/reveal.esm-e5069ce0.js" as="script"><link rel="prefetch" href="/assets/search.esm-2c3fba7d.js" as="script"><link rel="prefetch" href="/assets/zoom.esm-b83b91d0.js" as="script"><link rel="prefetch" href="/assets/VuePlayground-f67bb3e9.js" as="script"><link rel="prefetch" href="/assets/photoswipe.esm-6e6cbe40.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">è·³è‡³ä¸»è¦å…§å®¹</a><!--]--><!--[--><div class="theme-container has-toc"><!--[--><header class="navbar" id="navbar"><div class="navbar-start"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><a href="/" class="brand"><img class="logo" src="/logo.svg" alt><!----><!----></a><!--[--><!----><!--]--></div><div class="navbar-center"><!--[--><!----><!--]--><nav class="nav-links"><div class="nav-item hide-in-mobile"><a href="/%E5%AD%A6%E4%B9%A0/" class="nav-link active" aria-label="å­¦ä¹ "><span class="font-icon icon iconfont icon-creative" style=""></span>å­¦ä¹ <!----></a></div><div class="nav-item hide-in-mobile"><a href="/%E6%97%A5%E5%B8%B8/" class="nav-link" aria-label="æ—¥å¸¸"><span class="font-icon icon iconfont icon-edit" style=""></span>æ—¥å¸¸<!----></a></div><div class="nav-item hide-in-mobile"><a href="https://vuepress-theme-hope.github.io/v2/zh/" rel="noopener noreferrer" target="_blank" aria-label="å…³äºæˆ‘" class="nav-link"><span class="font-icon icon iconfont icon-light" style=""></span>å…³äºæˆ‘<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="nav-item hide-in-mobile"><a href="/timeline/" class="nav-link" aria-label="æ—¶é—´è½´"><span class="font-icon icon iconfont icon-time" style=""></span>æ—¶é—´è½´<!----></a></div><div class="nav-item hide-in-mobile"><a href="https://vuepress-theme-hope.github.io/v2/zh/" rel="noopener noreferrer" target="_blank" aria-label="å¸¸ç”¨é“¾æ¥" class="nav-link"><span class="font-icon icon iconfont icon-network" style=""></span>å¸¸ç”¨é“¾æ¥<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div></nav><!--[--><!----><!--]--></div><div class="navbar-end"><!--[--><!----><!--]--><!----><div class="nav-item"><a class="repo-link" href="https://github.com/vuepress-theme-hope/vuepress-theme-hope" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!----><!--[--><!----><!--]--><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside class="sidebar" id="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><section class="sidebar-group"><button class="sidebar-heading clickable active"><!----><span class="title">Haskellä¸­æ–‡æ–‡æ¡£</span><span class="arrow down"></span></button><ul class="sidebar-links"><li><!--[--><a href="/%E5%AD%A6%E4%B9%A0/Haskell%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/1.html" class="nav-link sidebar-link sidebar-page" aria-label="ç¬¬ 1 ç« ï¼šå…¥é—¨"><!---->ç¬¬ 1 ç« ï¼šå…¥é—¨<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/%E5%AD%A6%E4%B9%A0/Haskell%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/2.html" class="nav-link sidebar-link sidebar-page" aria-label="ç¬¬ 2 ç« ï¼šç±»å‹å’Œå‡½æ•°"><!---->ç¬¬ 2 ç« ï¼šç±»å‹å’Œå‡½æ•°<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/%E5%AD%A6%E4%B9%A0/Haskell%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/3.html" class="nav-link sidebar-link sidebar-page" aria-label="ç¬¬ 3 ç« ï¼šå®šä¹‰ç±»å‹å¹¶ç®€åŒ–å‡½æ•°"><!---->ç¬¬ 3 ç« ï¼šå®šä¹‰ç±»å‹å¹¶ç®€åŒ–å‡½æ•°<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/%E5%AD%A6%E4%B9%A0/Haskell%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/4.html" class="nav-link sidebar-link sidebar-page" aria-label="ç¬¬ 4 ç« ï¼šå‡½æ•°å¼ç¼–ç¨‹"><!---->ç¬¬ 4 ç« ï¼šå‡½æ•°å¼ç¼–ç¨‹<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/%E5%AD%A6%E4%B9%A0/Haskell%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/5.html" class="nav-link sidebar-link sidebar-page" aria-label="ç¬¬ 5 ç« ï¼šç¼–å†™ JSON åº“"><!---->ç¬¬ 5 ç« ï¼šç¼–å†™ JSON åº“<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/%E5%AD%A6%E4%B9%A0/Haskell%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/6.html" class="nav-link sidebar-link sidebar-page" aria-label="ç¬¬ 6 ç« ï¼šä½¿ç”¨ç±»å‹ç±»"><!---->ç¬¬ 6 ç« ï¼šä½¿ç”¨ç±»å‹ç±»<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-current="page" href="/%E5%AD%A6%E4%B9%A0/Haskell%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/7.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" aria-label="ç¬¬ 7 ç« ï¼šI/O"><!---->ç¬¬ 7 ç« ï¼šI/O<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/%E5%AD%A6%E4%B9%A0/Haskell%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/7.html#haskellç»å…¸i-o" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Haskellç»å…¸I/O"><!---->Haskellç»å…¸I/O<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/%E5%AD%A6%E4%B9%A0/Haskell%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/7.html#pure-vs-i-o" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Pure vs. I/O"><!---->Pure vs. I/O<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/%E5%AD%A6%E4%B9%A0/Haskell%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/7.html#ä¸ºä»€ä¹ˆçº¯ä¸çº¯å¾ˆé‡è¦" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ä¸ºä»€ä¹ˆçº¯ä¸çº¯å¾ˆé‡è¦ï¼Ÿ"><!---->ä¸ºä»€ä¹ˆçº¯ä¸çº¯å¾ˆé‡è¦ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/%E5%AD%A6%E4%B9%A0/Haskell%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/7.html#ä½¿ç”¨æ–‡ä»¶å’Œå¥æŸ„-handle" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ä½¿ç”¨æ–‡ä»¶å’Œå¥æŸ„ï¼ˆHandleï¼‰"><!---->ä½¿ç”¨æ–‡ä»¶å’Œå¥æŸ„ï¼ˆHandleï¼‰<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/%E5%AD%A6%E4%B9%A0/Haskell%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/7.html#å…³äº-openfile-çš„æ›´å¤šä¿¡æ¯" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å…³äº openFile çš„æ›´å¤šä¿¡æ¯"><!---->å…³äº openFile çš„æ›´å¤šä¿¡æ¯<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/%E5%AD%A6%E4%B9%A0/Haskell%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/7.html#å…³é—­å¥æŸ„" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å…³é—­å¥æŸ„"><!---->å…³é—­å¥æŸ„<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/%E5%AD%A6%E4%B9%A0/Haskell%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/7.html#seek-and-tell" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Seek and Tell"><!---->Seek and Tell<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/%E5%AD%A6%E4%B9%A0/Haskell%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/7.html#æ ‡å‡†è¾“å…¥-è¾“å‡ºå’Œé”™è¯¯" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æ ‡å‡†è¾“å…¥ï¼Œè¾“å‡ºå’Œé”™è¯¯"><!---->æ ‡å‡†è¾“å…¥ï¼Œè¾“å‡ºå’Œé”™è¯¯<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/%E5%AD%A6%E4%B9%A0/Haskell%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/7.html#åˆ é™¤å’Œé‡å‘½åæ–‡ä»¶" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="åˆ é™¤å’Œé‡å‘½åæ–‡ä»¶"><!---->åˆ é™¤å’Œé‡å‘½åæ–‡ä»¶<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/%E5%AD%A6%E4%B9%A0/Haskell%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/7.html#ä¸´æ—¶æ–‡ä»¶" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ä¸´æ—¶æ–‡ä»¶"><!---->ä¸´æ—¶æ–‡ä»¶<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/%E5%AD%A6%E4%B9%A0/Haskell%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/7.html#æ‰©å±•ä¾‹å­-å‡½æ•°å¼i-oå’Œä¸´æ—¶æ–‡ä»¶" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æ‰©å±•ä¾‹å­ï¼šå‡½æ•°å¼I/Oå’Œä¸´æ—¶æ–‡ä»¶"><!---->æ‰©å±•ä¾‹å­ï¼šå‡½æ•°å¼I/Oå’Œä¸´æ—¶æ–‡ä»¶<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/%E5%AD%A6%E4%B9%A0/Haskell%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/7.html#æƒ°æ€§i-o" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æƒ°æ€§I/O"><!---->æƒ°æ€§I/O<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/%E5%AD%A6%E4%B9%A0/Haskell%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/7.html#hgetcontents" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="hGetContents"><!---->hGetContents<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/%E5%AD%A6%E4%B9%A0/Haskell%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/7.html#readfileå’Œwritefile" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="readFileå’ŒwriteFile"><!---->readFileå’ŒwriteFile<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/%E5%AD%A6%E4%B9%A0/Haskell%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/7.html#ä¸€è¨€ä»¥è”½æƒ°æ€§è¾“å‡º" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ä¸€è¨€ä»¥è”½æƒ°æ€§è¾“å‡º"><!---->ä¸€è¨€ä»¥è”½æƒ°æ€§è¾“å‡º<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/%E5%AD%A6%E4%B9%A0/Haskell%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/7.html#interact" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="interact"><!---->interact<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/%E5%AD%A6%E4%B9%A0/Haskell%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/7.html#interact-è¿‡æ»¤å™¨" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="interact è¿‡æ»¤å™¨"><!---->interact è¿‡æ»¤å™¨<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/%E5%AD%A6%E4%B9%A0/Haskell%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/7.html#the-io-monad" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="The IO Monad"><!---->The IO Monad<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/%E5%AD%A6%E4%B9%A0/Haskell%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/7.html#åŠ¨ä½œ-actions" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="åŠ¨ä½œï¼ˆActionsï¼‰"><!---->åŠ¨ä½œï¼ˆActionsï¼‰<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/%E5%AD%A6%E4%B9%A0/Haskell%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/7.html#sequencing" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ä¸²è”åŒ–ï¼ˆSequencingï¼‰"><!---->ä¸²è”åŒ–ï¼ˆSequencingï¼‰<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/%E5%AD%A6%E4%B9%A0/Haskell%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/7.html#the-nature-of-return" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Returnçš„æœ¬è‰²"><!---->Returnçš„æœ¬è‰²<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/%E5%AD%A6%E4%B9%A0/Haskell%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/7.html#haskell-å®é™…ä¸Šæ˜¯å‘½ä»¤å¼çš„å—" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Haskell å®é™…ä¸Šæ˜¯å‘½ä»¤å¼çš„å—ï¼Ÿ"><!---->Haskell å®é™…ä¸Šæ˜¯å‘½ä»¤å¼çš„å—ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/%E5%AD%A6%E4%B9%A0/Haskell%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/7.html#æƒ°æ€§i-oçš„å‰¯ä½œç”¨" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æƒ°æ€§I/Oçš„å‰¯ä½œç”¨"><!---->æƒ°æ€§I/Oçš„å‰¯ä½œç”¨<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/%E5%AD%A6%E4%B9%A0/Haskell%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/7.html#ç¼“å†²åŒº-buffering" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ç¼“å†²åŒºï¼ˆBufferingï¼‰"><!---->ç¼“å†²åŒºï¼ˆBufferingï¼‰<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/%E5%AD%A6%E4%B9%A0/Haskell%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/7.html#ç¼“å†²åŒºæ¨¡å¼" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ç¼“å†²åŒºæ¨¡å¼"><!---->ç¼“å†²åŒºæ¨¡å¼<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/%E5%AD%A6%E4%B9%A0/Haskell%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/7.html#åˆ·æ–°ç¼“å†²åŒº" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="åˆ·æ–°ç¼“å†²åŒº"><!---->åˆ·æ–°ç¼“å†²åŒº<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/%E5%AD%A6%E4%B9%A0/Haskell%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/7.html#è¯»å–å‘½ä»¤è¡Œå‚æ•°" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="è¯»å–å‘½ä»¤è¡Œå‚æ•°"><!---->è¯»å–å‘½ä»¤è¡Œå‚æ•°<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/%E5%AD%A6%E4%B9%A0/Haskell%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/7.html#ç¯å¢ƒå˜é‡" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ç¯å¢ƒå˜é‡"><!---->ç¯å¢ƒå˜é‡<!----></a><ul class="sidebar-sub-headers"></ul></li></ul><!--]--></li><li><!--[--><a href="/%E5%AD%A6%E4%B9%A0/Haskell%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/8.html" class="nav-link sidebar-link sidebar-page" aria-label="ç¬¬ 8 ç« ï¼šé«˜æ•ˆæ–‡ä»¶å¤„ç†ã€æ­£åˆ™è¡¨è¾¾å¼ã€æ–‡ä»¶ååŒ¹é…"><!---->ç¬¬ 8 ç« ï¼šé«˜æ•ˆæ–‡ä»¶å¤„ç†ã€æ­£åˆ™è¡¨è¾¾å¼ã€æ–‡ä»¶ååŒ¹é…<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/%E5%AD%A6%E4%B9%A0/Haskell%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/9.html" class="nav-link sidebar-link sidebar-page" aria-label="ç¬¬ 9 ç« ï¼šI/Oå­¦ä¹  â€”â€” æ„å»ºä¸€ä¸ªç”¨äºæœç´¢æ–‡ä»¶ç³»ç»Ÿçš„åº“"><!---->ç¬¬ 9 ç« ï¼šI/Oå­¦ä¹  â€”â€” æ„å»ºä¸€ä¸ªç”¨äºæœç´¢æ–‡ä»¶ç³»ç»Ÿçš„åº“<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/%E5%AD%A6%E4%B9%A0/Haskell%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/10.html" class="nav-link sidebar-link sidebar-page" aria-label="ç¬¬ 10 ç« ï¼šä»£ç æ¡ˆä¾‹å­¦ä¹ ï¼šè§£æäºŒè¿›åˆ¶æ•°æ®æ ¼å¼"><!---->ç¬¬ 10 ç« ï¼šä»£ç æ¡ˆä¾‹å­¦ä¹ ï¼šè§£æäºŒè¿›åˆ¶æ•°æ®æ ¼å¼<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">å‰ç«¯</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">åç«¯</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">å·¥å…·</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">ç®—æ³•</span><span class="arrow end"></span></button><!----></section></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><!---->ç¬¬ 7 ç« ï¼šI/O</h1><div class="page-info"><span class="page-author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://mrhope.site" target="_blank" rel="noopener noreferrer">hahg</a></span><span property="author" content="hahg"></span></span><!----><span class="page-date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2023-12-17T11:18:34.000Z"></span><!----><span class="page-reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 46 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT46M"></span><!----><!----></div><hr></div><div class="toc-place-holder"><aside id="toc"><!--[--><!----><!--]--><div class="toc-header">æ­¤é¡µå†…å®¹<button class="print-button" title="æ‰“å°"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button></div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/%E5%AD%A6%E4%B9%A0/Haskell%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/7.html#haskellç»å…¸i-o" class="router-link-active router-link-exact-active toc-link level2">Haskellç»å…¸I/O</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/%E5%AD%A6%E4%B9%A0/Haskell%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/7.html#pure-vs-i-o" class="router-link-active router-link-exact-active toc-link level3">Pure vs. I/O</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/%E5%AD%A6%E4%B9%A0/Haskell%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/7.html#ä¸ºä»€ä¹ˆçº¯ä¸çº¯å¾ˆé‡è¦" class="router-link-active router-link-exact-active toc-link level3">ä¸ºä»€ä¹ˆçº¯ä¸çº¯å¾ˆé‡è¦ï¼Ÿ</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/%E5%AD%A6%E4%B9%A0/Haskell%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/7.html#ä½¿ç”¨æ–‡ä»¶å’Œå¥æŸ„-handle" class="router-link-active router-link-exact-active toc-link level2">ä½¿ç”¨æ–‡ä»¶å’Œå¥æŸ„ï¼ˆHandleï¼‰</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/%E5%AD%A6%E4%B9%A0/Haskell%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/7.html#å…³äº-openfile-çš„æ›´å¤šä¿¡æ¯" class="router-link-active router-link-exact-active toc-link level3">å…³äº openFile çš„æ›´å¤šä¿¡æ¯</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/%E5%AD%A6%E4%B9%A0/Haskell%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/7.html#å…³é—­å¥æŸ„" class="router-link-active router-link-exact-active toc-link level3">å…³é—­å¥æŸ„</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/%E5%AD%A6%E4%B9%A0/Haskell%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/7.html#seek-and-tell" class="router-link-active router-link-exact-active toc-link level3">Seek and Tell</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/%E5%AD%A6%E4%B9%A0/Haskell%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/7.html#æ ‡å‡†è¾“å…¥-è¾“å‡ºå’Œé”™è¯¯" class="router-link-active router-link-exact-active toc-link level3">æ ‡å‡†è¾“å…¥ï¼Œè¾“å‡ºå’Œé”™è¯¯</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/%E5%AD%A6%E4%B9%A0/Haskell%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/7.html#åˆ é™¤å’Œé‡å‘½åæ–‡ä»¶" class="router-link-active router-link-exact-active toc-link level3">åˆ é™¤å’Œé‡å‘½åæ–‡ä»¶</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/%E5%AD%A6%E4%B9%A0/Haskell%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/7.html#ä¸´æ—¶æ–‡ä»¶" class="router-link-active router-link-exact-active toc-link level3">ä¸´æ—¶æ–‡ä»¶</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/%E5%AD%A6%E4%B9%A0/Haskell%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/7.html#æ‰©å±•ä¾‹å­-å‡½æ•°å¼i-oå’Œä¸´æ—¶æ–‡ä»¶" class="router-link-active router-link-exact-active toc-link level2">æ‰©å±•ä¾‹å­ï¼šå‡½æ•°å¼I/Oå’Œä¸´æ—¶æ–‡ä»¶</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/%E5%AD%A6%E4%B9%A0/Haskell%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/7.html#æƒ°æ€§i-o" class="router-link-active router-link-exact-active toc-link level2">æƒ°æ€§I/O</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/%E5%AD%A6%E4%B9%A0/Haskell%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/7.html#hgetcontents" class="router-link-active router-link-exact-active toc-link level3">hGetContents</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/%E5%AD%A6%E4%B9%A0/Haskell%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/7.html#readfileå’Œwritefile" class="router-link-active router-link-exact-active toc-link level3">readFileå’ŒwriteFile</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/%E5%AD%A6%E4%B9%A0/Haskell%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/7.html#ä¸€è¨€ä»¥è”½æƒ°æ€§è¾“å‡º" class="router-link-active router-link-exact-active toc-link level3">ä¸€è¨€ä»¥è”½æƒ°æ€§è¾“å‡º</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/%E5%AD%A6%E4%B9%A0/Haskell%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/7.html#interact" class="router-link-active router-link-exact-active toc-link level3">interact</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/%E5%AD%A6%E4%B9%A0/Haskell%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/7.html#interact-è¿‡æ»¤å™¨" class="router-link-active router-link-exact-active toc-link level3">interact è¿‡æ»¤å™¨</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/%E5%AD%A6%E4%B9%A0/Haskell%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/7.html#the-io-monad" class="router-link-active router-link-exact-active toc-link level2">The IO Monad</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/%E5%AD%A6%E4%B9%A0/Haskell%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/7.html#åŠ¨ä½œ-actions" class="router-link-active router-link-exact-active toc-link level3">åŠ¨ä½œï¼ˆActionsï¼‰</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/%E5%AD%A6%E4%B9%A0/Haskell%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/7.html#sequencing" class="router-link-active router-link-exact-active toc-link level3">ä¸²è”åŒ–ï¼ˆSequencingï¼‰</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/%E5%AD%A6%E4%B9%A0/Haskell%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/7.html#the-nature-of-return" class="router-link-active router-link-exact-active toc-link level3">Returnçš„æœ¬è‰²</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/%E5%AD%A6%E4%B9%A0/Haskell%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/7.html#haskell-å®é™…ä¸Šæ˜¯å‘½ä»¤å¼çš„å—" class="router-link-active router-link-exact-active toc-link level2">Haskell å®é™…ä¸Šæ˜¯å‘½ä»¤å¼çš„å—ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/%E5%AD%A6%E4%B9%A0/Haskell%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/7.html#æƒ°æ€§i-oçš„å‰¯ä½œç”¨" class="router-link-active router-link-exact-active toc-link level2">æƒ°æ€§I/Oçš„å‰¯ä½œç”¨</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/%E5%AD%A6%E4%B9%A0/Haskell%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/7.html#ç¼“å†²åŒº-buffering" class="router-link-active router-link-exact-active toc-link level2">ç¼“å†²åŒºï¼ˆBufferingï¼‰</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/%E5%AD%A6%E4%B9%A0/Haskell%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/7.html#ç¼“å†²åŒºæ¨¡å¼" class="router-link-active router-link-exact-active toc-link level3">ç¼“å†²åŒºæ¨¡å¼</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/%E5%AD%A6%E4%B9%A0/Haskell%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/7.html#åˆ·æ–°ç¼“å†²åŒº" class="router-link-active router-link-exact-active toc-link level3">åˆ·æ–°ç¼“å†²åŒº</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/%E5%AD%A6%E4%B9%A0/Haskell%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/7.html#è¯»å–å‘½ä»¤è¡Œå‚æ•°" class="router-link-active router-link-exact-active toc-link level2">è¯»å–å‘½ä»¤è¡Œå‚æ•°</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/%E5%AD%A6%E4%B9%A0/Haskell%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/7.html#ç¯å¢ƒå˜é‡" class="router-link-active router-link-exact-active toc-link level2">ç¯å¢ƒå˜é‡</a></li><!----><!--]--></ul></div><!--[--><!----><!--]--></aside></div><!----><div class="theme-hope-content"><h1 id="ç¬¬-7-ç« -i-o" tabindex="-1"><a class="header-anchor" href="#ç¬¬-7-ç« -i-o" aria-hidden="true">#</a> ç¬¬ 7 ç« ï¼šI/O</h1><p>å°±ç®—ä¸æ˜¯å…¨éƒ¨ï¼Œç»å¤§å¤šæ•°çš„ç¨‹åºå‘˜æ˜¾ç„¶è¿˜æ˜¯è‡´åŠ›äºä»å¤–ç•Œæ”¶é›†æ•°æ®ï¼Œå¤„ç†è¿™äº›æ•°æ®ï¼Œç„¶åæŠŠç»“æœä¼ å›å¤–ç•Œã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå…³é”®å°±æ˜¯è¾“å…¥è¾“å‡ºã€‚</p><p>Haskellçš„I/Oç³»ç»Ÿæ˜¯å¾ˆå¼ºå¤§å’Œå¯Œæœ‰è¡¨ç°åŠ›çš„ã€‚ å®ƒæ˜“äºä½¿ç”¨ï¼Œä¹Ÿå¾ˆæœ‰å¿…è¦å»ç†è§£ã€‚Haskellä¸¥æ ¼åœ°æŠŠçº¯ä»£ç ä»é‚£äº›ä¼šè®©å¤–éƒ¨ä¸–ç•Œå‘ç”Ÿäº‹æƒ…çš„ä»£ç ä¸­åˆ†éš”å¼€ã€‚å°±æ˜¯è¯´ï¼Œå®ƒç»™çº¯ä»£ç æä¾›äº†å®Œå…¨çš„å‰¯ä½œç”¨éš”ç¦»ã€‚é™¤äº†å¸®åŠ©ç¨‹åºå‘˜æ¨æ–­ä»–ä»¬è‡ªå·±ä»£ç çš„æ­£ç¡®æ€§ï¼Œå®ƒè¿˜ä½¿ç¼–è¯‘å™¨å¯ä»¥è‡ªåŠ¨é‡‡å–ä¼˜åŒ–å’Œå¹¶è¡ŒåŒ–æˆä¸ºå¯èƒ½ã€‚</p><p>æˆ‘ä»¬å°†ç”¨ç®€å•æ ‡å‡†çš„I/Oæ¥å¼€å§‹è¿™ä¸€ç« ã€‚ç„¶åæˆ‘ä»¬è¦è®¨è®ºä¸‹ä¸€äº›æ›´å¼ºå¤§çš„é€‰é¡¹ï¼Œä»¥åŠæä¾›æ›´å¤šI/Oæ˜¯æ€ä¹ˆé€‚åº”çº¯çš„ï¼Œæƒ°æ€§çš„ï¼Œå‡½æ•°å¼çš„Haskellä¸–ç•Œçš„ç»†èŠ‚ã€‚</p><h2 id="haskellç»å…¸i-o" tabindex="-1"><a class="header-anchor" href="#haskellç»å…¸i-o" aria-hidden="true">#</a> Haskellç»å…¸I/O</h2><p>è®©æˆ‘ä»¬å¼€å§‹ä½¿ç”¨Haskellçš„I/Oå§ã€‚å…ˆæ¥çœ‹ä¸€ä¸ªç¨‹åºï¼Œå®ƒçœ‹èµ·æ¥å¾ˆåƒåœ¨Cæˆ–è€…Perlç­‰å…¶ä»–è¯­è¨€çš„I/Oã€‚</p><div class="language-haskell line-numbers-mode" data-ext="haskell"><pre class="language-haskell"><code><span class="token comment">-- file: ch07/basicio.hs</span>
<span class="token hvariable">main</span> <span class="token operator">=</span> <span class="token keyword">do</span>
    <span class="token builtin">putStrLn</span> <span class="token string">&quot;Greetings!  What is your name?&quot;</span>
    <span class="token hvariable">inpStr</span> <span class="token operator">&lt;-</span> <span class="token builtin">getLine</span>
    <span class="token builtin">putStrLn</span> <span class="token operator">$</span> <span class="token string">&quot;Welcome to Haskell, &quot;</span> <span class="token operator">++</span> <span class="token hvariable">inpStr</span> <span class="token operator">++</span> <span class="token string">&quot;!&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½ å¯ä»¥ç¼–è¯‘è¿™ä¸ªç¨‹åºï¼Œå˜æˆä¸€ä¸ªå•ç‹¬çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œç„¶åç”¨ <strong>runghc</strong> è¿è¡Œå®ƒï¼Œæˆ–è€…ä» <strong>ghci</strong> è°ƒç”¨ <code>main</code> ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªä½¿ç”¨*<em>runghc</em>*çš„ä¾‹å­ï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>$ runghc basicio.hs
Greetings<span class="token operator">!</span>  What is your name?
John
Welcome to Haskell, John<span class="token operator">!</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ˜¯ä¸€ä¸ªç›¸å½“ç®€å•ï¼Œæ˜æ˜¾çš„ç»“æœã€‚ ä½ å¯ä»¥çœ‹åˆ° <code>putStrLn</code> è¾“å‡ºä¸€ä¸ª <code>string</code>ï¼Œåé¢è·Ÿäº†ä¸€ä¸ªæ¢è¡Œç¬¦ã€‚ <code>getLine</code> ä»æ ‡å‡†è¾“å…¥è¯»å–ä¸€è¡Œã€‚ <code>&lt;-</code> è¯­æ³•å¯¹äºä½ å¯èƒ½æ¯”è¾ƒæ–°ã€‚ ç®€å•æ¥çœ‹ï¼Œå®ƒç»‘å®šä¸€ä¸ªI/OåŠ¨ä½œçš„ç»“æœåˆ°ä¸€ä¸ªåå­—ã€‚æˆ‘ä»¬ç”¨ç®€å•çš„åˆ—è¡¨ä¸²è”è¿ç®—ç¬¦ <code>++</code> æ¥è”åˆè¾“å…¥å­—ç¬¦ä¸²å’Œæˆ‘ä»¬è‡ªå·±çš„æ–‡æœ¬ã€‚</p><p>è®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ <code>putStrLn</code> å’Œ <code>getLine</code> çš„ç±»å‹ã€‚ä½ å¯ä»¥åœ¨åº“å‚è€ƒæ‰‹å†Œé‡Œçœ‹åˆ°è¿™äº›ä¿¡æ¯ï¼Œæˆ–è€…ç›´æ¥é—® <code>ghci</code> ï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>ghci<span class="token operator">&gt;</span> :type putStrLn
putStrLn :: String -<span class="token operator">&gt;</span> IO <span class="token punctuation">(</span><span class="token punctuation">)</span>
ghci<span class="token operator">&gt;</span> :type getLine
getLine :: IO String
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ³¨æ„ï¼Œè¿™äº›ç±»å‹åœ¨ä»–ä»¬çš„è¿”å›å€¼é‡Œé¢éƒ½æœ‰IOã€‚ç°åœ¨å…³é”®çš„æ˜¯ï¼Œä½ è¦ä»è¿™é‡ŒçŸ¥é“ä»–ä»¬å¯èƒ½æœ‰å‰¯ä½œç”¨ï¼Œæˆ–è€…ä»–ä»¬ç”¨ç›¸åŒçš„å‚æ•°è°ƒç”¨å¯èƒ½è¿”å›ä¸åŒçš„å€¼ï¼Œæˆ–è€…ä¸¤è€…éƒ½æœ‰ã€‚<code>putStrLn</code> çš„ç±»å‹çœ‹èµ·æ¥åƒä¸€ä¸ªå‡½æ•°ï¼Œå®ƒæ¥å—ä¸€ä¸ª <code>String</code> ç±»å‹çš„å‚æ•°ï¼Œå¹¶è¿”å› <code>IO ()</code> ç±»å‹çš„å€¼ã€‚ å¯æ˜¯ <code>IO ()</code> æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</p><p><code>IO something</code> ç±»å‹çš„æ‰€æœ‰ä¸œè¥¿éƒ½æ˜¯ä¸€ä¸ªIOåŠ¨ä½œï¼Œä½ å¯ä»¥ä¿å­˜å®ƒä½†æ˜¯ä»€ä¹ˆéƒ½ä¸ä¼šå‘ç”Ÿã€‚ æˆ‘å¯ä»¥è¯´ <code>writefoo = putStrLn &quot;foo&quot;</code> å¹¶ä¸”ç°åœ¨ä»€ä¹ˆéƒ½ä¸å‘ç”Ÿã€‚ä½†æ˜¯å¦‚æœæˆ‘è¿‡ä¸€ä¼šåœ¨å¦ä¸€ä¸ªI/OåŠ¨ä½œä¸­é—´ä½¿ç”¨ <code>writefoo</code> ï¼Œ <code>writefoo</code> åŠ¨ä½œå°†ä¼šåœ¨å®ƒçš„çˆ¶åŠ¨ä½œè¢«æ‰§è¡Œçš„æ—¶å€™æ‰§è¡Œ -- I/OåŠ¨ä½œå¯ä»¥ç²˜åˆåœ¨ä¸€èµ·æ¥å½¢æˆæ›´å¤§çš„I/OåŠ¨ä½œã€‚ <code>()</code> æ˜¯ä¸€ä¸ªç©ºçš„å…ƒ ï¼ˆä½œ&quot;unit&quot;ï¼‰ï¼Œè¡¨æ˜ä» <code>putStrLn</code> æ²¡æœ‰è¿”å›å€¼ã€‚è¿™å’ŒJavaæˆ–Cé‡Œé¢çš„ <code>void</code> ç±»ä¼¼ã€‚</p><div class="hint-container tip"><p class="hint-container-title">Tip</p><p>I/OåŠ¨ä½œå¯ä»¥è¢«åˆ›å»ºï¼Œèµ‹å€¼å’Œä¼ é€’åˆ°ä»»ä½•åœ°æ–¹ï¼Œä½†æ˜¯å®ƒä»¬åªèƒ½åœ¨å¦ä¸€ä¸ªI/OåŠ¨ä½œé‡Œé¢è¢«æ‰§è¡Œã€‚</p></div><p>æˆ‘ä»¬åœ¨ <strong>ghci</strong> ä¸‹çœ‹ä¸‹è¿™å¥ä»£ç ï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>ghci<span class="token operator">&gt;</span> <span class="token builtin class-name">let</span> writefoo <span class="token operator">=</span> putStrLn <span class="token string">&quot;foo&quot;</span>
ghci<span class="token operator">&gt;</span> writefoo
foo
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œè¾“å‡º <code>foo</code> ä¸æ˜¯ <code>putStrLn</code> çš„è¿”å›å€¼ï¼Œè€Œæ˜¯å®ƒçš„å‰¯ä½œç”¨ï¼ŒæŠŠ <code>foo</code> å†™åˆ°ç»ˆç«¯ä¸Šã€‚</p><p>è¿˜æœ‰å¦ä¸€ä»¶äº‹è¦æ³¨æ„ï¼Œ å®é™…ä¸Šæ˜¯ <strong>ghci</strong> æ‰§è¡Œçš„ <code>writefoo</code> ã€‚æ„æ€æ˜¯ï¼Œå¦‚æœç»™ <strong>ghci</strong> ä¸€ä¸ªI/OåŠ¨ä½œï¼Œå®ƒå°†ä¼šåœ¨é‚£ä¸ªåœ°æ–¹å¸®ä½ æ‰§è¡Œå®ƒã€‚</p><div class="hint-container note"><p class="hint-container-title">Note</p><p>æ˜¯ I/O åŠ¨ä½œï¼Ÿ</p><ul><li>ç±»å‹æ˜¯ <code>IO t</code></li><li>æ˜¯Haskellçš„å¤´ç­‰å€¼ï¼Œå¹¶ä¸”å’ŒHaskellçš„ç±»å‹ç³»ç»Ÿæ— ç¼ç»“åˆã€‚</li></ul><ul><li>åœ¨è¿è¡Œï¼ˆperformï¼‰çš„æ—¶å€™äº§ç”Ÿä½œç”¨ï¼Œè€Œä¸æ˜¯åœ¨ä¼°å€¼ï¼ˆevaluateï¼‰çš„æ—¶å€™ã€‚</li><li>ä»»ä½•è¡¨è¾¾å¼éƒ½ä¼šäº§ç”Ÿä¸€ä¸ªåŠ¨ä½œä½œä¸ºå®ƒçš„å€¼ï¼Œä½†æ˜¯è¿™ä¸ªåŠ¨ä½œç›´åˆ°åœ¨å¦ä¸€ä¸ªI/OåŠ¨ä½œé‡Œé¢è¢«æ‰§è¡Œçš„æ—¶å€™æ‰ä¼šè¿è¡Œã€‚</li><li>è¿è¡Œï¼ˆæ‰§è¡Œï¼‰ä¸€ä¸ª <code>IO t</code> ç±»å‹çš„åŠ¨ä½œå¯èƒ½è¿è¡ŒI/Oï¼Œå¹¶ä¸”æœ€ç»ˆäº¤ä»˜ä¸€ä¸ªç±»å‹ <code>t</code> çš„ç»“æœã€‚</li></ul></div><p><code>getLine</code> çš„ç±»å‹å¯èƒ½çœ‹èµ·æ¥æ¯”è¾ƒé™Œç”Ÿã€‚ å®ƒçœ‹èµ·æ¥åƒä¸€ä¸ªå€¼ï¼Œè€Œä¸åƒä¸€ä¸ªå‡½æ•°ã€‚ä½†å®é™…ä¸Šï¼Œæœ‰ä¸€ç§çœ‹å®ƒçš„æ–¹æ³•ï¼š <code>getLine</code> ä¿å­˜äº†ä¸€ä¸ªI/OåŠ¨ä½œã€‚å½“è¿™ä¸ªåŠ¨ä½œè¿è¡Œäº†ä½ ä¼šå¾—åˆ°ä¸€ä¸ª <code>String</code> ã€‚ <code>&lt;-</code> è¿ç®—ç¬¦æ˜¯ç”¨æ¥ä»è¿è¡ŒI/OåŠ¨ä½œä¸­æŠ½å‡ºç»“æœï¼Œå¹¶ä¸”ä¿å­˜åˆ°ä¸€ä¸ªå˜é‡ä¸­ã€‚</p><p><code>main</code> è‡ªå·±å°±æ˜¯ä¸€ä¸ªI/OåŠ¨ä½œï¼Œç±»å‹æ˜¯ <code>IO ()</code> ã€‚ä½ å¯ä»¥åœ¨å…¶ä»–I/OåŠ¨ä½œä¸­åªæ˜¯è¿è¡ŒI/OåŠ¨ä½œã€‚Haskellç¨‹åºä¸­çš„æ‰€æœ‰I/OåŠ¨ä½œéƒ½æ˜¯ç”±ä» <code>main</code> çš„é¡¶éƒ¨å¼€å§‹é©±åŠ¨çš„ï¼Œ <code>main</code> æ˜¯æ¯ä¸€ä¸ªHaskellç¨‹åºå¼€å§‹æ‰§è¡Œçš„åœ°æ–¹ã€‚ç„¶åï¼Œè¦è¯´çš„æ˜¯ç»™Haskellä¸­å‰¯ä½œç”¨æä¾›éš”ç¦»çš„æœºåˆ¶æ˜¯ï¼šä½ åœ¨I/OåŠ¨ä½œä¸­è¿è¡ŒI/Oï¼Œå¹¶ä¸”åœ¨é‚£å„¿è°ƒç”¨çº¯çš„ï¼ˆéI/Oï¼‰å‡½æ•°ã€‚å¤§éƒ¨åˆ†Haskellä»£ç æ˜¯çº¯çš„ï¼ŒI/OåŠ¨ä½œè¿è¡ŒI/Oå¹¶ä¸”è°ƒç”¨çº¯(pure)ä»£ç ã€‚</p><p><code>do</code> æ˜¯ç”¨æ¥å®šä¹‰ä¸€ä¸²åŠ¨ä½œçš„æ–¹ä¾¿æ–¹æ³•ã€‚ä½ é©¬ä¸Šå°±ä¼šçœ‹åˆ°ï¼Œè¿˜æœ‰å…¶ä»–æ–¹æ³•å¯ä»¥ç”¨æ¥å®šä¹‰ã€‚ å½“ä½ ç”¨è¿™ç§æ–¹å¼æ¥ä½¿ç”¨ <code>do</code> çš„æ—¶å€™ï¼Œç¼©è¿›å¾ˆé‡è¦ï¼Œç¡®ä¿ä½ çš„åŠ¨ä½œæ­£ç¡®åœ°å¯¹é½äº†ã€‚</p><p>åªæœ‰å½“ä½ æœ‰å¤šäºä¸€ä¸ªåŠ¨ä½œéœ€è¦è¿è¡Œçš„æ—¶å€™æ‰è¦ç”¨åˆ° <code>do</code> ã€‚<code>do</code> ä»£ç å—çš„å€¼æ˜¯æœ€åä¸€ä¸ªåŠ¨ä½œæ‰§è¡Œçš„ç»“æœã€‚æƒ³è¦çœ‹ <code>do</code> è¯­æ³•çš„å®Œæ•´ä»‹ç»ï¼Œå¯ä»¥çœ‹ <a href="">doä»£ç å—æå–</a> .</p><p>æˆ‘ä»¬æ¥è€ƒè™‘ä¸€ä¸ªåœ¨I/OåŠ¨ä½œä¸­è°ƒç”¨çº¯ä»£ç çš„ä¸€ä¸ªä¾‹å­ï¼š</p><div class="language-haskell line-numbers-mode" data-ext="haskell"><pre class="language-haskell"><code><span class="token comment">-- file: ch07/callingpure.hs</span>
<span class="token hvariable">name2reply</span> <span class="token operator">::</span> <span class="token constant">String</span> <span class="token operator">-&gt;</span> <span class="token constant">String</span>
<span class="token hvariable">name2reply</span> <span class="token hvariable">name</span> <span class="token operator">=</span>
    <span class="token string">&quot;Pleased to meet you, &quot;</span> <span class="token operator">++</span> <span class="token hvariable">name</span> <span class="token operator">++</span> <span class="token string">&quot;.\n&quot;</span> <span class="token operator">++</span>
    <span class="token string">&quot;Your name contains &quot;</span> <span class="token operator">++</span> <span class="token hvariable">charcount</span> <span class="token operator">++</span> <span class="token string">&quot; characters.&quot;</span>
    <span class="token keyword">where</span> <span class="token hvariable">charcount</span> <span class="token operator">=</span> <span class="token builtin">show</span> <span class="token punctuation">(</span><span class="token builtin">length</span> <span class="token hvariable">name</span><span class="token punctuation">)</span>

<span class="token hvariable">main</span> <span class="token operator">::</span> <span class="token constant">IO</span> <span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token hvariable">main</span> <span class="token operator">=</span> <span class="token keyword">do</span>
       <span class="token builtin">putStrLn</span> <span class="token string">&quot;Greetings once again.  What is your name?&quot;</span>
       <span class="token hvariable">inpStr</span> <span class="token operator">&lt;-</span> <span class="token builtin">getLine</span>
       <span class="token keyword">let</span> <span class="token hvariable">outStr</span> <span class="token operator">=</span> <span class="token hvariable">name2reply</span> <span class="token hvariable">inpStr</span>
       <span class="token builtin">putStrLn</span> <span class="token hvariable">outStr</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ³¨æ„ä¾‹å­ä¸­çš„ <code>name2replay</code> å‡½æ•°ã€‚è¿™æ˜¯ä¸€ä¸ªHaskellçš„ä¸€ä¸ªå¸¸è§„å‡½æ•°ï¼Œå®ƒéµå®ˆæ‰€æœ‰æˆ‘ä»¬å‘Šè¯‰è¿‡ä½ çš„è§„åˆ™ï¼šç»™å®ƒç›¸åŒçš„è¾“å…¥ï¼Œå®ƒæ€»æ˜¯è¿”å›ç›¸åŒçš„ç»“æœï¼Œæ²¡æœ‰å‰¯ä½œç”¨ï¼Œå¹¶ä¸”ä»¥æƒ°æ€§æ–¹å¼è¿è¡Œã€‚å®ƒç”¨äº†å…¶ä»–Haskellå‡½æ•°ï¼š <code>(++)</code> ï¼Œ <code>show</code> å’Œ <code>length</code> ã€‚</p><p>å¾€ä¸‹çœ‹åˆ° <code>main</code> ï¼Œæˆ‘ä»¬ç»‘å®š <code>name2replay inpStr</code> çš„ç»“æœåˆ° <code>outStr</code> ã€‚å½“ä½ åœ¨ç”¨ <code>do</code> ä»£ç å—çš„æ—¶å€™ï¼Œä½ ç”¨ <code>&lt;-</code> å»å¾—åˆ°I/OåŠ¨ä½œçš„ç»“æœï¼Œç”¨ <code>let</code>å¾—åˆ°çº¯ä»£ç çš„ç»“æœã€‚ å½“ä½ åœ¨ <code>do</code> ä»£ç å—ä¸­ä½¿ç”¨ <code>let</code> å£°æ˜çš„æ—¶å€™ï¼Œä¸è¦åœ¨åé¢æ”¾ä¸Š <code>in</code> ã€‚</p><p>ä½ å¯ä»¥çœ‹åˆ°è¿™é‡Œæ˜¯æ€ä¹ˆä»é”®ç›˜è¯»å–è¿™äººçš„åå­—çš„ã€‚ç„¶åï¼Œæ•°æ®è¢«ä¼ åˆ°ä¸€ä¸ªçº¯å‡½æ•°ï¼Œæ¥ç€å®ƒçš„ç»“æœè¢«æ‰“å°å‡ºæ¥ã€‚ å®é™…ä¸Šï¼Œ <code>main</code> çš„æœ€åä¸¤è¡Œå¯ä»¥è¢«æ›¿æ¢æˆ <code>putStrLn (name2reply inpStr)</code> ã€‚ æ‰€ä»¥ï¼Œ <code>main</code> æœ‰å‰¯ä½œç”¨ï¼ˆæ¯”å¦‚å®ƒåœ¨ç»ˆç«¯ä¸Šæ˜¾ç¤ºä¸œè¥¿ï¼‰ï¼Œ <code>name2replay</code> æ²¡æœ‰å‰¯ä½œç”¨ï¼Œä¹Ÿä¸èƒ½æœ‰å‰¯ä½œç”¨ã€‚ å› ä¸º <code>name2replay</code> æ˜¯ä¸€ä¸ªçº¯å‡½æ•°ï¼Œä¸æ˜¯ä¸€ä¸ªåŠ¨ä½œã€‚</p><p>æˆ‘ä»¬åœ¨ <strong>ghci</strong> ä¸Šæ£€æŸ¥ä¸€ä¸‹ï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>ghci<span class="token operator">&gt;</span> :load callingpure.hs
<span class="token punctuation">[</span><span class="token number">1</span> of <span class="token number">1</span><span class="token punctuation">]</span> Compiling Main             <span class="token punctuation">(</span> callingpure.hs, interpreted <span class="token punctuation">)</span>
Ok, modules loaded: Main.
ghci<span class="token operator">&gt;</span> name2reply <span class="token string">&quot;John&quot;</span>
<span class="token string">&quot;Pleased to meet you, John.<span class="token entity" title="\n">\n</span>Your name contains 4 characters.&quot;</span>
ghci<span class="token operator">&gt;</span> putStrLn <span class="token punctuation">(</span>name2reply <span class="token string">&quot;John&quot;</span><span class="token punctuation">)</span>
Pleased to meet you, John.
Your name contains <span class="token number">4</span> characters.
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å­—ç¬¦ä¸²é‡Œé¢çš„ <code>\n</code> æ˜¯æ¢è¡Œç¬¦ï¼Œ å®ƒè®©ç»ˆç«¯åœ¨è¾“å‡ºä¸­å¼€å§‹æ–°çš„ä¸€è¡Œã€‚ åœ¨ <strong>ghci</strong> ç›´æ¥è°ƒç”¨ <code>name2replay &quot;John&quot;</code> ä¼šå­—é¢ä¸Šæ˜¾ç¤º <code>\n</code> ï¼Œå› ä¸ºä½¿ç”¨ <code>show</code> æ¥æ˜¾ç¤ºè¿”å›å€¼ã€‚ ä½†æ˜¯ä½¿ç”¨ <code>putStrLn</code> æ¥å‘é€åˆ°ç»ˆç«¯çš„è¯ï¼Œç»ˆç«¯ä¼šæŠŠ <code>\n</code> è§£é‡Šæˆå¼€å§‹æ–°çš„ä¸€è¡Œã€‚</p><p>å¦‚æœä½ å°±åœ¨ <strong>ghci</strong> æç¤ºç¬¦é‚£æ‰“ä¸Š <code>main</code> ï¼Œä½ è§‰å¾—ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿæ¥è¯•ä¸€ä¸‹å§ã€‚</p><p>çœ‹å®Œè¿™å‡ ä¸ªä¾‹å­ç¨‹åºä¹‹åï¼Œä½ å¯èƒ½ä¼šå¥½å¥‡Haskellæ˜¯ä¸æ˜¯çœŸæ­£çš„å‘½ä»¤å¼è¯­è¨€å‘¢ï¼Œè€Œä¸æ˜¯çº¯çš„ï¼Œæƒ°æ€§çš„ï¼Œå‡½æ•°å¼çš„ã€‚è¿™äº›ä¾‹å­é‡Œçš„ä¸€äº›çœ‹èµ·æ¥æ˜¯æŒ‰ç…§é¡ºåºçš„ä¸€è¿ä¸²çš„æ“ä½œã€‚è¿™é‡Œé¢è¿˜æœ‰å¾ˆå¤šä¸œè¥¿ï¼Œæˆ‘ä»¬ä¼šåœ¨è¿™ä¸€ç« çš„<a href="#haskell-%E5%AE%9E%E9%99%85%E4%B8%8A%E6%98%AF%E5%91%BD%E4%BB%A4%E5%BC%8F%E7%9A%84%E5%90%97">Haskell å®é™…ä¸Šæ˜¯å‘½ä»¤å¼çš„å—ï¼Ÿ</a> å’Œ <a href="#%E6%83%B0%E6%80%A7io">æƒ°æ€§I/O</a> ç« èŠ‚æ¥è®¨è®ºè¿™ä¸ªé—®é¢˜ã€‚</p><h3 id="pure-vs-i-o" tabindex="-1"><a class="header-anchor" href="#pure-vs-i-o" aria-hidden="true">#</a> Pure vs. I/O</h3><p>è¿™é‡Œæœ‰ä¸€ä¸ªæ¯”è¾ƒçš„è¡¨æ ¼ï¼Œç”¨æ¥å¸®åŠ©ç†è§£çº¯ä»£ç å’ŒI/Oä¹‹é—´çš„åŒºåˆ«ã€‚å½“æˆ‘ä»¬è¯´èµ·çº¯ä»£ç çš„æ—¶å€™ï¼Œæˆ‘ä»¬æ˜¯åœ¨è¯´Haskellå‡½æ•°åœ¨è¾“å…¥ç›¸åŒçš„æ—¶å€™æ€»æ˜¯è¿”å›ç›¸åŒç»“æœï¼Œå¹¶ä¸”æ²¡æœ‰å‰¯ä½œç”¨ã€‚</p><p>åœ¨Haskellé‡Œé¢åªæœ‰I/OåŠ¨ä½œçš„æ‰§è¡Œè¿åè¿™äº›è§„åˆ™ã€‚</p><p><strong>è¡¨æ ¼7.1. Pure vs. Impure</strong></p><table><thead><tr><th>Pure</th><th>Impure</th></tr></thead><tbody><tr><td>è¾“å…¥ç›¸åŒæ—¶æ€»æ˜¯äº§ç”Ÿç›¸åŒç»“æœ</td><td>ç›¸åŒçš„å‚æ•°å¯èƒ½äº§ç”Ÿä¸åŒçš„ç»“æœ</td></tr><tr><td>ä»ä¸ä¼šæœ‰å‰¯ä½œç”¨</td><td>å¯èƒ½æœ‰å‰¯ä½œç”¨</td></tr><tr><td>ä»ä¸ä¿®æ”¹çŠ¶æ€</td><td>å¯èƒ½ä¿®æ”¹ç¨‹åºã€ç³»ç»Ÿæˆ–è€…ä¸–ç•Œçš„å…¨å±€çŠ¶æ€</td></tr></tbody></table><h3 id="ä¸ºä»€ä¹ˆçº¯ä¸çº¯å¾ˆé‡è¦" tabindex="-1"><a class="header-anchor" href="#ä¸ºä»€ä¹ˆçº¯ä¸çº¯å¾ˆé‡è¦" aria-hidden="true">#</a> ä¸ºä»€ä¹ˆçº¯ä¸çº¯å¾ˆé‡è¦ï¼Ÿ</h3><p>åœ¨è¿™ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬å·²ç»è®¨è®ºäº†Haskellæ˜¯æ€ä¹ˆåœ¨çº¯ä»£ç å’ŒI/OåŠ¨ä½œä¹‹é—´åšäº†å¾ˆæ˜ç¡®çš„åŒºåˆ†ã€‚å¾ˆå¤šè¯­è¨€æ²¡æœ‰è¿™ç§åŒºåˆ†ã€‚åœ¨Cæˆ–è€…Javaè¿™æ ·çš„è¯­è¨€ä¸­ï¼Œç¼–è¯‘å™¨ä¸èƒ½ä¿è¯ä¸€ä¸ªå‡½æ•°å¯¹äºåŒæ ·çš„å‚æ•°æ€»æ˜¯è¿”å›åŒæ ·çš„ç»“æœï¼Œæˆ–è€…ä¿è¯å‡½æ•°æ²¡æœ‰å‰¯ä½œç”¨ã€‚è¦çŸ¥é“ä¸€ä¸ªå‡½æ•°æœ‰æ²¡æœ‰å‰¯ä½œç”¨åªæœ‰ä¸€ä¸ªåŠæ³•ï¼Œå°±æ˜¯å»è¯»å®ƒçš„æ–‡æ¡£ï¼Œå¹¶ä¸”å¸Œæœ›æ–‡æ¡£è¯´çš„å‡†ç¡®ã€‚</p><p>ç¨‹åºä¸­çš„å¾ˆå¤šé”™è¯¯éƒ½æ˜¯ç”±æ„æ–™ä¹‹å¤–çš„å‰¯ä½œç”¨é€ æˆçš„ã€‚å‡½æ•°åœ¨æŸäº›æƒ…å†µä¸‹å¯¹äºç›¸åŒå‚æ•°å¯èƒ½è¿”å›ä¸åŒçš„ç»“æœï¼Œè¿˜æœ‰æ›´å¤šé”™è¯¯æ˜¯ç”±äºè¯¯è§£äº†è¿™äº›æƒ…å†µè€Œé€ æˆçš„ã€‚å¤šçº¿ç¨‹å’Œå…¶ä»–å½¢å¼çš„å¹¶è¡ŒåŒ–å˜å¾—è¶Šæ¥è¶Šæ™®éï¼Œ ç®¡ç†å…¨å±€å‰¯ä½œç”¨å˜å¾—è¶Šæ¥è¶Šå›°éš¾ã€‚</p><p>Haskelléš”ç¦»å‰¯ä½œç”¨åˆ°I/OåŠ¨ä½œä¸­çš„æ–¹æ³•æä¾›äº†ä¸€ä¸ªæ˜ç¡®çš„ç•Œé™ã€‚ä½ æ€»æ˜¯å¯ä»¥çŸ¥é“ç³»ç»Ÿä¸­çš„é‚£ä¸€éƒ¨åˆ†å¯èƒ½ä¿®æ”¹çŠ¶æ€å“ªä¸€éƒ¨åˆ†ä¸ä¼šã€‚ä½ æ€»æ˜¯å¯ä»¥ç¡®å®šç¨‹åºä¸­çº¯çš„éƒ¨åˆ†ä¸ä¼šæœ‰æ„æƒ³ä¸åˆ°çš„ç»“æœã€‚è¿™æ ·å°±å¸®åŠ©ä½ æ€è€ƒç¨‹åºï¼Œä¹Ÿå¸®åŠ©ç¼–è¯‘å™¨æ€è€ƒç¨‹åºã€‚ æ¯”å¦‚æœ€æ–°ç‰ˆæœ¬çš„ <strong>ghc</strong> å¯ä»¥è‡ªåŠ¨ç»™ä½ ä»£ç çº¯çš„éƒ¨åˆ†æä¾›ä¸€å®šç¨‹åº¦çš„å¹¶è¡ŒåŒ– -- ä¸€ä¸ªè®¡ç®—çš„ç¥åœ£ç›®æ ‡ã€‚</p><p>å¯¹äºè¿™ä¸ªä¸»é¢˜ï¼Œä½ å¯ä»¥åœ¨ <a href="#%E6%83%B0%E6%80%A7io%E7%9A%84%E5%89%AF%E4%BD%9C%E7%94%A8">æƒ°æ€§I/Oçš„å‰¯ä½œç”¨</a> ä¸€èŠ‚çœ‹æ›´å¤šçš„è®¨è®ºã€‚</p><h2 id="ä½¿ç”¨æ–‡ä»¶å’Œå¥æŸ„-handle" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨æ–‡ä»¶å’Œå¥æŸ„-handle" aria-hidden="true">#</a> ä½¿ç”¨æ–‡ä»¶å’Œå¥æŸ„ï¼ˆHandleï¼‰</h2><p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»çœ‹äº†åœ¨è®¡ç®—æœºçš„ç»ˆç«¯é‡Œæ€ä¹ˆå’Œç”¨æˆ·äº¤äº’ã€‚å½“ç„¶ï¼Œä½ ç»å¸¸ä¼šéœ€è¦å»æ“ä½œæŸä¸ªç‰¹å®šæ–‡ä»¶ï¼Œè¿™ä¸ªä¹Ÿå¾ˆç®€å•ã€‚</p><p>Haskellä½I/Oå®šä¹‰äº†ä¸€äº›åŸºæœ¬å‡½æ•°ï¼Œå…¶ä¸­å¾ˆå¤šå’Œä½ åœ¨å…¶ä»–è¯­è¨€é‡Œé¢è§åˆ°çš„ç±»ä¼¼ã€‚<code>System.IO</code> çš„å‚è€ƒæ‰‹å†Œä¸ºè¿™äº›å‡½æ•°æä¾›äº†å¾ˆå¥½çš„æ¦‚è¦ã€‚</p><p>ä½ ä¼šç”¨åˆ°è¿™é‡Œé¢æŸä¸ªæˆ‘ä»¬åœ¨è¿™é‡Œæ²¡æœ‰æåŠçš„æŸä¸ªå‡½æ•°ã€‚</p><p>é€šå¸¸å¼€å§‹çš„æ—¶å€™ä½ ä¼šç”¨åˆ° <code>openFile</code> ï¼Œè¿™ä¸ªå‡½æ•°ç»™ä½ ä¸€ä¸ªæ–‡ä»¶å¥æŸ„ï¼Œè¿™ä¸ªå¥æŸ„ç”¨æ¥å¯¹è¿™ä¸ªæ–‡ä»¶åšç‰¹å®šçš„æ“ä½œã€‚Haskellæä¾›äº†åƒ <code>hPutStrLn</code> è¿™æ ·çš„å‡½æ•°ï¼Œå®ƒç”¨èµ·æ¥å’Œ <code>putStrLn</code> å¾ˆåƒï¼Œä½†æ˜¯å¤šä¸€ä¸ªå‚æ•°ï¼ˆå¥æŸ„ï¼‰ï¼ŒæŒ‡å®šæ“ä½œå“ªä¸ªæ–‡ä»¶ã€‚ å½“æ“ä½œå®Œæˆä¹‹åï¼Œéœ€è¦ç”¨ <code>hClose</code> æ¥å…³é—­è¿™ä¸ªå¥æŸ„ ã€‚ è¿™äº›å‡½æ•°éƒ½æ˜¯å®šä¹‰åœ¨ <code>System.IO</code> ä¸­çš„ï¼Œæ‰€ä»¥å½“ä½ æ“ä½œæ–‡ä»¶çš„æ—¶å€™ä½ è¦å¼•å…¥è¿™ä¸ªæ¨¡å—ã€‚å‡ ä¹æ¯ä¸€ä¸ªé&quot;h&quot;çš„å‡½æ•°éƒ½æœ‰ä¸€ä¸ªå¯¹åº”çš„&quot;h&quot;å‡½æ•°ï¼Œæ¯”å¦‚ï¼Œ<code>print</code> æ‰“å°åˆ°æ˜¾ç¤ºå™¨ï¼Œæœ‰ä¸€ä¸ªå¯¹åº”çš„ <code>hPrint</code> æ‰“å°åˆ°æ–‡ä»¶ã€‚</p><p>æˆ‘ä»¬ç”¨ä¸€ç§å‘½ä»¤å¼çš„æ–¹å¼æ¥å¼€å§‹è¯»å†™æ–‡ä»¶ã€‚ è¿™æœ‰ç‚¹åƒä¸€ä¸ªå…¶ä»–è¯­è¨€ä¸­ <code>while</code> å¾ªç¯ï¼Œè¿™åœ¨Haskellä¸­ä¸æ˜¯æœ€å¥½çš„æ–¹æ³•ã€‚æ¥ç€æˆ‘ä»¬ä¼šçœ‹å‡ ä¸ªæ›´åŠ Haskellé£æ ¼çš„ä¾‹å­ã€‚</p><div class="language-haskell line-numbers-mode" data-ext="haskell"><pre class="language-haskell"><code><span class="token comment">-- file: ch07/toupper-imp.hs</span>
<span class="token import-statement"><span class="token keyword">import</span> System<span class="token punctuation">.</span>IO</span>
<span class="token import-statement"><span class="token keyword">import</span> Data<span class="token punctuation">.</span>Char</span><span class="token punctuation">(</span><span class="token builtin">toUpper</span><span class="token punctuation">)</span>

<span class="token hvariable">main</span> <span class="token operator">::</span> <span class="token constant">IO</span> <span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token hvariable">main</span> <span class="token operator">=</span> <span class="token keyword">do</span>
    <span class="token hvariable">inh</span> <span class="token operator">&lt;-</span> <span class="token hvariable">openFile</span> <span class="token string">&quot;input.txt&quot;</span> <span class="token constant">ReadMode</span>
    <span class="token hvariable">outh</span> <span class="token operator">&lt;-</span> <span class="token hvariable">openFile</span> <span class="token string">&quot;output.txt&quot;</span> <span class="token constant">WriteMode</span>
    <span class="token hvariable">mainloop</span> <span class="token hvariable">inh</span> <span class="token hvariable">outh</span>
    <span class="token hvariable">hClose</span> <span class="token hvariable">inh</span>
    <span class="token hvariable">hClose</span> <span class="token hvariable">outh</span>

<span class="token hvariable">mainloop</span> <span class="token operator">::</span> <span class="token constant">Handle</span> <span class="token operator">-&gt;</span> <span class="token constant">Handle</span> <span class="token operator">-&gt;</span> <span class="token constant">IO</span> <span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token hvariable">mainloop</span> <span class="token hvariable">inh</span> <span class="token hvariable">outh</span> <span class="token operator">=</span>
    <span class="token keyword">do</span> <span class="token hvariable">ineof</span> <span class="token operator">&lt;-</span> <span class="token hvariable">hIsEOF</span> <span class="token hvariable">inh</span>
       <span class="token keyword">if</span> <span class="token hvariable">ineof</span>
       <span class="token keyword">then</span> <span class="token builtin">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span>
       <span class="token keyword">else</span> <span class="token keyword">do</span> <span class="token hvariable">inpStr</span> <span class="token operator">&lt;-</span> <span class="token hvariable">hGetLine</span> <span class="token hvariable">inh</span>
               <span class="token hvariable">hPutStrLn</span> <span class="token hvariable">outh</span> <span class="token punctuation">(</span><span class="token builtin">map</span> <span class="token builtin">toUpper</span> <span class="token hvariable">inpStr</span><span class="token punctuation">)</span>
               <span class="token hvariable">mainloop</span> <span class="token hvariable">inh</span> <span class="token hvariable">outh</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åƒæ¯ä¸€ä¸ªHaskellç¨‹åºä¸€æ ·ï¼Œç¨‹åºåœ¨ <code>main</code> é‚£é‡Œå¼€å§‹æ‰§è¡Œã€‚ ä¸¤ä¸ªæ–‡ä»¶è¢«æ‰“å¼€ï¼š <code>input.txt</code> è¢«æ‰“å¼€ç”¨æ¥è¯»ï¼Œè¿˜æœ‰ä¸€ä¸ª <code>output.txt</code> è¢«æ‰“å¼€ç”¨æ¥å†™ã€‚ç„¶åæˆ‘ä»¬è°ƒç”¨ <code>mainloop</code> æ¥å¤„ç†è¿™ä¸ªæ–‡ä»¶ã€‚</p><p><code>mainloop</code> å¼€å§‹çš„æ—¶å€™æ£€æŸ¥çœ‹çœ‹æˆ‘ä»¬æ˜¯å¦åœ¨è¾“å…¥æ–‡ä»¶çš„ç»“å°¾ï¼ˆEOFï¼‰ã€‚å¦‚æœä¸æ˜¯ï¼Œæˆ‘ä»¬ä»è¾“å…¥æ–‡ä»¶è¯»å–ä¸€è¡Œï¼ŒæŠŠè¿™ä¸€è¡Œè½¬æˆå¤§å†™ï¼Œå†æŠŠå®ƒå†™åˆ°è¾“å‡ºæ–‡ä»¶ã€‚ç„¶åæˆ‘ä»¬é€’å½’è°ƒç”¨ <code>mainloop</code> ç»§ç»­å¤„ç†è¿™ä¸ªæ–‡ä»¶ã€‚</p><p>æ³¨æ„é‚£ä¸ª <code>return</code> è°ƒç”¨ã€‚ è¿™ä¸ªå’ŒCæˆ–è€…Pythonä¸­çš„ <code>return</code> ä¸ä¸€æ ·ã€‚åœ¨é‚£äº›è¯­è¨€ä¸­ï¼Œ <code>return</code> ç”¨æ¥ç«‹å³é€€å‡ºå½“å‰å‡½æ•°çš„æ‰§è¡Œï¼Œå¹¶ä¸”ç»™è°ƒç”¨è€…è¿”å›ä¸€ä¸ªå€¼ã€‚ åœ¨Haskellä¸­ï¼Œ<code>return</code> æ˜¯å’Œ <code>&lt;-</code> ç›¸åã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œ <code>return</code> æ¥å—ä¸€ä¸ªçº¯çš„å€¼ï¼ŒæŠŠå®ƒåŒ…è£…è¿›IOã€‚ å› ä¸ºæ¯ä¸ªI/OåŠ¨ä½œå¿…é¡»è¿”å›æŸä¸ª <code>IO</code> ç±»å‹ï¼Œå¦‚æœä½ çš„ç»“æœæ¥è‡ªçº¯çš„è®¡ç®—ï¼Œä½ å¿…é¡»ç”¨ <code>return</code> æŠŠå®ƒåŒ…è£…è¿›IOã€‚ä¸¾ä¸€ä¸ªä¾‹å­ï¼Œå¦‚æœ <code>7</code> æ˜¯ä¸€ä¸ª <code>Int</code> ï¼Œç„¶å <code>return 7</code> ä¼šåˆ›å»ºä¸€ä¸ªåŠ¨ä½œï¼Œé‡Œé¢ä¿å­˜äº†ä¸€ä¸ª <code>IO Int</code> ç±»å‹çš„å€¼ã€‚åœ¨æ‰§è¡Œçš„æ—¶å€™ï¼Œè¿™ä¸ªåŠ¨ä½œå°†ä¼šäº§ç”Ÿç»“æœ <code>7</code> ã€‚ å…³äº <code>return</code> çš„æ›´å¤šç»†èŠ‚ï¼Œå¯ä»¥å‚è§ <a href="#return%E7%9A%84%E6%9C%AC%E8%89%B2">Returnçš„æœ¬è‰²</a> ä¸€èŠ‚ã€‚</p><p>æˆ‘ä»¬æ¥å°è¯•è¿è¡Œè¿™ä¸ªç¨‹åºã€‚ æˆ‘ä»¬å·²ç»æœ‰ä¸€ä¸ªåƒè¿™æ ·çš„åå­—å« <code>input.txt</code> çš„æ–‡ä»¶ï¼š</p><pre><code>This is ch08/input.txt

Test Input
I like Haskell
Haskell is great
I/O is fun

123456789
</code></pre><p>ç°åœ¨ï¼Œä½ å¯ä»¥æ‰§è¡Œ <code>runghc toupper-imp.hs</code>ï¼Œä½ ä¼šåœ¨ä½ çš„ç›®å½•é‡Œæ‰¾åˆ° <code>output.txt</code> ã€‚ å®ƒçœ‹èµ·æ¥åº”è¯¥æ˜¯è¿™æ ·ï¼š</p><pre><code>THIS IS CH08/INPUT.TXT

TEST INPUT
I LIKE HASKELL
HASKELL IS GREAT
I/O IS FUN

123456789
</code></pre><h3 id="å…³äº-openfile-çš„æ›´å¤šä¿¡æ¯" tabindex="-1"><a class="header-anchor" href="#å…³äº-openfile-çš„æ›´å¤šä¿¡æ¯" aria-hidden="true">#</a> å…³äº openFile çš„æ›´å¤šä¿¡æ¯</h3><p>æˆ‘ä»¬ç”¨ <strong>ghci</strong> æ¥æ£€æŸ¥ <code>openFile</code> çš„ç±»å‹ï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>ghci<span class="token operator">&gt;</span> :module System.IO
ghci<span class="token operator">&gt;</span> :type openFile
openFile :: FilePath -<span class="token operator">&gt;</span> IOMode -<span class="token operator">&gt;</span> IO Handle
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>FilePath</code> å°±æ˜¯ <code>String</code> çš„å¦ä¸€ä¸ªåå­—ã€‚å®ƒåœ¨I/Oå‡½æ•°çš„ç±»å‹ä¸­ä½¿ç”¨ï¼Œç”¨æ¥é˜æ˜é‚£ä¸ªå‚æ•°æ˜¯ç”¨æ¥è¡¨ç¤ºæ–‡ä»¶åçš„ï¼Œè€Œä¸æ˜¯å…¶ä»–é€šå¸¸çš„æ•°æ®ã€‚</p><p><code>IOMode</code> æŒ‡å®šæ–‡ä»¶æ˜¯æ€ä¹ˆè¢«ç®¡ç†çš„ï¼Œ <code>IOMode</code> çš„å¯èƒ½å€¼åœ¨è¡¨æ ¼7.2ä¸­åˆ—å‡ºæ¥äº†ã€‚</p><p><strong>è¡¨æ ¼7.2. IOMode å¯èƒ½å€¼</strong></p><table><thead><tr><th>IOMode</th><th>å¯è¯»</th><th>å¯å†™</th><th>å¼€å§‹ä½ç½®</th><th>å¤‡æ³¨</th></tr></thead><tbody><tr><td>ReadMode</td><td>æ˜¯</td><td>å¦</td><td>æ–‡ä»¶å¼€å¤´</td><td>æ–‡ä»¶å¿…é¡»å­˜åœ¨</td></tr><tr><td>WriteMode</td><td>å¦</td><td>æ˜¯</td><td>æ–‡ä»¶å¼€å¤´</td><td>å¦‚æœå­˜åœ¨ï¼Œæ–‡ä»¶ä¼šè¢«æˆªæ–­ï¼ˆå®Œå…¨æ¸…ç©ºï¼‰</td></tr><tr><td>ReadWriteMode</td><td>æ˜¯</td><td>æ˜¯</td><td>æ–‡ä»¶å¼€å¤´</td><td>å¦‚æœä¸å­˜åœ¨ä¼šæ–°å»ºæ–‡ä»¶ï¼Œå¦‚æœå­˜åœ¨ä¸ä¼šæŸå®³åŸæ¥çš„æ•°æ®</td></tr><tr><td>AppendMode</td><td>å¦</td><td>æ˜¯</td><td>æ–‡ä»¶ç»“å°¾</td><td>å¦‚æœä¸å­˜åœ¨ä¼šæ–°å»ºæ–‡ä»¶ï¼Œå¦‚æœå­˜åœ¨ä¸ä¼šæŸå®³åŸæ¥çš„æ•°æ®</td></tr></tbody></table><p>æˆ‘ä»¬åœ¨è¿™ä¸€ç« é‡Œå¤§å¤šæ•°æ˜¯æ“ä½œæ–‡æœ¬æ–‡ä»¶ï¼ŒäºŒè¿›åˆ¶æ–‡ä»¶åŒæ ·å¯ä»¥åœ¨Haskellé‡Œä½¿ç”¨ã€‚å¦‚æœä½ åœ¨æ“ä½œä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä½ è¦ç”¨ <code>openBinaryFile</code> æ›¿ä»£ <code>openFile</code> ã€‚ä½ å½“åšäºŒè¿›åˆ¶æ–‡ä»¶æ‰“å¼€ï¼Œè€Œä¸æ˜¯å½“åšæ–‡æœ¬æ–‡ä»¶æ‰“å¼€çš„è¯ï¼ŒåƒWindowsè¿™æ ·çš„æ“ä½œç³»ç»Ÿä¼šç”¨ä¸åŒçš„æ–¹å¼æ¥å¤„ç†æ–‡ä»¶ã€‚åœ¨Linuxè¿™ç±»æ“ä½œç³»ç»Ÿä¸­ï¼Œ <code>openFile</code> å’Œ <code>openBinaryFile</code> æ‰§è¡Œç›¸åŒçš„æ“ä½œã€‚ä¸è¿‡ä¸ºäº†ç§»æ¤æ€§ï¼Œå½“ä½ å¤„ç†äºŒè¿›åˆ¶æ•°æ®çš„æ—¶å€™æ€»æ˜¯ç”¨ <code>openBinaryFile</code> è¿˜æ˜¯æ˜æ™ºçš„ã€‚</p><h3 id="å…³é—­å¥æŸ„" tabindex="-1"><a class="header-anchor" href="#å…³é—­å¥æŸ„" aria-hidden="true">#</a> å…³é—­å¥æŸ„</h3><p>ä½ å·²ç»çœ‹åˆ° <code>hClose</code> ç”¨æ¥å…³é—­æ–‡ä»¶å¥æŸ„ ã€‚æˆ‘ä»¬èŠ±ç‚¹æ—¶é—´æ€è€ƒä¸‹ä¸ºä»€ä¹ˆè¿™ä¸ªå¾ˆé‡è¦ã€‚</p><p>å°±å’Œä½ å°†åœ¨ <a href="#%E7%BC%93%E5%86%B2%E5%8C%BAbuffering">ç¼“å†²åŒºï¼ˆBufferingï¼‰</a> ä¸€èŠ‚çœ‹åˆ°çš„ä¸€æ ·ï¼ŒHaskellä¸ºæ–‡ä»¶ç»´æŠ¤å†…éƒ¨ç¼“å†²åŒºï¼Œè¿™æä¾›äº†ä¸€ä¸ªé‡è¦çš„æ€§èƒ½æå‡ã€‚ç„¶è€Œï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œç›´åˆ°ä½ åœ¨ä¸€ä¸ªæ‰“å¼€æ¥å†™çš„æ–‡ä»¶ä¸Šè°ƒç”¨ <code>hClose</code> ï¼Œä½ çš„æ•°æ®ä¸ä¼šè¢«æ¸…ç†å‡ºæ“ä½œç³»ç»Ÿã€‚</p><p>ç¡®ä¿ <code>hClose</code> çš„å¦ä¸€ä¸ªç†ç”±æ˜¯ï¼Œæ‰“å¼€çš„æ–‡ä»¶ä¼šå ç”¨ç³»ç»Ÿèµ„æºã€‚å¦‚æœä½ çš„ç¨‹åºè¿è¡Œå¾ˆé•¿ä¸€æ®µæ—¶é—´ï¼Œå¹¶ä¸”æ‰“å¼€äº†å¾ˆå¤šæ–‡ä»¶ï¼Œä½†æ˜¯æ²¡æœ‰å…³é—­ä»–ä»¬ï¼Œä½ çš„ç¨‹åºå¾ˆæœ‰å¯èƒ½å› ä¸ºèµ„æºè€—å°½è€Œå´©æºƒã€‚Haskellåœ¨è¿™æ–¹é¢å’Œå…¶ä»–è¯­è¨€æ²¡æœ‰ä»€ä¹ˆä¸åŒã€‚</p><p>å½“ä¸€ä¸ªç¨‹åºé€€å‡ºçš„æ—¶å€™ï¼ŒHaskellé€šå¸¸ä¼šå°å¿ƒåœ°å…³é—­æ‰€æœ‰è¿˜æ‰“å¼€ç€çš„æ–‡ä»¶ã€‚ç„¶è€Œåœ¨ä¸€äº›æƒ…å†µä¸‹Haskellå¯èƒ½ä¸ä¼šå¸®ä½ åšè¿™äº›ã€‚æ‰€ä»¥å†ä¸€æ¬¡å¼ºè°ƒï¼Œæœ€å¥½åœ¨ä»»ä½•æ—¶å€™éƒ½ç”±ä½ æ¥è´Ÿè´£è°ƒç”¨ <code>hClose</code> ã€‚</p><p>Haskellç»™ä½ æä¾›äº†ä¸€äº›å·¥å…·ï¼Œä¸ç®¡å‡ºç°ä»€ä¹ˆé”™è¯¯ï¼Œç”¨æ¥ç®€å•åœ°ç¡®ä¿è¿™äº›å·¥ä½œã€‚ä½ å¯ä»¥é˜…è¯»åœ¨ <a href="#%E6%89%A9%E5%B1%95%E4%BE%8B%E5%AD%90%E5%87%BD%E6%95%B0%E5%BC%8Fio%E5%92%8C%E4%B8%B4%E6%97%B6%E6%96%87%E4%BB%B6">æ‰©å±•ä¾‹å­ï¼šå‡½æ•°å¼I/Oå’Œä¸´æ—¶æ–‡ä»¶</a> ä¸€èŠ‚çš„ <code>finally</code> å’Œ <a href="">è·å–-ä½¿ç”¨-å›æ”¶ å‘¨æœŸ</a> ä¸€èŠ‚çš„ <code>bracket</code> ã€‚</p><h3 id="seek-and-tell" tabindex="-1"><a class="header-anchor" href="#seek-and-tell" aria-hidden="true">#</a> Seek and Tell</h3><p>å½“ä»ä¸€ä¸ªå¯¹åº”ç¡¬ç›˜ä¸ŠæŸä¸ªæ–‡ä»¶å¥æŸ„ä¸Šè¯»å†™çš„æ—¶å€™ï¼Œæ“ä½œç³»ç»Ÿç»´æŠ¤äº†ä¸€ä¸ªå½“å‰ç¡¬ç›˜ä½ç½®çš„å†…éƒ¨è®°å½•ã€‚æ¯æ¬¡ä½ åšå¦ä¸€æ¬¡è¯»çš„æ—¶å€™ï¼Œæ“ä½œç³»ç»Ÿè¿”å›ä¸‹ä¸€ä¸ªä»å½“å‰ä½ç½®å¼€å§‹çš„æ•°æ®å—ï¼Œå¹¶ä¸”å¢åŠ è¿™ä¸ªä½ç½®ï¼Œåæ˜ å‡ºä½ æ­£åœ¨è¯»çš„æ•°æ®ã€‚</p><p>ä½ å¯ä»¥ç”¨ <code>hTell</code> æ¥æ‰¾å‡ºä½ æ–‡ä»¶ä¸­çš„å½“å‰ä½ç½®ã€‚å½“æ–‡ä»¶åˆšæ–°å»ºçš„æ—¶å€™ï¼Œæ–‡ä»¶æ˜¯ç©ºçš„ï¼Œè¿™ä¸ªä½ç½®ä¸º0ã€‚åœ¨ä½ å†™å…¥5ä¸ªå­—èŠ‚ä¹‹åï¼Œä½ç½®ä¼šå˜æˆ5ï¼Œè¯¸å¦‚æ­¤ç±»ã€‚ <code>hTell</code> æ¥å—ä¸€ä¸ª <code>Handle</code> å¹¶è¿”å›ä¸€ä¸ªå¸¦æœ‰ä½ç½®çš„ <code>IO Integer</code> ã€‚</p><p><code>hTell</code> çš„ä¼™ä¼´æ˜¯ <code>hSeek</code> ã€‚ <code>hSeek</code> è®©ä½ å¯ä»¥æ”¹å˜æ–‡ä»¶ä½ç½®ï¼Œå®ƒæœ‰3ä¸ªå‚æ•°ï¼šä¸€ä¸ª <code>Handle</code> ï¼Œ ä¸€ä¸ª <code>seekMode</code> ï¼Œè¿˜æœ‰ä¸€ä¸ªä½ç½®ã€‚</p><p><code>SeekMode</code> å¯ä»¥æ˜¯ä¸‰ä¸ªä¸åŒå€¼ä¸­çš„ä¸€ä¸ªï¼Œè¿™ä¸ªå€¼æŒ‡å®šæ€ä¹ˆå»è§£æè¿™ä¸ªç»™çš„ä½ç½®ã€‚</p><p><code>AbsoluteSeek</code> è¡¨ç¤ºè¿™ä¸ªä½ç½®æ˜¯åœ¨æ–‡ä»¶ä¸­çš„ç²¾ç¡®ä½ç½®ï¼Œè¿™ä¸ªå’Œ <code>hTell</code> ç»™ä½ çš„æ˜¯åŒæ ·çš„ä¿¡æ¯ã€‚ <code>RelativeSeek</code> è¡¨ç¤ºä»å½“å‰ä½ç½®å¼€å§‹å¯»æ‰¾ï¼Œä¸€ä¸ªæ­£æ•°è¦æ±‚åœ¨æ–‡ä»¶ä¸­å‘å‰æ¨è¿›ï¼Œä¸€ä¸ªè´Ÿæ•°è¦æ±‚å‘åå€’é€€ã€‚</p><p>æœ€åï¼Œ <code>SeekFromEnd</code> ä¼šå¯»æ‰¾æ–‡ä»¶ç»“å°¾ä¹‹å‰ç‰¹å®šæ•°ç›®çš„å­—èŠ‚ã€‚ <code>hSeek handle SeekFromEnd 0</code> æŠŠä½ å¸¦åˆ°æ–‡ä»¶ç»“å°¾ã€‚</p><p>ä¸¾ä¸€ä¸ª <code>hSeek</code> çš„ä¾‹å­ï¼Œå‚è€ƒ <a href="#%E6%89%A9%E5%B1%95%E4%BE%8B%E5%AD%90%E5%87%BD%E6%95%B0%E5%BC%8Fio%E5%92%8C%E4%B8%B4%E6%97%B6%E6%96%87%E4%BB%B6">æ‰©å±•ä¾‹å­ï¼šå‡½æ•°å¼I/Oå’Œä¸´æ—¶æ–‡ä»¶</a> ä¸€èŠ‚ã€‚</p><p>ä¸æ˜¯æ‰€æœ‰å¥æŸ„éƒ½æ˜¯å¯ä»¥å®šä½çš„ã€‚ä¸€ä¸ªå¥æŸ„é€šå¸¸å¯¹åº”äºä¸€ä¸ªæ–‡ä»¶ï¼Œä½†æ˜¯å®ƒä¹Ÿå¯ä»¥å¯¹åº”å…¶ä»–ä¸œè¥¿ï¼Œæ¯”å¦‚ç½‘ç»œè¿æ¥ï¼Œç£å¸¦æœºæˆ–è€…ç»ˆç«¯ã€‚ä½ å¯ä»¥ç”¨ <code>hIsSeekable</code> å»çœ‹ç»™å®šçš„å¥æŸ„æ˜¯ä¸æ˜¯å¯å®šä½çš„ã€‚</p><h3 id="æ ‡å‡†è¾“å…¥-è¾“å‡ºå’Œé”™è¯¯" tabindex="-1"><a class="header-anchor" href="#æ ‡å‡†è¾“å…¥-è¾“å‡ºå’Œé”™è¯¯" aria-hidden="true">#</a> æ ‡å‡†è¾“å…¥ï¼Œè¾“å‡ºå’Œé”™è¯¯</h3><p>å…ˆå‰æˆ‘ä»¬æŒ‡å‡ºå¯¹äºæ¯ä¸€ä¸ªé&quot;h&quot;å‡½æ•°é€šå¸¸æœ‰ä¸€ä¸ªå¯¹åº”çš„&quot;h&quot;å‡½æ•°ç”¨åœ¨å¥æŸ„ä¸Šçš„ã€‚å®é™…ä¸Šï¼Œé&quot;h&quot;çš„å‡½æ•°å°±æ˜¯ä»–ä»¬çš„&quot;h&quot;å‡½æ•°çš„ä¸€ä¸ªå¿«æ·æ–¹å¼ã€‚</p><p>åœ¨ <code>System.IO</code> é‡Œæœ‰3ä¸ªé¢„å®šä¹‰çš„å¥æŸ„ï¼Œè¿™äº›å¥æŸ„æ€»æ˜¯å¯ç”¨çš„ã€‚ ä»–ä»¬æ˜¯ <code>stdin</code>ï¼Œå¯¹åº”æ ‡å‡†è¾“å…¥ï¼› <code>stdout</code> ï¼Œå¯¹åº”æ ‡å‡†è¾“å‡ºï¼›å’Œ <code>stderr</code> å¯¹åº”æ ‡å‡†é”™è¯¯ã€‚æ ‡å‡†è¾“å…¥ä¸€èˆ¬å¯¹åº”é”®ç›˜ï¼Œæ ‡å‡†è¾“å‡ºå¯¹åº”æ˜¾ç¤ºå™¨ï¼Œæ ‡å‡†é”™è¯¯ä¸€èˆ¬è¾“å‡ºåˆ°æ˜¾ç¤ºå™¨ã€‚</p><p>åƒ <code>getLine</code> çš„è¿™äº›å‡½æ•°å¯ä»¥ç®€å•åœ°è¿™æ ·å®šä¹‰ï¼š</p><div class="language-haskell line-numbers-mode" data-ext="haskell"><pre class="language-haskell"><code><span class="token builtin">getLine</span> <span class="token operator">=</span> <span class="token hvariable">hGetLine</span> <span class="token hvariable">stdin</span>
<span class="token builtin">putStrLn</span> <span class="token operator">=</span> <span class="token hvariable">hPutStrLn</span> <span class="token hvariable">stdout</span>
<span class="token builtin">print</span> <span class="token operator">=</span> <span class="token hvariable">hPrint</span> <span class="token hvariable">stdout</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">Tip</p><p>æˆ‘ä»¬è¿™é‡Œä½¿ç”¨äº†å±€éƒ¨åº”ç”¨ã€‚</p></div><p>å¦‚æœä¸æ˜ç™½ï¼Œå¯ä»¥å‚è€ƒ <a href="">éƒ¨åˆ†å‡½æ•°åº”ç”¨å’ŒæŸ¯é‡ŒåŒ–</a></p><p>ä¹‹å‰æˆ‘ä»¬å‘Šè¯‰ä½ è¿™3ä¸ªæ ‡å‡†æ–‡ä»¶å¥æŸ„ä¸€èˆ¬å¯¹åº”ä»€ä¹ˆã€‚é‚£æ˜¯å› ä¸ºä¸€äº›æ“ä½œç³»ç»Ÿå¯ä»¥è®©ä½ é‡å®šå‘è¿™ä¸ªæ–‡ä»¶å¥æŸ„åˆ°ä¸åŒçš„åœ°æ–¹-æ–‡ä»¶ï¼Œè®¾å¤‡ï¼Œç”šè‡³æ˜¯å…¶ä»–ç¨‹åºã€‚è¿™ä¸ªåŠŸèƒ½åœ¨POSIXï¼ˆLinuxï¼ŒBSDï¼ŒMacï¼‰æ“ä½œç³»ç»ŸShellç¼–ç¨‹ä¸­å¹¿æ³›ä½¿ç”¨ï¼Œåœ¨Windowsä¸­ä¹Ÿèƒ½ä½¿ç”¨ã€‚</p><p>ä½¿ç”¨æ ‡å‡†è¾“å…¥è¾“å‡ºç»å¸¸æ˜¯å¾ˆæœ‰ç”¨çš„ï¼Œè¿™è®©ä½ å’Œç»ˆç«¯å‰çš„ç”¨æˆ·äº¤äº’ã€‚å®ƒä¹Ÿèƒ½è®©ä½ æ“ä½œè¾“å…¥è¾“å‡ºæ–‡ä»¶ï¼Œæˆ–è€…ç”šè‡³è®©ä½ çš„ä»£ç å’Œå…¶ä»–ç¨‹åºç»„åˆåœ¨ä¸€èµ·ã€‚</p><p>ä¸¾ä¸€ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬å¯ä»¥åƒè¿™æ ·åœ¨å‰é¢æä¾›æ ‡å‡†è¾“å…¥ç»™ <code>callingpure.hs</code> ï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>$ <span class="token builtin class-name">echo</span> John<span class="token operator">|</span>runghc callingpure.hs
Greetings once again.  What is your name?
Pleased to meet you, John.
Your name contains <span class="token number">4</span> characters.
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å½“ <code>callingpure.hs</code> è¿è¡Œçš„æ—¶å€™ï¼Œå®ƒä¸ç”¨ç­‰å¾…é”®ç›˜çš„è¾“å…¥ï¼Œè€Œæ˜¯ä» <code>echo</code> ç¨‹åºæ¥æ”¶ <code>John</code> ã€‚ æ³¨æ„è¾“å‡ºä¹Ÿæ²¡æœ‰æŠŠ <code>John</code> è¿™ä¸ªè¯æ”¾åœ¨ä¸€ä¸ªåˆ†å¼€çš„è¡Œï¼Œè¿™å’Œç”¨é”®ç›˜è¿è¡Œç¨‹åºä¸€æ ·ã€‚ç»ˆç«¯ä¸€èˆ¬å›æ˜¾æ‰€æœ‰ä½ è¾“å…¥çš„ä¸œè¥¿ç»™ä½ ï¼Œä½†è¿™æ˜¯ä¸€ä¸ªæŠ€æœ¯ä¸Šçš„è¾“å…¥ï¼Œä¸ä¼šåŒ…å«åœ¨è¾“å‡ºæµä¸­ã€‚</p><h3 id="åˆ é™¤å’Œé‡å‘½åæ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#åˆ é™¤å’Œé‡å‘½åæ–‡ä»¶" aria-hidden="true">#</a> åˆ é™¤å’Œé‡å‘½åæ–‡ä»¶</h3><p>è¿™ä¸€ç« åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»è®¨è®ºäº†æ–‡ä»¶çš„å†…å®¹ã€‚ç°åœ¨è®©æˆ‘ä»¬è¯´ä¸€ç‚¹æ–‡ä»¶è‡ªå·±çš„ä¸œè¥¿ã€‚ <code>System.Directory</code> æä¾›äº†ä¸¤ä¸ªä½ å¯èƒ½è§‰å¾—æœ‰ç”¨çš„å‡½æ•°ã€‚ <code>removeFile</code> æ¥å—ä¸€ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ–‡ä»¶åï¼Œç„¶ååˆ é™¤é‚£ä¸ªæ–‡ä»¶ã€‚ <code>renameFile</code> æ¥å—ä¸¤ä¸ªæ–‡ä»¶åï¼šç¬¬ä¸€ä¸ªæ˜¯è€çš„æ–‡ä»¶åï¼Œç¬¬äºŒä¸ªæ˜¯æ–°çš„æ–‡ä»¶åã€‚å¦‚æœæ–°çš„æ–‡ä»¶ååœ¨å¦å¤–ä¸€ä¸ªç›®å½•ä¸­ï¼Œä½ ä¹Ÿå¯ä»¥æŠŠå®ƒæƒ³è±¡æˆç§»åŠ¨æ–‡ä»¶ã€‚ åœ¨è°ƒç”¨ <code>renameFile</code> ä¹‹å‰è€çš„æ–‡ä»¶å¿…é¡»å­˜åœ¨ã€‚å¦‚æœæ–°çš„æ–‡ä»¶å·²ç»å­˜åœ¨äº†ï¼Œå®ƒåœ¨é‡å‘½åä¹‹å‰ä¼šè¢«åˆ é™¤æ‰ã€‚</p><p>åƒå¾ˆå¤šå…¶ä»–æ¥å—æ–‡ä»¶åçš„å‡½æ•°ä¸€æ ·ï¼Œå¦‚æœè€çš„æ–‡ä»¶åä¸å­˜åœ¨ï¼Œ <code>renameFile</code> ä¼šå¼•å‘ä¸€ä¸ªå¼‚å¸¸ã€‚ æ›´å¤šå…³äºå¼‚å¸¸å¤„ç†çš„ä¿¡æ¯ä½ å¯ä»¥åœ¨ <a href="">ç¬¬åä¹ç« ï¼Œé”™è¯¯å¤„ç†</a> ä¸­æ‰¾åˆ°ã€‚</p><p>åœ¨ <code>System.Directory</code> ä¸­æœ‰å¾ˆå¤šå…¶ä»–å‡½æ•°ï¼Œç”¨æ¥åˆ›å»ºå’Œåˆ é™¤ç›®å½•ï¼ŒæŸ¥æ‰¾ç›®å½•ä¸­æ–‡ä»¶åˆ—è¡¨ï¼Œå’Œæµ‹è¯•æ–‡ä»¶æ˜¯å¦å­˜åœ¨ã€‚å®ƒä»¬åœ¨ <a href="">ç›®å½•å’Œæ–‡ä»¶ä¿¡æ¯</a> ä¸€èŠ‚ä¸­è®¨è®ºã€‚</p><h3 id="ä¸´æ—¶æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#ä¸´æ—¶æ–‡ä»¶" aria-hidden="true">#</a> ä¸´æ—¶æ–‡ä»¶</h3><p>ç¨‹åºå‘˜é¢‘ç¹éœ€è¦ç”¨åˆ°ä¸´æ—¶æ–‡ä»¶ã€‚ä¸´æ—¶æ–‡ä»¶å¯èƒ½ç”¨æ¥å­˜å‚¨å¤§é‡éœ€è¦è®¡ç®—çš„æ•°æ®ï¼Œå…¶ä»–ç¨‹åºè¦ä½¿ç”¨çš„æ•°æ®ï¼Œæˆ–è€…å¾ˆå¤šå…¶ä»–çš„ç”¨æ³•ã€‚</p><p>å½“ä½ æƒ³ä¸€ä¸ªåŠæ³•æ¥æ‰‹åŠ¨æ‰“å¼€åŒåçš„å¤šä¸ªæ–‡ä»¶ï¼Œå®‰å…¨åœ°åšåˆ°è¿™ä¸€ç‚¹çš„ç»†èŠ‚åœ¨å„ä¸ªå¹³å°ä¸Šéƒ½ä¸ç›¸åŒã€‚Haskellæä¾›äº†ä¸€ä¸ªæ–¹ä¾¿çš„å‡½æ•°å«åš <code>openTempFile</code> ï¼ˆè¿˜æœ‰ä¸€ä¸ªå¯¹åº”çš„ <code>openBinaryTempFile</code> ï¼‰æ¥ä¸ºä½ å¤„ç†è¿™ä¸ªéš¾ç‚¹ã€‚</p><p><code>openTempFile</code> æ¥å—ä¸¤ä¸ªå‚æ•°ï¼šåˆ›å»ºæ–‡ä»¶æ‰€åœ¨çš„ç›®å½•ï¼Œå’Œä¸€ä¸ªå‘½åæ–‡ä»¶çš„&quot;æ¨¡æ¿&quot;ã€‚è¿™ä¸ªç›®å½•å¯ä»¥ç®€å•æ˜¯&quot;.&quot;ï¼Œè¡¨ç¤ºå½“å‰ç›®å½•ã€‚ æˆ–è€…ä½ å¯ä»¥ç”¨ <code>System.Directory.getTemporaryDirectory</code> å»æ‰¾æŒ‡å®šæœºå™¨ä¸Šå­˜æ”¾ä¸´æ—¶æ–‡ä»¶æœ€å¥½çš„åœ°æ–¹ã€‚è¿™ä¸ªæ¨¡æ¿ç”¨åšæ–‡ä»¶åçš„åŸºç¡€ï¼Œå®ƒä¼šæ·»åŠ ä¸€äº›éšæœºçš„å­—ç¬¦æ¥ä¿è¯æ–‡ä»¶åæ˜¯å”¯ä¸€çš„ï¼Œä»å®é™…ä¸Šä¿è¯è¢«æ“ä½œçš„æ–‡ä»¶å…·æœ‰ç‹¬ä¸€æ— äºŒçš„æ–‡ä»¶åã€‚</p><p><code>openTempFile</code> è¿”å›ç±»å‹æ˜¯ <code>IO (FilePath, Handle)</code> ã€‚å…ƒç»„çš„ç¬¬ä¸€éƒ¨åˆ†æ˜¯åˆ›å»ºçš„æ–‡ä»¶çš„åå­—ï¼Œç¬¬äºŒéƒ¨åˆ†æ˜¯ç”¨ <code>ReadWriteMode</code> æ‰“å¼€é‚£ä¸ªæ–‡ä»¶çš„ä¸€ä¸ªå¥æŸ„ ã€‚ å½“ä½ å¤„ç†å®Œè¿™ä¸ªæ–‡ä»¶ï¼Œä½ è¦ <code>hClose</code> å®ƒå¹¶ä¸”è°ƒç”¨ <code>removeFile</code> åˆ é™¤å®ƒã€‚ çœ‹ä¸‹é¢çš„ä¾‹å­ä¸­ä¸€ä¸ªæ ·æœ¬å‡½æ•°çš„ä½¿ç”¨ã€‚</p><h2 id="æ‰©å±•ä¾‹å­-å‡½æ•°å¼i-oå’Œä¸´æ—¶æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#æ‰©å±•ä¾‹å­-å‡½æ•°å¼i-oå’Œä¸´æ—¶æ–‡ä»¶" aria-hidden="true">#</a> æ‰©å±•ä¾‹å­ï¼šå‡½æ•°å¼I/Oå’Œä¸´æ—¶æ–‡ä»¶</h2><p>è¿™é‡Œæœ‰ä¸€ä¸ªå¤§ä¸€ç‚¹çš„ä¾‹å­ï¼Œå®ƒæŠŠå¾ˆå¤šè¿™ä¸€ç« çš„è¿˜æœ‰å‰é¢å‡ ç« çš„æ¦‚å¿µæ”¾åœ¨ä¸€èµ·ï¼Œè¿˜åŒ…å«äº†ä¸€äº›æ²¡æœ‰ä»‹ç»è¿‡çš„æ¦‚å¿µã€‚çœ‹ä¸€ä¸‹è¿™ä¸ªç¨‹åºï¼Œçœ‹ä½ æ˜¯å¦èƒ½çŸ¥é“å®ƒæ˜¯å¹²ä»€ä¹ˆçš„ï¼Œæ˜¯æ€ä¹ˆåšçš„ã€‚</p><div class="language-haskell line-numbers-mode" data-ext="haskell"><pre class="language-haskell"><code><span class="token comment">-- file: ch07/tempfile.hs</span>
<span class="token import-statement"><span class="token keyword">import</span> System<span class="token punctuation">.</span>IO</span>
<span class="token import-statement"><span class="token keyword">import</span> System<span class="token punctuation">.</span>Directory</span><span class="token punctuation">(</span><span class="token hvariable">getTemporaryDirectory</span><span class="token punctuation">,</span> <span class="token hvariable">removeFile</span><span class="token punctuation">)</span>
  <span class="token hvariable">import</span> <span class="token constant">System<span class="token punctuation">.</span>IO<span class="token punctuation">.</span>Error</span><span class="token punctuation">(</span><span class="token hvariable">catchIOError</span><span class="token punctuation">)</span>  <span class="token comment">-- è¯‘æ³¨ï¼šåŸæ–‡ä¸º catch ï¼Œåœ¨ç°åœ¨çš„ç¯å¢ƒä¸­æ— æ³•æ­£ç¡®è¿è¡Œ</span>
  <span class="token hvariable">import</span> <span class="token constant">Control<span class="token punctuation">.</span>Exception</span><span class="token punctuation">(</span><span class="token hvariable">finally</span><span class="token punctuation">)</span>

<span class="token comment">-- The main entry point.  Work with a temp file in myAction.</span>
<span class="token hvariable">main</span> <span class="token operator">::</span> <span class="token constant">IO</span> <span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token hvariable">main</span> <span class="token operator">=</span> <span class="token hvariable">withTempFile</span> <span class="token string">&quot;mytemp.txt&quot;</span> <span class="token hvariable">myAction</span>

<span class="token comment">{- The guts of the program.  Called with the path and handle of a temporary
file.  When this function exits, that file will be closed and deleted
because myAction was called from withTempFile. -}</span>
<span class="token hvariable">myAction</span> <span class="token operator">::</span> <span class="token constant">FilePath</span> <span class="token operator">-&gt;</span> <span class="token constant">Handle</span> <span class="token operator">-&gt;</span> <span class="token constant">IO</span> <span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token hvariable">myAction</span> <span class="token hvariable">tempname</span> <span class="token hvariable">temph</span> <span class="token operator">=</span>
    <span class="token keyword">do</span> <span class="token comment">-- Start by displaying a greeting on the terminal</span>
        <span class="token builtin">putStrLn</span> <span class="token string">&quot;Welcome to tempfile.hs&quot;</span>
        <span class="token builtin">putStrLn</span> <span class="token operator">$</span> <span class="token string">&quot;I have a temporary file at &quot;</span> <span class="token operator">++</span> <span class="token hvariable">tempname</span>

        <span class="token comment">-- Let&#39;s see what the initial position is</span>
        <span class="token hvariable">pos</span> <span class="token operator">&lt;-</span> <span class="token hvariable">hTell</span> <span class="token hvariable">temph</span>
        <span class="token builtin">putStrLn</span> <span class="token operator">$</span> <span class="token string">&quot;My initial position is &quot;</span> <span class="token operator">++</span> <span class="token builtin">show</span> <span class="token hvariable">pos</span>

        <span class="token comment">-- Now, write some data to the temporary file</span>
        <span class="token keyword">let</span> <span class="token hvariable">tempdata</span> <span class="token operator">=</span> <span class="token builtin">show</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">..</span><span class="token number">10</span><span class="token punctuation">]</span>
        <span class="token builtin">putStrLn</span> <span class="token operator">$</span> <span class="token string">&quot;Writing one line containing &quot;</span> <span class="token operator">++</span>
            <span class="token builtin">show</span> <span class="token punctuation">(</span><span class="token builtin">length</span> <span class="token hvariable">tempdata</span><span class="token punctuation">)</span> <span class="token operator">++</span> <span class="token string">&quot; bytes: &quot;</span> <span class="token operator">++</span>
               <span class="token hvariable">tempdata</span>
        <span class="token hvariable">hPutStrLn</span> <span class="token hvariable">temph</span> <span class="token hvariable">tempdata</span>

        <span class="token comment">-- Get our new position.  This doesn&#39;t actually modify pos</span>
        <span class="token comment">-- in memory, but makes the name &quot;pos&quot; correspond to a different</span>
        <span class="token comment">-- value for the remainder of the &quot;do&quot; block.</span>
        <span class="token hvariable">pos</span> <span class="token operator">&lt;-</span> <span class="token hvariable">hTell</span> <span class="token hvariable">temph</span>
        <span class="token builtin">putStrLn</span> <span class="token operator">$</span> <span class="token string">&quot;After writing, my new position is &quot;</span> <span class="token operator">++</span> <span class="token builtin">show</span> <span class="token hvariable">pos</span>

        <span class="token comment">-- Seek to the beginning of the file and display it</span>
        <span class="token builtin">putStrLn</span> <span class="token operator">$</span> <span class="token string">&quot;The file content is: &quot;</span>
        <span class="token hvariable">hSeek</span> <span class="token hvariable">temph</span> <span class="token constant">AbsoluteSeek</span> <span class="token number">0</span>

        <span class="token comment">-- hGetContents performs a lazy read of the entire file</span>
        <span class="token hvariable">c</span> <span class="token operator">&lt;-</span> <span class="token hvariable">hGetContents</span> <span class="token hvariable">temph</span>

        <span class="token comment">-- Copy the file byte-for-byte to stdout, followed by \n</span>
        <span class="token builtin">putStrLn</span> <span class="token hvariable">c</span>

        <span class="token comment">-- Let&#39;s also display it as a Haskell literal</span>
        <span class="token builtin">putStrLn</span> <span class="token operator">$</span> <span class="token string">&quot;Which could be expressed as this Haskell literal:&quot;</span>
        <span class="token builtin">print</span> <span class="token hvariable">c</span>

<span class="token comment">{- This function takes two parameters: a filename pattern and another
function.  It will create a temporary file, and pass the name and Handle
of that file to the given function.

The temporary file is created with openTempFile.  The directory is the one
indicated by getTemporaryDirectory, or, if the system has no notion of
a temporary directory, &quot;.&quot; is used.  The given pattern is passed to
openTempFile.

After the given function terminates, even if it terminates due to an
exception, the Handle is closed and the file is deleted. -}</span>
<span class="token hvariable">withTempFile</span> <span class="token operator">::</span> <span class="token constant">String</span> <span class="token operator">-&gt;</span> <span class="token punctuation">(</span><span class="token constant">FilePath</span> <span class="token operator">-&gt;</span> <span class="token constant">Handle</span> <span class="token operator">-&gt;</span> <span class="token constant">IO</span> <span class="token hvariable">a</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token constant">IO</span> <span class="token hvariable">a</span>
<span class="token hvariable">withTempFile</span> <span class="token hvariable">pattern</span> <span class="token hvariable">func</span> <span class="token operator">=</span>
    <span class="token keyword">do</span> <span class="token comment">-- The library ref says that getTemporaryDirectory may raise on</span>
       <span class="token comment">-- exception on systems that have no notion of a temporary directory.</span>
       <span class="token comment">-- So, we run getTemporaryDirectory under catch.  catch takes</span>
       <span class="token comment">-- two functions: one to run, and a different one to run if the</span>
       <span class="token comment">-- first raised an exception.  If getTemporaryDirectory raised an</span>
       <span class="token comment">-- exception, just use &quot;.&quot; (the current working directory).</span>
         <span class="token hvariable">tempdir</span> <span class="token operator">&lt;-</span> <span class="token hvariable">catchIOError</span> <span class="token punctuation">(</span><span class="token hvariable">getTemporaryDirectory</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token operator">\</span><span class="token hvariable">_</span> <span class="token operator">-&gt;</span> <span class="token builtin">return</span> <span class="token string">&quot;.&quot;</span><span class="token punctuation">)</span>
       <span class="token punctuation">(</span><span class="token hvariable">tempfile</span><span class="token punctuation">,</span> <span class="token hvariable">temph</span><span class="token punctuation">)</span> <span class="token operator">&lt;-</span> <span class="token hvariable">openTempFile</span> <span class="token hvariable">tempdir</span> <span class="token hvariable">pattern</span>

       <span class="token comment">-- Call (func tempfile temph) to perform the action on the temporary</span>
       <span class="token comment">-- file.  finally takes two actions.  The first is the action to run.</span>
       <span class="token comment">-- The second is an action to run after the first, regardless of</span>
       <span class="token comment">-- whether the first action raised an exception.  This way, we ensure</span>
       <span class="token comment">-- the temporary file is always deleted.  The return value from finally</span>
       <span class="token comment">-- is the first action&#39;s return value.</span>
       <span class="token hvariable">finally</span> <span class="token punctuation">(</span><span class="token hvariable">func</span> <span class="token hvariable">tempfile</span> <span class="token hvariable">temph</span><span class="token punctuation">)</span>
               <span class="token punctuation">(</span><span class="token keyword">do</span> <span class="token hvariable">hClose</span> <span class="token hvariable">temph</span>
                   <span class="token hvariable">removeFile</span> <span class="token hvariable">tempfile</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è®©æˆ‘ä»¬ä»ç»“å°¾å¼€å§‹çœ‹è¿™ä¸ªç¨‹åºã€‚</p><p><code>writeTempFile</code> å‡½æ•°è¯æ˜Haskellå½“I/Oè¢«å¼•å…¥çš„æ—¶å€™æ²¡æœ‰å¿˜è®°å®ƒçš„å‡½æ•°å¼ç‰¹æ€§ã€‚</p><p>è¿™ä¸ªå‡½æ•°æ¥å—ä¸€ä¸ª <code>String</code> å’Œå¦å¤–ä¸€ä¸ªå‡½æ•°ï¼Œä¼ ç»™ <code>withTempFile</code> çš„å‡½æ•°ä½¿ç”¨è¿™ä¸ªåå­—å’Œä¸€ä¸ªä¸´æ—¶æ–‡ä»¶çš„å¥æŸ„è°ƒç”¨ã€‚å½“å‡½æ•°é€€å‡ºæ—¶ï¼Œè¿™ä¸ªä¸´æ—¶æ–‡ä»¶è¢«å…³é—­å’Œåˆ é™¤ã€‚æ‰€ä»¥ç”šè‡³åœ¨å¤„ç†I/Oæ—¶ï¼Œæˆ‘ä»¬ä»ç„¶å¯ä»¥å‘ç°ä¸ºäº†æ–¹ä¾¿ä¼ é€’å‡½æ•°ä½œä¸ºå‚æ•°çš„ä¹ æƒ¯ã€‚Lispç¨‹åºå‘˜å¯èƒ½çœ‹åˆ°æˆ‘ä»¬çš„ <code>withTempFile</code> å‡½æ•°æœ‰ç‚¹ç±»ä¼¼Lispçš„ <code>with-open-file</code> å‡½æ•°ã€‚</p><p>ä¸ºäº†è®©ç¨‹åºèƒ½å¤Ÿæ›´å¥½åœ°å¤„ç†é”™è¯¯ï¼Œæˆ‘ä»¬éœ€è¦ä¸ºå®ƒæ·»åŠ ä¸€äº›å¼‚å¸¸å¤„ç†ä»£ç ã€‚ä½ ä¸€èˆ¬éœ€è¦ä¸´æ—¶æ–‡ä»¶åœ¨å¤„ç†å®Œæˆä¹‹åè¢«åˆ é™¤ï¼Œå°±ç®—æœ‰é”™è¯¯å‘ç”Ÿã€‚æ‰€ä»¥æˆ‘ä»¬è¦ç¡®ä¿åˆ é™¤å‘ç”Ÿã€‚ å…³äºå¼‚å¸¸å¤„ç†çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·çœ‹ <a href="">ç¬¬åä¹ç« ï¼šé”™è¯¯å¤„ç†</a> ã€‚</p><p>è®©æˆ‘ä»¬å›åˆ°è¿™ä¸ªç¨‹åºçš„å¼€å¤´ï¼Œ <code>main</code> è¢«ç®€å•å®šä¹‰æˆ <code>withTempFile &quot;mytemp.txt&quot; myAction</code> ã€‚ ç„¶å, <code>myAction</code> å°†ä¼šè¢«è°ƒç”¨ï¼Œä½¿ç”¨åå­—å’Œè¿™ä¸ªä¸´æ—¶æ–‡ä»¶çš„å¥æŸ„ä½œä¸ºå‚æ•°ã€‚</p><p><code>myAction</code> æ˜¾ç¤ºä¸€äº›ä¿¡æ¯åˆ°ç»ˆç«¯ï¼Œå†™ä¸€äº›æ•°æ®åˆ°æ–‡ä»¶ï¼Œå¯»æ‰¾æ–‡ä»¶çš„å¼€å¤´ï¼Œå¹¶ä¸”ä½¿ç”¨ <code>hGetContents</code> æŠŠæ•°æ®è¯»å–å›æ¥ã€‚ ç„¶åæŠŠæ–‡ä»¶çš„å†…å®¹æŒ‰å­—èŠ‚åœ°ï¼Œé€šè¿‡ <code>print c</code> å½“åšHaskellå­—é¢é‡æ˜¾ç¤ºå‡ºæ¥ã€‚ è¿™å’Œ <code>putStrLn (show c)</code> ä¸€æ ·ã€‚</p><p>æˆ‘ä»¬çœ‹ä¸€ä¸‹è¾“å‡ºï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>$ runhaskell tempfile.hs
Welcome to tempfile.hs
I have a temporary <span class="token function">file</span> at /tmp/mytemp8572.txt
My initial position is <span class="token number">0</span>
Writing one line containing <span class="token number">22</span> bytes: <span class="token punctuation">[</span><span class="token number">1,2</span>,3,4,5,6,7,8,9,10<span class="token punctuation">]</span>
After writing, my new position is <span class="token number">23</span>
The <span class="token function">file</span> content is:
<span class="token punctuation">[</span><span class="token number">1,2</span>,3,4,5,6,7,8,9,10<span class="token punctuation">]</span>

Which could be expressed as this Haskell literal:
<span class="token string">&quot;[1,2,3,4,5,6,7,8,9,10]<span class="token entity" title="\n">\n</span>&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ¯æ¬¡ä½ è¿è¡Œè¿™ä¸ªç¨‹åºï¼Œä½ çš„ä¸´æ—¶æ–‡ä»¶çš„åå­—åº”è¯¥æœ‰ç‚¹ç»†å¾®çš„å·®åˆ«ï¼Œå› ä¸ºå®ƒåŒ…å«äº†ä¸€ä¸ªéšæœºç”Ÿæˆçš„éƒ¨åˆ†ã€‚çœ‹ä¸€ä¸‹è¿™ä¸ªè¾“å‡ºï¼Œä½ å¯èƒ½ä¼šé—®ä¸€äº›é—®é¢˜ï¼Ÿ</p><ol><li>ä¸ºä»€ä¹ˆå†™å…¥ä¸€è¡Œ22ä¸ªå­—èŠ‚ä¹‹åä½ çš„ä½ç½®æ˜¯23ï¼Ÿ</li><li>ä¸ºä»€ä¹ˆæ–‡ä»¶å†…å®¹æ˜¾ç¤ºä¹‹åæœ‰ä¸€ä¸ªç©ºè¡Œï¼Ÿ</li><li>ä¸ºä»€ä¹ˆHaskellå­—é¢é‡æ˜¾ç¤ºçš„æœ€åæœ‰ä¸€ä¸ª <code>\n</code> ï¼Ÿ</li></ol><p>ä½ å¯èƒ½èƒ½çŒœåˆ°è¿™ä¸‰ä¸ªé—®é¢˜çš„ç­”æ¡ˆéƒ½æ˜¯ç›¸å…³çš„ã€‚çœ‹çœ‹ä½ èƒ½ä¸èƒ½åœ¨ä¸€ä¼šå†…ç­”å‡ºè¿™äº›é¢˜ã€‚ å¦‚æœä½ éœ€è¦å¸®åŠ©ï¼Œè¿™é‡Œæœ‰è§£é‡Šï¼š</p><p>1. æ˜¯å› ä¸ºæˆ‘ä»¬ç”¨ <code>hPutStrLn</code> æ›¿ä»£ <code>hPutStr</code> æ¥å†™è¿™ä¸ªæ•°æ®ã€‚<code>hPutStrLn</code> æ€»æ˜¯åœ¨ç»“æŸä¸€è¡Œçš„æ—¶å€™åœ¨ç»“å°¾å¤„å†™ä¸Šä¸€ä¸ª <code>\n</code> ï¼Œè€Œè¿™ä¸ªæ²¡æœ‰å‡ºç°åœ¨ <code>tempdata</code> ã€‚</p><p>2. æˆ‘ä»¬ç”¨ <code>putStrLn c</code> æ¥æ˜¾ç¤ºæ–‡ä»¶å†…å®¹ <code>c</code> ã€‚ å› ä¸ºæ•°æ®åŸæ¥ä½¿ç”¨ <code>hPutStrLn</code> æ¥å†™çš„ï¼Œ<code>c</code> ç»“å°¾å¤„æœ‰ä¸€ä¸ªæ¢è¡Œç¬¦ï¼Œå¹¶ä¸” <code>putStrLn</code> åˆæ·»åŠ äº†ç¬¬äºŒä¸ªæ¢è¡Œç¬¦ï¼Œç»“æœå°±æ˜¯å¤šäº†ä¸€ä¸ªç©ºè¡Œã€‚</p><ol start="3"><li>è¿™ä¸ª <code>\n</code> æ˜¯æ¥è‡ªåŸå§‹çš„ <code>hPutStrLn</code> çš„æ¢è¡Œç¬¦ã€‚</li></ol><p>æœ€åä¸€ä¸ªæ³¨æ„äº‹é¡¹ï¼Œå­—èŠ‚æ•°ç›®å¯èƒ½åœ¨ä¸€äº›æ“ä½œç³»ç»Ÿä¸Šä¸ä¸€æ ·ã€‚æ¯”å¦‚Windowsï¼Œä½¿ç”¨è¿ä¸ªå­—èŠ‚åºåˆ— <code>\r\n</code> ä½œä¸ºè¡Œç»“æŸæ ‡è®°ï¼Œæ‰€ä»¥åœ¨Windowså¹³å°ä½ å¯èƒ½ä¼šçœ‹åˆ°ä¸åŒã€‚</p><h2 id="æƒ°æ€§i-o" tabindex="-1"><a class="header-anchor" href="#æƒ°æ€§i-o" aria-hidden="true">#</a> æƒ°æ€§I/O</h2><p>è¿™ä¸€ç« åˆ°ç›®å‰ä¸ºæ­¢ï¼Œä½ å·²ç»çœ‹äº†ä¸€äº›ç›¸å½“ä¼ ç»Ÿçš„I/Oä¾‹å­ã€‚å•ç‹¬è¯·æ±‚å’Œå¤„ç†æ¯ä¸€è¡Œæˆ–è€…æ¯ä¸€å—æ•°æ®ã€‚</p><p>Haskellè¿˜ä¸ºä½ å‡†å¤‡äº†å¦ä¸€ç§æ–¹æ³•ã€‚å› ä¸ºHaskellæ˜¯ä¸€ç§æƒ°æ€§è¯­è¨€ï¼Œæ„æ€æ˜¯ä»»ä½•ç»™å®šçš„æ•°æ®ç‰‡åªæœ‰åœ¨å®ƒçš„å€¼å¿…é¡»è¦çŸ¥é“çš„æƒ…å†µä¸‹æ‰ä¼šè¢«è®¡ç®—ã€‚æœ‰ä¸€äº›æ–°å¥‡çš„æ–¹æ³•æ¥å¤„ç†I/Oã€‚</p><h3 id="hgetcontents" tabindex="-1"><a class="header-anchor" href="#hgetcontents" aria-hidden="true">#</a> hGetContents</h3><p>ä¸€ç§æ–°å¥‡çš„å¤„ç†I/Oçš„åŠæ³•æ˜¯ <code>hGetContents</code> å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°ç±»å‹æ˜¯ <code>Handle -&gt; IO String</code> ã€‚ è¿™ä¸ªè¿”å›çš„ <code>String</code> è¡¨ç¤º <code>Handle</code> æ‰€ç»™æ–‡ä»¶é‡Œçš„æ‰€æœ‰æ•°æ®ã€‚</p><p>åœ¨ä¸€ä¸ªä¸¥æ ¼æ±‚å€¼ï¼ˆstrictly-evaluatedï¼‰çš„è¯­è¨€ä¸­ï¼Œä½¿ç”¨è¿™æ ·çš„å‡½æ•°ä¸æ˜¯ä¸€ä»¶å¥½äº‹æƒ…ã€‚è¯»å–ä¸€ä¸ª2KBæ–‡ä»¶çš„æ‰€æœ‰å†…å®¹å¯èƒ½æ²¡äº‹ï¼Œä½†æ˜¯å¦‚æœä½ å°è¯•å»è¯»å–ä¸€ä¸ª500GBæ–‡ä»¶çš„æ‰€æœ‰å†…å®¹ï¼Œä½ å¾ˆå¯èƒ½å› ä¸ºç¼ºå°‘å†…å­˜å»å­˜å‚¨è¿™äº›æ•°æ®è€Œå´©æºƒã€‚åœ¨è¿™äº›è¯­è¨€ä¸­ï¼Œä¼ ç»Ÿä¸Šä½ ä¼šé‡‡ç”¨å¾ªç¯å»å¤„ç†æ–‡ä»¶çš„å…¨éƒ¨æ•°æ®çš„æœºåˆ¶ã€‚</p><p>ä½†æ˜¯ <code>hGetContents</code> ä¸ä¸€æ ·ã€‚ å®ƒè¿”å›çš„ <code>String</code> æ˜¯æƒ°æ€§ä¼°å€¼çš„ã€‚ åœ¨ä½ è°ƒç”¨ <code>hGetContents</code> çš„æ—¶åˆ»ï¼Œå®é™…ä¸Šæ²¡æœ‰è¯»ä»»ä½•ä¸œè¥¿ã€‚ æ•°æ®åªä»å¥æŸ„è¯»å–ï¼Œä½œä¸ºå¤„ç†çš„ä¸€ä¸ªå…ƒç´ ï¼ˆå­—ç¬¦ï¼‰åˆ—è¡¨ã€‚ <code>String</code> çš„å…ƒç´ ä¸€ç›´éƒ½ç”¨ä¸åˆ°ï¼ŒHaskellçš„åƒåœ¾æ”¶é›†å™¨ä¼šè‡ªåŠ¨é‡Šæ”¾é‚£å—å†…å­˜ã€‚æ‰€æœ‰è¿™äº›éƒ½æ˜¯å®Œå…¨é€æ˜åœ°å‘ç”Ÿçš„ã€‚ å› ä¸ºå‡½æ•°çš„è¿”å›å€¼æ˜¯ä¸€ä¸ªå¦‚å‡åŒ…æ¢çš„çº¯ String ï¼Œæ‰€ä»¥å®ƒå¯ä»¥è¢«ä¼ é€’ç»™é I/O çš„çº¯ä»£ç ã€‚ è®©æˆ‘ä»¬å¿«é€Ÿçœ‹ä¸€ä¸ªä¾‹å­ã€‚ å›åˆ° <a href="">æ“ä½œæ–‡ä»¶å’Œå¥æŸ„</a>ä¸€èŠ‚ï¼Œä½ çœ‹åˆ°ä¸€ä¸ªå‘½ä»¤å¼çš„ç¨‹åºï¼Œå®ƒæŠŠæ•´ä¸ªæ–‡ä»¶å†…å®¹è½¬æ¢æˆå¤§å†™ã€‚å®ƒçš„å‘½ä»¤å¼ç®—æ³•å’Œä½ åœ¨å…¶ä»–è¯­è¨€çœ‹åˆ°çš„å¾ˆç±»ä¼¼ã€‚æ¥ä¸‹æ¥å±•ç¤ºçš„æ˜¯ä¸€ä¸ªåˆ©ç”¨äº†æƒ°æ€§æ±‚å€¼å®ç°çš„æ›´ç®€å•çš„ç®—æ³•ã€‚</p><div class="language-haskell line-numbers-mode" data-ext="haskell"><pre class="language-haskell"><code><span class="token comment">-- file: ch07/toupper-lazy1.hs</span>
<span class="token import-statement"><span class="token keyword">import</span> System<span class="token punctuation">.</span>IO</span>
<span class="token import-statement"><span class="token keyword">import</span> Data<span class="token punctuation">.</span>Char</span><span class="token punctuation">(</span><span class="token builtin">toUpper</span><span class="token punctuation">)</span>

<span class="token hvariable">main</span> <span class="token operator">::</span> <span class="token constant">IO</span> <span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token hvariable">main</span> <span class="token operator">=</span> <span class="token keyword">do</span>
       <span class="token hvariable">inh</span> <span class="token operator">&lt;-</span> <span class="token hvariable">openFile</span> <span class="token string">&quot;input.txt&quot;</span> <span class="token constant">ReadMode</span>
       <span class="token hvariable">outh</span> <span class="token operator">&lt;-</span> <span class="token hvariable">openFile</span> <span class="token string">&quot;output.txt&quot;</span> <span class="token constant">WriteMode</span>
       <span class="token hvariable">inpStr</span> <span class="token operator">&lt;-</span> <span class="token hvariable">hGetContents</span> <span class="token hvariable">inh</span>
       <span class="token keyword">let</span> <span class="token hvariable">result</span> <span class="token operator">=</span> <span class="token hvariable">processData</span> <span class="token hvariable">inpStr</span>
       <span class="token hvariable">hPutStr</span> <span class="token hvariable">outh</span> <span class="token hvariable">result</span>
       <span class="token hvariable">hClose</span> <span class="token hvariable">inh</span>
       <span class="token hvariable">hClose</span> <span class="token hvariable">outh</span>

<span class="token hvariable">processData</span> <span class="token operator">::</span> <span class="token constant">String</span> <span class="token operator">-&gt;</span> <span class="token constant">String</span>
<span class="token hvariable">processData</span> <span class="token operator">=</span> <span class="token builtin">map</span> <span class="token builtin">toUpper</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ³¨æ„åˆ° <code>hGetContents</code> ä¸ºæˆ‘ä»¬å¤„ç†æ‰€æœ‰çš„è¯»å–å·¥ä½œã€‚ çœ‹ä¸€ä¸‹ <code>processData</code>ï¼Œå®ƒæ˜¯ä¸€ä¸ªçº¯å‡½æ•°ï¼Œå› ä¸ºå®ƒæ²¡æœ‰å‰¯ä½œç”¨ï¼Œå¹¶ä¸”æ¯æ¬¡è°ƒç”¨çš„æ—¶å€™æ€»æ˜¯è¿”å›ç›¸åŒçš„ç»“æœã€‚å®ƒä¸éœ€è¦çŸ¥é“ï¼Œä¹Ÿæ²¡åŠæ³•å‘Šè¯‰å®ƒï¼Œå®ƒçš„è¾“å…¥æ˜¯æƒ°æ€§ä»æ–‡ä»¶è¯»å–çš„ã€‚ä¸ç®¡æ˜¯20ä¸ªå­—ç¬¦çš„å­—é¢é‡è¿˜æ˜¯ç¡¬ç›˜ä¸Š500GBçš„æ•°æ®å®ƒéƒ½å¯ä»¥å¾ˆå¥½çš„å·¥ä½œã€‚</p><p>ä½ å¯ä»¥ç”¨ <strong>ghci</strong> éªŒè¯ä¸€ä¸‹ï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>ghci<span class="token operator">&gt;</span> :load toupper-lazy1.hs
<span class="token punctuation">[</span><span class="token number">1</span> of <span class="token number">1</span><span class="token punctuation">]</span> Compiling Main             <span class="token punctuation">(</span> toupper-lazy1.hs, interpreted <span class="token punctuation">)</span>
Ok, modules loaded: Main.
ghci<span class="token operator">&gt;</span> processData <span class="token string">&quot;Hello, there!  How are you?&quot;</span>
<span class="token string">&quot;HELLO, THERE!  HOW ARE YOU?&quot;</span>
ghci<span class="token operator">&gt;</span> :type processData
processData :: String -<span class="token operator">&gt;</span> String
ghci<span class="token operator">&gt;</span> :type processData <span class="token string">&quot;Hello!&quot;</span>
processData <span class="token string">&quot;Hello!&quot;</span> :: String
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container warning"><p class="hint-container-title">Warning</p><p>å¦‚æœæˆ‘ä»¬åœ¨ <code>inpStr</code> è¢«ä½¿ç”¨åï¼ˆ <code>processData</code> è°ƒç”¨é‚£ï¼‰è¿˜æ‹¿ç€å®ƒä¸æ”¾çš„è¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„ç¨‹åºåœ¨å†…å­˜ä½¿ç”¨ä¸Šå°±ä¼šå˜çš„å¾ˆä½æ•ˆã€‚</p></div><p>è¿™æ˜¯å› ä¸ºäº†åœ¨ä»¥åè¿˜å¯ä»¥ä½¿ç”¨ <code>inpStr</code> çš„å€¼ï¼Œç¼–è¯‘å™¨ä¼šè¢«è¿«åœ¨å†…å­˜ä¸­ä¿ç•™ <code>inpStr</code> ã€‚ è¿™é‡Œæˆ‘ä»¬çŸ¥é“ <code>inpStr</code> å°†ä¸ä¼šè¢«é‡ç”¨ï¼Œå®ƒä¸€è¢«ä½¿ç”¨å®Œå°±ä¼šè¢«é‡Šæ”¾å†…å­˜ã€‚åªè¦è®°ä½ï¼šå†…å­˜åªæœ‰åœ¨æœ€åä¸€æ¬¡ä½¿ç”¨å®Œæ‰ä¼šè¢«é‡Šæ”¾ã€‚</p><p>è¿™ä¸ªç¨‹åºä¸ºäº†æ¸…æ¥šåœ°è¡¨æ˜ä½¿ç”¨äº†çº¯ä»£ç ï¼Œæ˜¾å¾—æœ‰ç‚¹å•°å—¦ã€‚è¿™é‡Œæœ‰æ›´åŠ ç®€æ´çš„ç‰ˆæœ¬ï¼Œæ–°ç‰ˆæœ¬åœ¨ä¸‹ä¸€ä¸ªä¾‹å­é‡Œï¼š</p><div class="language-haskell line-numbers-mode" data-ext="haskell"><pre class="language-haskell"><code><span class="token comment">-- file: ch07/toupper-lazy2.hs</span>
<span class="token import-statement"><span class="token keyword">import</span> System<span class="token punctuation">.</span>IO</span>
<span class="token import-statement"><span class="token keyword">import</span> Data<span class="token punctuation">.</span>Char</span><span class="token punctuation">(</span><span class="token builtin">toUpper</span><span class="token punctuation">)</span>

<span class="token hvariable">main</span> <span class="token operator">=</span> <span class="token keyword">do</span>
       <span class="token hvariable">inh</span> <span class="token operator">&lt;-</span> <span class="token hvariable">openFile</span> <span class="token string">&quot;input.txt&quot;</span> <span class="token constant">ReadMode</span>
       <span class="token hvariable">outh</span> <span class="token operator">&lt;-</span> <span class="token hvariable">openFile</span> <span class="token string">&quot;output.txt&quot;</span> <span class="token constant">WriteMode</span>
       <span class="token hvariable">inpStr</span> <span class="token operator">&lt;-</span> <span class="token hvariable">hGetContents</span> <span class="token hvariable">inh</span>
       <span class="token hvariable">hPutStr</span> <span class="token hvariable">outh</span> <span class="token punctuation">(</span><span class="token builtin">map</span> <span class="token builtin">toUpper</span> <span class="token hvariable">inpStr</span><span class="token punctuation">)</span>
       <span class="token hvariable">hClose</span> <span class="token hvariable">inh</span>
       <span class="token hvariable">hClose</span> <span class="token hvariable">outh</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½ åœ¨ä½¿ç”¨ <code>hGetContents</code> çš„æ—¶å€™ä¸è¦æ±‚å»ä½¿ç”¨è¾“å…¥æ–‡ä»¶çš„æ‰€æœ‰æ•°æ®ã€‚ä»»ä½•æ—¶å€™Haskellç³»ç»Ÿèƒ½å†³å®šæ•´ä¸ª <code>hGetContents</code> è¿”å›çš„å­—ç¬¦ä¸²èƒ½å¦è¢«åƒåœ¾æ”¶é›†æ‰ï¼Œæ„æ€å°±æ˜¯å®ƒä¸ä¼šå†è¢«ä½¿ç”¨ï¼Œæ–‡ä»¶ä¼šè‡ªåŠ¨è¢«å…³é—­ã€‚åŒæ ·çš„åŸç†é€‚ç”¨äºä»æ–‡ä»¶è¯»å–çš„æ•°æ®ã€‚å½“ç»™å®šçš„æ•°æ®ç‰‡ä¸ä¼šå†è¢«ä½¿ç”¨çš„ä»»ä½•æ—¶å€™ï¼ŒHaskellä¼šé‡Šæ”¾å®ƒä¿å­˜çš„é‚£å—å†…å­˜ã€‚ä¸¥æ ¼æ„ä¹‰ä¸Šæ¥è®²ï¼Œæˆ‘ä»¬åœ¨è¿™ä¸ªä¾‹å­ä¸­æ ¹æœ¬ä¸å¿…è¦å»è°ƒç”¨ <code>hClose</code> ã€‚ä½†æ˜¯ï¼Œå…»æˆä¹ æƒ¯å»è°ƒç”¨è¿˜æ˜¯ä¸ªå¥½çš„å®è·µã€‚ ä»¥åå¯¹ç¨‹åºçš„ä¿®æ”¹å¯èƒ½è®© <code>hClose</code> çš„è°ƒç”¨å˜å¾—é‡è¦ã€‚</p><div class="hint-container warning"><p class="hint-container-title">Warning</p><p>å³ä½¿åœ¨ä½™ä¸‹çš„ç¨‹åºä¸­ä¸å†æ˜¾ç¤ºå¼•ç”¨æ–‡ä»¶å¥æŸ„ï¼Œä½ ä¹Ÿå¿…é¡»åœ¨ä½¿ç”¨ <code>hGetContents</code> çš„ç»“æœä¹‹åå†å…³é—­å¥æŸ„ï¼Œå¦åˆ™å°†ä¼šå¯¼è‡´ç¨‹åºä¸¢å¤±éƒ¨åˆ†æˆ–æ‰€æœ‰æ–‡ä»¶æ•°æ®ã€‚ å› ä¸º Haskell æ˜¯ä¸€é—¨æƒ°æ€§è¯­è¨€ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šè®¤ä¸ºï¼Œå®ƒåªæœ‰åœ¨éœ€è¦è¾“å‡ºè®¡ç®—ç»“æœçš„æ—¶å€™æ‰ä¼šä½¿ç”¨è¾“å…¥ã€‚</p></div><p>[scarletskyè¯‘æ³¨ï¼š</p><div class="language-haskell line-numbers-mode" data-ext="haskell"><pre class="language-haskell"><code><span class="token hvariable">inpStr</span> <span class="token operator">&lt;-</span> <span class="token hvariable">hGetContents</span> <span class="token hvariable">inh</span>
<span class="token keyword">let</span> <span class="token hvariable">outStr</span> <span class="token operator">=</span> <span class="token builtin">map</span> <span class="token builtin">toUpper</span> <span class="token hvariable">inpStr</span>
<span class="token hvariable">hClose</span> <span class="token hvariable">inh</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œçš„ <code>outStr</code> å¹¶æ²¡æœ‰ä½¿ç”¨ <code>hGetContents</code> çš„ç»“æœï¼Œå› ä¸ºå®ƒå¹¶æ²¡æœ‰è¾“å‡ºè®¡ç®—ç»“æœã€‚ è¿™ç§æƒ…å†µå°±å±äºä¸Šé¢æåˆ°çš„ï¼šåœ¨ä½¿ç”¨ <code>hGetContents</code> ç»“æœå‰å…³é—­æ–‡ä»¶å¥æŸ„ï¼Œå› æ­¤è¿™æ®µä»£ç æ˜¯é”™è¯¯çš„ã€‚</p><p>]</p><h3 id="readfileå’Œwritefile" tabindex="-1"><a class="header-anchor" href="#readfileå’Œwritefile" aria-hidden="true">#</a> readFileå’ŒwriteFile</h3><p>Haskellç¨‹åºå‘˜ç»å¸¸ä½¿ç”¨ <code>hGetContents</code> ä½œä¸ºä¸€ä¸ªè¿‡æ»¤å™¨ã€‚ä»–ä»¬ä»ä¸€ä¸ªæ–‡ä»¶è¯»å–ï¼Œåœ¨æ•°æ®ä¸Šåšä¸€äº›äº‹æƒ…ï¼Œç„¶åæŠŠç»“æœå†™åˆ°å…¶ä»–åœ°æ–¹ã€‚è¿™å¾ˆå¸¸è§ï¼Œæœ‰å¾ˆå¤šç§å¿«æ·æ–¹å¼å¯ä»¥åšã€‚ <code>readFile</code> å’Œ <code>writeFile</code> æ˜¯æŠŠæ–‡ä»¶å½“åšå­—ç¬¦ä¸²å¤„ç†çš„å¿«æ·æ–¹å¼ã€‚ ä»–ä»¬å¤„ç†æ‰€æœ‰ç»†èŠ‚ï¼ŒåŒ…æ‹¬æ‰“å¼€æ–‡ä»¶ï¼Œå…³é—­æ–‡ä»¶ï¼Œè¯»å–æ–‡ä»¶å’Œå†™å…¥æ–‡ä»¶ã€‚<code>readFile</code> åœ¨å†…éƒ¨ä½¿ç”¨ <code>hGetContents</code> ã€‚</p><p>ä½ èƒ½çŒœåˆ°è¿™äº›å‡½æ•°çš„Haskellç±»å‹å—ï¼Ÿæˆ‘ä»¬ç”¨ <strong>ghci</strong> æ£€æŸ¥ä¸€ä¸‹ï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>ghci<span class="token operator">&gt;</span> :type readFile
readFile :: FilePath -<span class="token operator">&gt;</span> IO String
ghci<span class="token operator">&gt;</span> :type writeFile
writeFile :: FilePath -<span class="token operator">&gt;</span> String -<span class="token operator">&gt;</span> IO <span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç°åœ¨æœ‰ä¸€ä¸ªä¾‹å­ç¨‹åºä½¿ç”¨äº† <code>readFile</code> å’Œ <code>writeFile</code> ï¼š</p><div class="language-haskell line-numbers-mode" data-ext="haskell"><pre class="language-haskell"><code><span class="token comment">-- file: ch07/toupper-lazy3.hs</span>
<span class="token import-statement"><span class="token keyword">import</span> Data<span class="token punctuation">.</span>Char</span><span class="token punctuation">(</span><span class="token builtin">toUpper</span><span class="token punctuation">)</span>

<span class="token hvariable">main</span> <span class="token operator">=</span> <span class="token keyword">do</span>
       <span class="token hvariable">inpStr</span> <span class="token operator">&lt;-</span> <span class="token builtin">readFile</span> <span class="token string">&quot;input.txt&quot;</span>
       <span class="token builtin">writeFile</span> <span class="token string">&quot;output.txt&quot;</span> <span class="token punctuation">(</span><span class="token builtin">map</span> <span class="token builtin">toUpper</span> <span class="token hvariable">inpStr</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>çœ‹ä¸€ä¸‹ï¼Œè¿™ä¸ªç¨‹åºçš„å†…éƒ¨åªæœ‰ä¸¤è¡Œã€‚ <code>readFile</code> è¿”å›ä¸€ä¸ªæƒ°æ€§ <code>String</code> ï¼Œæˆ‘ä»¬ä¿å­˜åœ¨ <code>inpStr</code> ã€‚</p><p>ç„¶åæˆ‘ä»¬æ‹¿åˆ°å®ƒï¼Œå¤„ç†å®ƒï¼Œç„¶åæŠŠå®ƒä¼ ç»™ <code>writeFile</code> å‡½æ•°å»å†™å…¥ã€‚</p><p><code>readFile</code> å’Œ <code>writeFile</code> éƒ½ä¸æä¾›ä¸€ä¸ªå¥æŸ„ç»™ä½ æ“ä½œï¼Œæ‰€ä»¥æ²¡æœ‰ä¸œè¥¿è¦å» <code>hClose</code> ã€‚ <code>readFile</code> åœ¨å†…éƒ¨ä½¿ç”¨ <code>hGetContents</code> ï¼Œåº•ä¸‹çš„å¥æŸ„åœ¨è¿”å›çš„ <code>String</code> è¢«åƒåœ¾å›æ”¶æˆ–è€…æ‰€æœ‰è¾“å…¥éƒ½è¢«æ¶ˆè´¹ä¹‹åå°±ä¼šè¢«å…³é—­ã€‚ <code>writeFile</code> ä¼šåœ¨ä¾›åº”ç»™å®ƒçš„ <code>String</code> å…¨éƒ¨è¢«å†™å…¥ä¹‹åå…³é—­å®ƒåº•ä¸‹çš„å¥æŸ„ã€‚</p><h3 id="ä¸€è¨€ä»¥è”½æƒ°æ€§è¾“å‡º" tabindex="-1"><a class="header-anchor" href="#ä¸€è¨€ä»¥è”½æƒ°æ€§è¾“å‡º" aria-hidden="true">#</a> ä¸€è¨€ä»¥è”½æƒ°æ€§è¾“å‡º</h3><p>åˆ°ç°åœ¨ä¸ºæ­¢ï¼Œä½ åº”è¯¥ç†è§£äº†Haskellçš„æƒ°æ€§è¾“å…¥æ€ä¹ˆå·¥ä½œçš„ã€‚ä½†æ˜¯åœ¨è¾“å…¥çš„æ—¶å€™æƒ°æ€§æ˜¯æ€ä¹ˆæ ·çš„å‘¢ï¼Ÿ</p><p>æ®ä½ æ‰€çŸ¥ï¼ŒHaskellä¸­çš„æ‰€æœ‰ä¸œè¥¿éƒ½æ˜¯åœ¨éœ€è¦çš„æ—¶å€™æ‰è¢«æ±‚å€¼çš„ã€‚ å› ä¸ºåƒ <code>writeFile</code> å’Œ <code>putStr</code> è¿™æ ·çš„å‡½æ•°å†™ä¼ é€’ç»™å®ƒä»¬çš„æ•´ä¸ª <code>String</code> ï¼Œæ‰€ä»¥è¿™æ•´ä¸ª <code>String</code> å¿…é¡»è¢«æ±‚å€¼ã€‚ æ‰€ä»¥ä¿è¯ <code>putStr</code> çš„å‚æ•°ä¼šè¢«å®Œå…¨æ±‚å€¼ã€‚</p><p>ä½†æ˜¯è¾“å…¥çš„æƒ°æ€§æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿ åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œå¯¹ <code>putStr</code> æˆ–è€… <code>writeFile</code> çš„è°ƒç”¨ä¼šå¼ºåˆ¶ä¸€æ¬¡æ€§æŠŠæ•´ä¸ªè¾“å…¥å­—ç¬¦ä¸²è½½å…¥åˆ°å†…å­˜ä¸­å—ï¼Œç›´æ¥å…¨éƒ¨å†™å‡ºï¼Ÿ</p><p>ç­”æ¡ˆæ˜¯å¦å®šçš„ã€‚<code>putStr</code> ï¼ˆä»¥åŠæ‰€æœ‰ç±»ä¼¼çš„è¾“å‡ºå‡½æ•°ï¼‰åœ¨å®ƒå˜å¾—å¯ç”¨æ—¶æ‰å†™å‡ºæ•°æ®ã€‚ä»–ä»¬ä¹Ÿä¸éœ€è¦ä¿å­˜å·²ç»å†™çš„æ•°æ®ï¼Œæ‰€ä»¥åªè¦ç¨‹åºä¸­æ²¡æœ‰å…¶ä»–åœ°æ–¹éœ€è¦å®ƒï¼Œè¿™å—å†…å­˜å°±å¯ä»¥ç«‹å³é‡Šæ”¾ã€‚åœ¨æŸç§æ„ä¹‰ä¸Šï¼Œä½ å¯ä»¥æŠŠè¿™ä¸ªåœ¨ <code>readFile</code> å’Œ <code>writeFile</code> ä¹‹é—´çš„ <code>String</code> æƒ³æˆä¸€ä¸ªè¿æ¥å®ƒä»¬ä¸¤ä¸ªçš„ç®¡é“ã€‚æ•°æ®ä»ä¸€å¤´è¿›å»ï¼Œé€šè¿‡æŸç§æ–¹å¼ä¼ é€’ï¼Œç„¶åä»å¦å¤–ä¸€å¤´æµå‡ºã€‚ä½ å¯ä»¥è‡ªå·±éªŒè¯è¿™ä¸ªï¼Œé€šè¿‡ç»™ <code>toupper-lazy3.hs</code> äº§ç”Ÿä¸€ä¸ªå¤§çš„ <code>input.txt</code>ã€‚å¤„ç†å®ƒå¯èƒ½æ—¶é—´è¦èŠ±ä¸€ç‚¹æ—¶é—´ï¼Œä½†æ˜¯åœ¨å¤„ç†å®ƒçš„æ—¶å€™ä½ åº”è¯¥èƒ½çœ‹åˆ°ä¸€ä¸ªå¸¸é‡çš„å¹¶ä¸”ä½çš„å†…å­˜ä½¿ç”¨ã€‚</p><h3 id="interact" tabindex="-1"><a class="header-anchor" href="#interact" aria-hidden="true">#</a> interact</h3><p>ä½ å­¦ä¹ äº† <code>readFile</code> å’Œ <code>writeFile</code>å¤„ç†è¯»æ–‡ä»¶ï¼Œåšä¸ªè½¬æ¢ï¼Œç„¶åå†™åˆ°ä¸åŒæ–‡ä»¶çš„æ™®é€šæƒ…å½¢ã€‚è¿˜æœ‰ä¸€ä¸ªæ¯”ä»–è¿˜æ™®éçš„æƒ…å½¢ï¼šä»æ ‡å‡†è¾“å…¥è¯»å–ï¼Œåšä¸€ä¸ªè½¬æ¢ï¼Œç„¶åæŠŠç»“æœå†™åˆ°æ ‡å‡†è¾“å‡ºã€‚å¯¹äºè¿™ç§æƒ…å½¢ï¼Œæœ‰ä¸€ä¸ªå‡½æ•°å«åš <code>interact</code> ã€‚ <code>interact</code> å‡½æ•°çš„ç±»å‹æ˜¯ <code>(String -&gt; String) -&gt; IO ()</code> ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒæ¥å—ä¸€ä¸ªå‚æ•°ï¼šä¸€ä¸ªç±»å‹ä¸º <code>String -&gt; String</code> çš„å‡½æ•°ã€‚ <code>getContents</code> çš„ç»“æœä¼ é€’ç»™è¿™ä¸ªå‡½æ•°ï¼Œä¹Ÿå°±æ˜¯ï¼Œæƒ°æ€§è¯»å–æ ‡å‡†è¾“å…¥ã€‚è¿™ä¸ªå‡½æ•°çš„ç»“æœä¼šå‘é€åˆ°æ ‡å‡†è¾“å‡ºã€‚</p><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>interact</code> æ¥è½¬æ¢æˆ‘ä»¬çš„ä¾‹å­ç¨‹åºå»æ“ä½œæ ‡å‡†è¾“å…¥å’Œæ ‡å‡†è¾“å‡ºã€‚è¿™é‡Œæœ‰ä¸€ç§æ–¹å¼ï¼š</p><div class="language-haskell line-numbers-mode" data-ext="haskell"><pre class="language-haskell"><code><span class="token comment">-- file: ch07/toupper-lazy4.hs</span>
<span class="token import-statement"><span class="token keyword">import</span> Data<span class="token punctuation">.</span>Char</span><span class="token punctuation">(</span><span class="token builtin">toUpper</span><span class="token punctuation">)</span>

<span class="token hvariable">main</span> <span class="token operator">=</span> <span class="token builtin">interact</span> <span class="token punctuation">(</span><span class="token builtin">map</span> <span class="token builtin">toUpper</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ¥çœ‹ä¸€ä¸‹ï¼Œä¸€è¡Œå°±å®Œæˆäº†æˆ‘ä»¬çš„å˜æ¢ã€‚è¦å®ç°ä¸Šä¸€ä¸ªä¾‹å­åŒæ ·çš„æ•ˆæœï¼Œä½ å¯ä»¥åƒè¿™æ ·æ¥è¿è¡Œè¿™ä¸ªä¾‹å­ï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>$ runghc toupper-lazy4.hs <span class="token operator">&lt;</span> input.txt <span class="token operator">&gt;</span> output.txt
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>æˆ–è€…ï¼Œå¦‚æœä½ æƒ³çœ‹è¾“å‡ºæ‰“å°åœ¨å±å¹•ä¸Šçš„è¯ï¼Œä½ å¯ä»¥æ‰“ä¸‹é¢çš„å‘½ä»¤ï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>$ runghc toupper-lazy4.hs <span class="token operator">&lt;</span> input.txt
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>å¦‚æœä½ æƒ³çœ‹çœ‹Haskellæ˜¯å¦çœŸçš„ä¸€æ¥æ”¶åˆ°æ•°æ®å—å°±ç«‹å³å†™å‡ºçš„è¯ï¼Œè¿è¡Œ <code>runghc toupper-lazy4.hs</code> ï¼Œä¸è¦å…¶ä»–çš„å‘½ä»¤è¡Œå‚æ•°ã€‚ä½ å¯ä»¥çœ‹åˆ°æ¯ä¸€ä¸ªä½ è¾“å…¥çš„å­—ç¬¦éƒ½ä¼šç«‹é©¬å›æ˜¾ï¼Œä½†æ˜¯éƒ½å˜æˆå¤§å†™äº†ã€‚ç¼“å†²åŒºå¯èƒ½æ”¹å˜è¿™ç§è¡Œä¸ºï¼Œæ›´å¤šå…³äºç¼“å†²åŒºçš„çœ‹è¿™ä¸€ç« åé¢çš„ <a href="">ç¼“å†²åŒº</a> ä¸€èŠ‚ã€‚å¦‚æœä½ çœ‹åˆ°ä½ è¾“å…¥çš„æ²¡ä¸€è¡Œéƒ½ç«‹é©¬å›æ˜¾ï¼Œæˆ–è€…ç”šè‡³ä¸€æ®µæ—¶é—´ä»€ä¹ˆéƒ½æ²¡æœ‰ï¼Œé‚£å°±æ˜¯ç¼“å†²åŒºé€ æˆçš„ã€‚</p><p>ä½ ä¹Ÿå¯ä»¥ç”¨ <code>interactive</code> å†™ä¸€ä¸ªç®€å•çš„äº¤äº’ç¨‹åºã€‚è®©æˆ‘ä»¬ä»ä¸€ä¸ªç®€å•çš„ä¾‹å­å¼€å§‹ï¼š</p><div class="language-haskell line-numbers-mode" data-ext="haskell"><pre class="language-haskell"><code><span class="token comment">-- file: ch07/toupper-lazy5.hs</span>
<span class="token import-statement"><span class="token keyword">import</span> Data<span class="token punctuation">.</span>Char</span><span class="token punctuation">(</span><span class="token builtin">toUpper</span><span class="token punctuation">)</span>

<span class="token hvariable">main</span> <span class="token operator">=</span> <span class="token builtin">interact</span> <span class="token punctuation">(</span><span class="token builtin">map</span> <span class="token builtin">toUpper</span> <span class="token operator">.</span> <span class="token punctuation">(</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token string">&quot;Your data, in uppercase, is:\n\n&quot;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">Tip</p><p>å¦‚æœ <code>.</code> è¿ç®—ç¬¦ä¸æ˜ç™½çš„è¯ï¼Œä½ å¯ä»¥å‚è€ƒ <a href="">ä½¿ç”¨ç»„åˆæ¥é‡ç”¨ä»£ç </a> ä¸€èŠ‚ã€‚</p></div><p>è¿™é‡Œæˆ‘ä»¬åœ¨è¾“å‡ºçš„å¼€å¤´æ·»åŠ äº†ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚ ä½ å¯ä»¥å‘ç°è¿™ä¸ªé—®é¢˜å—ï¼Ÿ</p><p>å› ä¸ºæˆ‘ä»¬åœ¨ <code>(++)</code> çš„ç»“æœä¸Šè°ƒç”¨ <code>map</code> ï¼Œè¿™ä¸ªå¤´è‡ªå·±ä¹Ÿä¼šæ˜¾ç¤ºæˆå¤§å†™ã€‚æˆ‘ä»¬å¯ä»¥è¿™æ ·æ¥è§£å†³ï¼š</p><div class="language-haskell line-numbers-mode" data-ext="haskell"><pre class="language-haskell"><code><span class="token comment">-- file: ch07/toupper-lazy6.hs</span>
<span class="token import-statement"><span class="token keyword">import</span> Data<span class="token punctuation">.</span>Char</span><span class="token punctuation">(</span><span class="token builtin">toUpper</span><span class="token punctuation">)</span>

<span class="token hvariable">main</span> <span class="token operator">=</span> <span class="token builtin">interact</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token string">&quot;Your data, in uppercase, is:\n\n&quot;</span> <span class="token operator">.</span>
                 <span class="token builtin">map</span> <span class="token builtin">toUpper</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç°åœ¨æŠŠå¤´ç§»å‡ºäº† <code>map</code> ã€‚</p><h3 id="interact-è¿‡æ»¤å™¨" tabindex="-1"><a class="header-anchor" href="#interact-è¿‡æ»¤å™¨" aria-hidden="true">#</a> interact è¿‡æ»¤å™¨</h3><p><code>interact</code> å¦ä¸€ä¸ªé€šå¸¸çš„ç”¨æ³•æ˜¯è¿‡æ»¤å™¨ã€‚æ¯”å¦‚è¯´ä½ è¦å†™ä¸€ä¸ªç¨‹åºï¼Œè¿™ä¸ªç¨‹åºè¯»ä¸€ä¸ªæ–‡ä»¶ï¼Œå¹¶ä¸”è¾“å‡ºæ‰€æœ‰åŒ…å«å­—ç¬¦&quot;a&quot;çš„è¡Œã€‚ä½ å¯èƒ½ä¼šè¿™æ ·ç”¨ <code>interact</code> æ¥å®ç°ï¼š</p><div class="language-haskell line-numbers-mode" data-ext="haskell"><pre class="language-haskell"><code><span class="token comment">-- file: ch07/filter.hs</span>
<span class="token hvariable">main</span> <span class="token operator">=</span> <span class="token builtin">interact</span> <span class="token punctuation">(</span><span class="token builtin">unlines</span> <span class="token operator">.</span> <span class="token builtin">filter</span> <span class="token punctuation">(</span><span class="token builtin">elem</span> <span class="token char string">&#39;a&#39;</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token builtin">lines</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œå¼•å…¥äº†ä¸‰ä¸ªä½ è¿˜ä¸ç†Ÿæ‚‰çš„å‡½æ•°ã€‚ è®©æˆ‘ä»¬åœ¨ <strong>ghci</strong> é‡Œæ£€æŸ¥å®ƒä»¬çš„ç±»å‹ï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>ghci<span class="token operator">&gt;</span> :type lines
lines :: String -<span class="token operator">&gt;</span> <span class="token punctuation">[</span>String<span class="token punctuation">]</span>
ghci<span class="token operator">&gt;</span> :type unlines
unlines :: <span class="token punctuation">[</span>String<span class="token punctuation">]</span> -<span class="token operator">&gt;</span> String
ghci<span class="token operator">&gt;</span> :type elem
elem :: <span class="token punctuation">(</span>Eq a<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> a -<span class="token operator">&gt;</span> <span class="token punctuation">[</span>a<span class="token punctuation">]</span> -<span class="token operator">&gt;</span> Bool
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½ åªæ˜¯çœ‹å®ƒä»¬çš„ç±»å‹ï¼Œä½ èƒ½çŒœåˆ°å®ƒä»¬æ˜¯å¹²ä»€ä¹ˆçš„å—ï¼Ÿå¦‚æœä¸èƒ½ï¼Œä½ å¯ä»¥åœ¨<a href="">çƒ­èº«ï¼šå¿«æ·æ–‡æœ¬è¡Œåˆ†å‰²</a> ä¸€èŠ‚å’Œ <a href="">ç‰¹æ®Šå­—ç¬¦ä¸²å¤„ç†å‡½æ•°</a> ä¸€èŠ‚æ‰¾åˆ°è§£é‡Šã€‚ä½ ä¼šé¢‘ç¹çœ‹åˆ° <code>lines</code> å’Œ <code>unlines</code> å’ŒI/Oä¸€èµ·ä½¿ç”¨ã€‚ æœ€åï¼Œ <code>elem</code> æ¥å—ä¸€ä¸ªå…ƒç´ å’Œä¸€ä¸ªåˆ—è¡¨ï¼Œå¦‚æœå…ƒç´ åœ¨åˆ—è¡¨ä¸­å‡ºç°åˆ™è¿”å› <code>True</code> ã€‚</p><p>è¯•ç€ç”¨æˆ‘ä»¬çš„æ ‡å‡†è¾“å…¥ä¾‹å­æ¥è¿è¡Œï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>$ runghc filter.hs <span class="token operator">&lt;</span> input.txt
I like Haskell
Haskell is great
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æœç„¶ï¼Œä½ å¾—åˆ°åŒ…å«&quot;a&quot;çš„ä¸¤è¡Œã€‚ æƒ°æ€§è¿‡æ»¤å™¨æ˜¯ä½¿ç”¨Haskellå¼ºå¤§çš„æ–¹å¼ã€‚ä½ æƒ³æƒ³çœ‹ï¼Œä¸€ä¸ªè¿‡æ»¤å™¨ï¼Œå°±åƒæ ‡å‡†Unixç¨‹åº <strong>Grep</strong> ï¼Œå¬èµ·æ¥å¾ˆåƒä¸€ä¸ªå‡½æ•°ã€‚å®ƒæ¥å—ä¸€äº›è¾“å…¥ï¼Œåº”ç”¨ä¸€äº›è®¡ç®—ï¼Œç„¶åç”Ÿæˆä¸€ä¸ªæ„æ–™ä¹‹ä¸­çš„è¾“å‡ºã€‚</p><h2 id="the-io-monad" tabindex="-1"><a class="header-anchor" href="#the-io-monad" aria-hidden="true">#</a> The IO Monad</h2><p>è¿™ä¸ªæ—¶å€™ä½ å·²ç»çœ‹äº†è‹¥å¹²Haskellä¸­I/Oçš„ä¾‹å­ã€‚è®©æˆ‘ä»¬èŠ±ç‚¹æ—¶é—´å›æƒ³ä¸€ä¸‹ï¼Œå¹¶ä¸”æ€è€ƒä¸‹I/Oæ˜¯æ€ä¹ˆå’Œæ›´å¹¿é˜”çš„Haskellè¯­è¨€ç›¸å…³è”çš„ã€‚</p><p>å› ä¸ºHaskellæ˜¯ä¸€ä¸ªçº¯çš„è¯­è¨€ï¼Œå¦‚æœä½ ç»™ç‰¹å®šçš„å‡½æ•°ä¸€ä¸ªæŒ‡å®šçš„å‚æ•°ï¼Œæ¯æ¬¡ä½ ç»™å®ƒé‚£ä¸ªå‚æ•°è¿™ä¸ªå‡½æ•°å°†ä¼šè¿”å›ç›¸åŒçš„ç»“æœã€‚æ­¤å¤–ï¼Œè¿™ä¸ªå‡½æ•°ä¸ä¼šæ”¹å˜ç¨‹åºçš„æ€»ä½“çŠ¶æ€çš„ä»»ä½•ä¸œè¥¿ã€‚</p><p>ä½ å¯èƒ½æƒ³çŸ¥é“I/Oæ˜¯æ€ä¹ˆèåˆåˆ°æ•´ä½“ä¸­å»çš„å‘¢ï¼Ÿå½“ç„¶å¦‚æœä½ æƒ³ä»é”®ç›˜è¾“å…¥ä¸­è¯»å–ä¸€è¡Œï¼Œå»è¯»è¾“å…¥çš„é‚£ä¸ªå‡½æ•°è‚¯å®šä¸å¯èƒ½æ¯æ¬¡éƒ½è¿”å›ç›¸åŒçš„ç»“æœã€‚æ˜¯ä¸æ˜¯ï¼Ÿæ­¤å¤–ï¼ŒI/Oéƒ½æ˜¯å’Œæ”¹å˜çŠ¶æ€ç›¸å…³çš„ã€‚I/Oå¯ä»¥ç‚¹äº®ç»ˆç«¯ä¸Šçš„ä¸€ä¸ªåƒç´ ï¼Œå¯ä»¥è®©æ‰“å°æœºçš„çº¸å¼€å§‹å‡ºæ¥ï¼Œæˆ–è€…ç”šè‡³æ˜¯è®©ä¸€ä¸ªåŒ…è£¹ä»“åº“è¿é€åˆ°å¦ä¸€ä¸ªå¤§æ´²ã€‚I/Oä¸åªæ˜¯æ”¹å˜ä¸€ä¸ªç¨‹åºçš„çŠ¶æ€ã€‚ ä½ å¯ä»¥æŠŠI/Oæƒ³æˆå¯ä»¥æ”¹å˜ä¸–ç•Œçš„çŠ¶æ€ã€‚</p><h3 id="åŠ¨ä½œ-actions" tabindex="-1"><a class="header-anchor" href="#åŠ¨ä½œ-actions" aria-hidden="true">#</a> åŠ¨ä½œï¼ˆActionsï¼‰</h3><p>å¤§å¤šæ•°è¯­è¨€åœ¨çº¯å‡½æ•°å’Œéçº¯å‡½æ•°ä¹‹é—´æ²¡æœ‰æ˜ç¡®çš„åŒºåˆ†ã€‚Haskellçš„å‡½æ•°æœ‰æ•°å­¦ä¸Šçš„æ„æ€ï¼šå®ƒä»¬æ˜¯çº¯ç²¹çš„è®¡ç®—è¿‡ç¨‹ï¼Œå¹¶ä¸”è¿™äº›è®¡ç®—ä¸ä¼šè¢«å¤–éƒ¨æ‰€å½±å“ã€‚æ­¤å¤–ï¼Œè¿™äº›è®¡ç®—å¯ä»¥åœ¨ä»»ä½•æ—¶å€™ã€æŒ‰éœ€åœ°æ‰§è¡Œã€‚</p><p>æ˜¾ç„¶ï¼Œæˆ‘ä»¬éœ€è¦å…¶ä»–ä¸€äº›å·¥å…·æ¥ä½¿ç”¨I/Oã€‚Haskellé‡Œçš„è¿™ä¸ªå·¥å…·å«åšåŠ¨ä½œï¼ˆActionsï¼‰ã€‚åŠ¨ä½œç±»ä¼¼äºå‡½æ•°ï¼Œå®ƒä»¬åœ¨å®šä¹‰çš„æ—¶å€™ä¸åšä»»ä½•äº‹æƒ…ï¼Œè€Œåœ¨å®ƒä»¬è¢«è°ƒç”¨æ—¶æ‰§è¡Œä¸€äº›ä»»åŠ¡ã€‚I/OåŠ¨ä½œè¢«å®šä¹‰åœ¨ <code>IO</code> Monadã€‚ Monadæ˜¯ä¸€ç§å¼ºå¤§çš„å°†å‡½æ•°é“¾åœ¨ä¸€èµ·çš„æ–¹æ³•ï¼Œåœ¨ <a href="">ç¬¬åå››ç« ï¼šMonad</a> ä¼šè®²åˆ°ã€‚ä¸ºäº†ç†è§£I/Oä½ ä¸æ˜¯ä¸€å®šè¦ç†è§£Monadï¼Œåªè¦ç†è§£æ“ä½œçš„è¿”å›ç±»å‹éƒ½å¸¦æœ‰ <code>IO</code> å°±è¡Œäº†ã€‚ æˆ‘ä»¬æ¥çœ‹ä¸€äº›ç±»å‹ï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>ghci<span class="token operator">&gt;</span> :type putStrLn
putStrLn :: String -<span class="token operator">&gt;</span> IO <span class="token punctuation">(</span><span class="token punctuation">)</span>
ghci<span class="token operator">&gt;</span> :type getLine
getLine :: IO String
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>putStrLn</code> çš„ç±»å‹å°±åƒå…¶ä»–å‡½æ•°ä¸€æ ·ï¼Œæ¥å—ä¸€ä¸ªå‚æ•°ï¼Œè¿”å›ä¸€ä¸ª <code>IO ()</code> ã€‚è¿™ä¸ª <code>IO ()</code> å°±æ˜¯ä¸€ä¸ªæ“ä½œã€‚å¦‚æœä½ æƒ³ä½ å¯ä»¥åœ¨çº¯ä»£ç ä¸­ä¿å­˜å’Œä¼ é€’æ“ä½œï¼Œè™½ç„¶æˆ‘ä»¬ä¸ç»å¸¸è¿™ä¹ˆå¹²ã€‚ä¸€ä¸ªæ“ä½œåœ¨å®ƒè¢«è°ƒç”¨å‰ä¸åšä»»ä½•äº‹æƒ…ã€‚ æˆ‘ä»¬çœ‹ä¸€ä¸ªè¿™æ ·çš„ä¾‹å­ï¼š</p><div class="language-haskell line-numbers-mode" data-ext="haskell"><pre class="language-haskell"><code><span class="token comment">-- file: ch07/actions.hs</span>
<span class="token hvariable">str2action</span> <span class="token operator">::</span> <span class="token constant">String</span> <span class="token operator">-&gt;</span> <span class="token constant">IO</span> <span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token hvariable">str2action</span> <span class="token hvariable">input</span> <span class="token operator">=</span> <span class="token builtin">putStrLn</span> <span class="token punctuation">(</span><span class="token string">&quot;Data: &quot;</span> <span class="token operator">++</span> <span class="token hvariable">input</span><span class="token punctuation">)</span>

<span class="token hvariable">list2actions</span> <span class="token operator">::</span> <span class="token punctuation">[</span><span class="token constant">String</span><span class="token punctuation">]</span> <span class="token operator">-&gt;</span> <span class="token punctuation">[</span><span class="token constant">IO</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token hvariable">list2actions</span> <span class="token operator">=</span> <span class="token builtin">map</span> <span class="token hvariable">str2action</span>

<span class="token hvariable">numbers</span> <span class="token operator">::</span> <span class="token punctuation">[</span><span class="token constant">Int</span><span class="token punctuation">]</span>
<span class="token hvariable">numbers</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">..</span><span class="token number">10</span><span class="token punctuation">]</span>

<span class="token hvariable">strings</span> <span class="token operator">::</span> <span class="token punctuation">[</span><span class="token constant">String</span><span class="token punctuation">]</span>
<span class="token hvariable">strings</span> <span class="token operator">=</span> <span class="token builtin">map</span> <span class="token builtin">show</span> <span class="token hvariable">numbers</span>

<span class="token hvariable">actions</span> <span class="token operator">::</span> <span class="token punctuation">[</span><span class="token constant">IO</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token hvariable">actions</span> <span class="token operator">=</span> <span class="token hvariable">list2actions</span> <span class="token hvariable">strings</span>

<span class="token hvariable">printitall</span> <span class="token operator">::</span> <span class="token constant">IO</span> <span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token hvariable">printitall</span> <span class="token operator">=</span> <span class="token hvariable">runall</span> <span class="token hvariable">actions</span>

<span class="token comment">-- Take a list of actions, and execute each of them in turn.</span>
<span class="token hvariable">runall</span> <span class="token operator">::</span> <span class="token punctuation">[</span><span class="token constant">IO</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">-&gt;</span> <span class="token constant">IO</span> <span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token hvariable">runall</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token builtin">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token hvariable">runall</span> <span class="token punctuation">(</span><span class="token hvariable">firstelem</span><span class="token operator">:</span><span class="token hvariable">remainingelems</span><span class="token punctuation">)</span> <span class="token operator">=</span>
    <span class="token keyword">do</span> <span class="token hvariable">firstelem</span>
       <span class="token hvariable">runall</span> <span class="token hvariable">remainingelems</span>

<span class="token hvariable">main</span> <span class="token operator">=</span> <span class="token keyword">do</span> <span class="token hvariable">str2action</span> <span class="token string">&quot;Start of the program&quot;</span>
          <span class="token hvariable">printitall</span>
          <span class="token hvariable">str2action</span> <span class="token string">&quot;Done!&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>str2action</code> è¿™ä¸ªå‡½æ•°æ¥å—ä¸€ä¸ªå‚æ•°å¹¶è¿”å› <code>IO ()</code> ï¼Œå°±åƒä½ åœ¨ <code>main</code> ç»“å°¾çœ‹åˆ°çš„é‚£æ ·ï¼Œä½ å¯ä»¥ç›´æ¥åœ¨å¦ä¸€ä¸ªæ“ä½œé‡Œä½¿ç”¨è¿™ä¸ªå‡½æ•°ï¼Œå®ƒä¼šç«‹åˆ»æ‰“å°å‡ºä¸€è¡Œã€‚æˆ–è€…ä½ å¯ä»¥ä¿å­˜ï¼ˆä¸æ˜¯æ‰§è¡Œï¼‰çº¯ä»£ç ä¸­çš„æ“ä½œã€‚ ä½ å¯ä»¥åœ¨ <code>list2actions</code> é‡Œçœ‹åˆ°ä¿å­˜çš„ä¾‹å­ï¼Œæˆ‘ä»¬åœ¨ <code>str2action</code> ç”¨ <code>map</code>ï¼Œè¿”å›ä¸€ä¸ªæ“ä½œçš„åˆ—è¡¨ï¼Œå°±å’Œæ“ä½œå…¶ä»–çº¯æ•°æ®ä¸€æ ·ã€‚ æ‰€æœ‰ä¸œè¥¿éƒ½é€šè¿‡ <code>printall</code> æ˜¾ç¤ºå‡ºæ¥ï¼Œ è€Œ <code>printall</code> æ˜¯ç”¨çº¯ä»£ç å†™çš„ã€‚</p><p>è™½ç„¶æˆ‘ä»¬å®šä¹‰äº† <code>printall</code>ï¼Œä½†æ˜¯ç›´åˆ°å®ƒçš„æ“ä½œåœ¨å…¶ä»–åœ°æ–¹è¢«æ±‚å€¼çš„æ—¶å€™æ‰ä¼šæ‰§è¡Œã€‚ç°åœ¨æ³¨æ„ï¼Œæˆ‘ä»¬æ˜¯æ€ä¹ˆåœ¨ <code>main</code> é‡ŒæŠŠ <code>str2action</code> å½“åšä¸€ä¸ªI/Oæ“ä½œä½¿ç”¨ï¼Œå¹¶ä¸”æ‰§è¡Œäº†å®ƒã€‚ ä½†æ˜¯å…ˆå‰æˆ‘ä»¬åœ¨I/O Monadå¤–é¢ä½¿ç”¨å®ƒï¼Œåªæ˜¯æŠŠç»“æœæ”¶é›†è¿›ä¸€ä¸ªåˆ—è¡¨ã€‚</p><p>ä½ å¯ä»¥è¿™æ ·æ¥æ€è€ƒï¼š <code>do</code> ä»£ç å—ä¸­çš„æ¯ä¸€ä¸ªå£°æ˜ï¼Œé™¤äº† <code>let</code> ï¼Œéƒ½è¦äº§ç”Ÿä¸€ä¸ªI/Oæ“ä½œï¼Œè¿™ä¸ªæ“ä½œåœ¨å°†æ¥è¢«æ‰§è¡Œã€‚</p><p>å¯¹ <code>printall</code> çš„è°ƒç”¨æœ€åä¼šæ‰§è¡Œæ‰€æœ‰è¿™äº›æ“ä½œã€‚å®é™…ä¸Šï¼Œå› ä¸ºHASKELLæ˜¯æƒ°æ€§çš„ï¼Œæ‰€ä»¥è¿™äº›æ“ä½œç›´åˆ°è¿™é‡Œæ‰ä¼šè¢«ç”Ÿæˆã€‚å®é™…ä¸Šï¼Œå› ä¸ºHaskellæ˜¯æƒ°æ€§çš„ï¼Œæ‰€ä»¥è¿™äº›æ“ä½œç›´åˆ°è¿™é‡Œæ‰ä¼šè¢«ç”Ÿæˆã€‚</p><p>å½“ä½ è¿è¡Œè¿™ä¸ªç¨‹åºæ—¶ï¼Œä½ çš„è¾“å‡ºçœ‹èµ·æ¥åƒè¿™æ ·ï¼š</p><pre><code>Data: Start of the program
Data: 1
Data: 2
Data: 3
Data: 4
Data: 5
Data: 6
Data: 7
Data: 8
Data: 9
Data: 10
Data: Done!
</code></pre><p>æˆ‘ä»¬å®é™…ä¸Šå¯ä»¥å†™çš„æ›´ç´§å‡‘ã€‚ æ¥çœ‹çœ‹è¿™ä¸ªä¾‹å­çš„ä¿®æ”¹ï¼š</p><div class="language-haskell line-numbers-mode" data-ext="haskell"><pre class="language-haskell"><code><span class="token comment">-- file: ch07/actions2.hs</span>
<span class="token hvariable">str2message</span> <span class="token operator">::</span> <span class="token constant">String</span> <span class="token operator">-&gt;</span> <span class="token constant">String</span>
<span class="token hvariable">str2message</span> <span class="token hvariable">input</span> <span class="token operator">=</span> <span class="token string">&quot;Data: &quot;</span> <span class="token operator">++</span> <span class="token hvariable">input</span>

<span class="token hvariable">str2action</span> <span class="token operator">::</span> <span class="token constant">String</span> <span class="token operator">-&gt;</span> <span class="token constant">IO</span> <span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token hvariable">str2action</span> <span class="token operator">=</span> <span class="token builtin">putStrLn</span> <span class="token operator">.</span> <span class="token hvariable">str2message</span>

<span class="token hvariable">numbers</span> <span class="token operator">::</span> <span class="token punctuation">[</span><span class="token constant">Int</span><span class="token punctuation">]</span>
<span class="token hvariable">numbers</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">..</span><span class="token number">10</span><span class="token punctuation">]</span>

<span class="token hvariable">main</span> <span class="token operator">=</span> <span class="token keyword">do</span> <span class="token hvariable">str2action</span> <span class="token string">&quot;Start of the program&quot;</span>
          <span class="token builtin">mapM_</span> <span class="token punctuation">(</span><span class="token hvariable">str2action</span> <span class="token operator">.</span> <span class="token builtin">show</span><span class="token punctuation">)</span> <span class="token hvariable">numbers</span>
          <span class="token hvariable">str2action</span> <span class="token string">&quot;Done!&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ³¨æ„åœ¨ <code>str2action</code> é‡Œå¯¹æ ‡å‡†å‡½æ•°ç»„åˆè¿ç®—ç¬¦çš„ä½¿ç”¨ã€‚ åœ¨ <code>main</code> é‡Œé¢ï¼Œæœ‰ä¸€ä¸ªå¯¹ <code>mapM_</code> çš„è°ƒç”¨ï¼Œè¿™ä¸ªå‡½æ•°å’Œ <code>map</code> ç±»ä¼¼ï¼Œæ¥å—ä¸€ä¸ªå‡½æ•°å’Œä¸€ä¸ªåˆ—è¡¨ã€‚ æä¾›ç»™ <code>mapM_</code> çš„å‡½æ•°æ˜¯ä¸€ä¸ªI/Oæ“ä½œï¼Œè¿™ä¸ªæ“ä½œå¯¹åˆ—è¡¨ä¸­çš„æ¯ä¸€é¡¹éƒ½æ‰§è¡Œã€‚ <code>mapM_</code> æ‰”æ‰äº†å‡½æ•°çš„ç»“æœï¼Œä½†æ˜¯å¦‚æœä½ æƒ³è¦ I/Oçš„ç»“æœï¼Œä½ å¯ä»¥ç”¨ <code>mapM</code> è¿”å›ä¸€ä¸ªI/Oç»“æœçš„åˆ—è¡¨ã€‚ æ¥çœ‹ä¸€ä¸‹å®ƒä»¬çš„ç±»å‹ï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>ghci<span class="token operator">&gt;</span> :type mapM
mapM :: <span class="token punctuation">(</span>Monad m<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">(</span>a -<span class="token operator">&gt;</span> m b<span class="token punctuation">)</span> -<span class="token operator">&gt;</span> <span class="token punctuation">[</span>a<span class="token punctuation">]</span> -<span class="token operator">&gt;</span> m <span class="token punctuation">[</span>b<span class="token punctuation">]</span>
ghci<span class="token operator">&gt;</span> :type mapM_
mapM_ :: <span class="token punctuation">(</span>Monad m<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">(</span>a -<span class="token operator">&gt;</span> m b<span class="token punctuation">)</span> -<span class="token operator">&gt;</span> <span class="token punctuation">[</span>a<span class="token punctuation">]</span> -<span class="token operator">&gt;</span> m <span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">Tip</p><p>è¿™äº›å‡½æ•°å…¶å®ä¸ä»…ä»…å¯ä»¥åšI/Oç›¸å…³çš„æ“ä½œï¼Œæ‰€æœ‰çš„Monadéƒ½å¯ä»¥ä½¿ç”¨ä»–ä»¬ã€‚</p></div><p>åˆ°ç°åœ¨ä¸ºæ­¢ï¼Œä½ çœ‹åˆ°&quot;M&quot;å°±æŠŠå®ƒæƒ³æˆ&quot;IO&quot;ã€‚è¿˜æœ‰ï¼Œé‚£äº›ä»¥ä¸‹åˆ’çº¿ç»“å°¾çš„å‡½æ•°ä¸€èˆ¬ä¸ç®¡å®ƒä»¬çš„è¿”å›å€¼ã€‚</p><p>ä¸ºä»€ä¹ˆæˆ‘ä»¬æœ‰äº† <code>map</code> è¿˜è¦æœ‰ä¸€ä¸ª <code>mapM</code> ï¼Œå› ä¸º <code>map</code> æ˜¯è¿”å›ä¸€ä¸ªåˆ—è¡¨çš„çº¯å‡½æ•°ï¼Œå®ƒå®é™…ä¸Šä¸ç›´æ¥æ‰§è¡Œä¹Ÿä¸èƒ½æ‰§è¡Œæ“ä½œã€‚ <code>mapM</code> æ˜¯ä¸€ä¸ª <code>IO</code> Monadé‡Œé¢çš„å¯ä»¥æ‰§è¡Œæ“ä½œçš„å®ç”¨ç¨‹åºã€‚ç°åœ¨å›åˆ° <code>main</code> ï¼Œ <code>mapM_</code> åœ¨ <code>numbers . show</code> æ¯ä¸ªå…ƒç´ ä¸Šåº”ç”¨ <code>(str2action . show)</code> ï¼Œ <code>number . show</code> æŠŠæ¯ä¸ªæ•°å­—è½¬æ¢æˆä¸€ä¸ª <code>String</code> ï¼Œ <code>str2action</code> æŠŠæ¯ä¸ª <code>String</code> è½¬æ¢æˆä¸€ä¸ªæ“ä½œã€‚<code>mapM_</code> æŠŠè¿™äº›å•ç‹¬çš„æ“ä½œç»„åˆæˆä¸€ä¸ªæ›´å¤§çš„æ“ä½œï¼Œç„¶åæ‰“å°å‡ºè¿™äº›è¡Œã€‚</p><h3 id="sequencing" tabindex="-1"><a class="header-anchor" href="#sequencing" aria-hidden="true">#</a> ä¸²è”åŒ–ï¼ˆSequencingï¼‰</h3><p><code>do</code> ä»£ç å—å®é™…ä¸Šæ˜¯æŠŠæ“ä½œè¿æ¥åœ¨ä¸€èµ·çš„å¿«æ·è®°å·ã€‚ æœ‰ä¸¤ä¸ªè¿ç®—ç¬¦å¯ä»¥ç”¨æ¥ä»£æ›¿ <code>do</code> ä»£ç å—ï¼š <code>&gt;&gt;</code> å’Œ <code>&gt;&gt;=</code> ã€‚ åœ¨ <strong>ghci</strong> çœ‹ä¸€ä¸‹å®ƒä»¬çš„ç±»å‹ï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>ghci<span class="token operator">&gt;</span> :type <span class="token punctuation">(</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">)</span> :: <span class="token punctuation">(</span>Monad m<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> m a -<span class="token operator">&gt;</span> m b -<span class="token operator">&gt;</span> m b
ghci<span class="token operator">&gt;</span> :type <span class="token punctuation">(</span><span class="token operator">&gt;&gt;</span><span class="token operator">=</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token operator">&gt;&gt;</span><span class="token operator">=</span><span class="token punctuation">)</span> :: <span class="token punctuation">(</span>Monad m<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> m a -<span class="token operator">&gt;</span> <span class="token punctuation">(</span>a -<span class="token operator">&gt;</span> m b<span class="token punctuation">)</span> -<span class="token operator">&gt;</span> m b
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>&gt;&gt;</code> è¿ç®—ç¬¦æŠŠä¸¤ä¸ªæ“ä½œä¸²è”åœ¨ä¸€èµ·ï¼šç¬¬ä¸€ä¸ªæ“ä½œå…ˆè¿è¡Œï¼Œç„¶åæ˜¯ç¬¬äºŒä¸ªã€‚è¿ç®—ç¬¦çš„è®¡ç®—çš„ç»“æœæ˜¯ç¬¬äºŒä¸ªæ“ä½œçš„ç»“æœï¼Œç¬¬ä¸€ä¸ªæ“ä½œçš„ç»“æœè¢«ä¸¢å¼ƒäº†ã€‚ è¿™å’Œåœ¨ <code>do</code> ä»£ç å—ä¸­åªæœ‰ä¸€è¡Œæ˜¯ç±»ä¼¼çš„ã€‚ ä½ å¯èƒ½ä¼šå†™ <code>putStrLn &quot;line 1&quot; &gt;&gt; putStrLn &quot;line 2&quot;</code> æ¥æµ‹è¯•è¿™ä¸€ç‚¹ã€‚å®ƒä¼šæ‰“å°å‡ºä¸¤è¡Œï¼ŒæŠŠç¬¬ä¸€ä¸ª <code>putStrLn</code> çš„ç»“æœä¸¢æ‰äº†ï¼Œå€¼æä¾›ç¬¬äºŒä¸ªæ“ä½œçš„ç»“æœã€‚</p><p><code>&gt;&gt;=</code> è¿ç®—ç¬¦è¿è¡Œä¸€ä¸ªæ“ä½œï¼Œç„¶åæŠŠå®ƒçš„ç»“æœä¼ é€’ç»™ä¸€ä¸ªè¿”å›æ“ä½œçš„å‡½æ•°ã€‚é‚£æ ·ç¬¬äºŒä¸ªæ“ä½œå¯ä»¥åŒæ ·è¿è¡Œï¼Œè€Œä¸”æ•´ä¸ªè¡¨è¾¾å¼çš„ç»“æœå°±æ˜¯ç¬¬äºŒä¸ªæ“ä½œçš„ç»“æœã€‚ä¾‹å¦‚ï¼Œä½ å†™ <code>getLine &gt;&gt;= putStrLn</code> ï¼Œè¿™ä¼šä»é”®ç›˜è¯»å–ä¸€è¡Œï¼Œç„¶åæ˜¾ç¤ºå‡ºæ¥ã€‚</p><p>è®©æˆ‘ä»¬é‡å†™ä¾‹å­ä¸­çš„ä¸€ä¸ªï¼Œä¸ç”¨ <code>do</code> ä»£ç å¿«ã€‚è¿˜è®°å¾—è¿™ä¸€ç« å¼€å¤´çš„è¿™ä¸ªä¾‹å­å—ï¼Ÿ</p><div class="language-haskell line-numbers-mode" data-ext="haskell"><pre class="language-haskell"><code><span class="token comment">-- file: ch07/basicio.hs</span>
<span class="token hvariable">main</span> <span class="token operator">=</span> <span class="token keyword">do</span>
       <span class="token builtin">putStrLn</span> <span class="token string">&quot;Greetings!  What is your name?&quot;</span>
       <span class="token hvariable">inpStr</span> <span class="token operator">&lt;-</span> <span class="token builtin">getLine</span>
       <span class="token builtin">putStrLn</span> <span class="token operator">$</span> <span class="token string">&quot;Welcome to Haskell, &quot;</span> <span class="token operator">++</span> <span class="token hvariable">inpStr</span> <span class="token operator">++</span> <span class="token string">&quot;!&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æˆ‘ä»¬ä¸ç”¨ <code>do</code> ä»£ç å—æ¥é‡å†™å®ƒï¼š</p><div class="language-haskell line-numbers-mode" data-ext="haskell"><pre class="language-haskell"><code><span class="token comment">-- file: ch07/basicio-nodo.hs</span>
<span class="token hvariable">main</span> <span class="token operator">=</span>
    <span class="token builtin">putStrLn</span> <span class="token string">&quot;Greetings!  What is your name?&quot;</span> <span class="token operator">&gt;&gt;</span>
    <span class="token builtin">getLine</span> <span class="token operator">&gt;&gt;=</span>
    <span class="token punctuation">(</span><span class="token operator">\</span><span class="token hvariable">inpStr</span> <span class="token operator">-&gt;</span> <span class="token builtin">putStrLn</span> <span class="token operator">$</span> <span class="token string">&quot;Welcome to Haskell, &quot;</span> <span class="token operator">++</span> <span class="token hvariable">inpStr</span> <span class="token operator">++</span> <span class="token string">&quot;!&quot;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½ å®šä¹‰ <code>do</code> ä»£ç å—çš„æ—¶å€™ï¼ŒHaskellç¼–è¯‘å™¨å†…éƒ¨ä¼šæŠŠå®ƒç¿»è¯‘æˆåƒè¿™æ ·ã€‚</p><div class="hint-container tip"><p class="hint-container-title">Tip</p><p>å¿˜è®°äº†æ€ä¹ˆä½¿ç”¨ <code>\</code> (lambdaè¡¨è¾¾å¼)äº†å—ï¼Ÿå‚è§ <a href="">åŒ¿åï¼ˆlambdaï¼‰å‡½æ•°</a> ä¸€èŠ‚ã€‚</p></div><h3 id="the-nature-of-return" tabindex="-1"><a class="header-anchor" href="#the-nature-of-return" aria-hidden="true">#</a> Returnçš„æœ¬è‰²</h3><p>åœ¨è¿™ä¸€ç« çš„å‰é¢ï¼Œæˆ‘ä»¬æåˆ° <code>return</code> å¾ˆå¯èƒ½ä¸æ˜¯å®ƒçœ‹èµ·æ¥çš„é‚£æ ·ã€‚å¾ˆå¤šè¯­è¨€æœ‰ä¸€ä¸ªå…³é”®å­—å«åš <code>return</code>ï¼Œå®ƒå–æ¶ˆå‡½æ•°çš„æ‰§è¡Œå¹¶ç«‹å³ç»™è°ƒç”¨è€…ä¸€ä¸ªè¿”å›å€¼ã€‚</p><p>Haskellçš„ <code>return</code> å‡½æ•°å¾ˆä¸ä¸€æ ·ã€‚ åœ¨Haskellä¸­ï¼Œ <code>return</code> ç”¨æ¥åœ¨Monadé‡Œé¢åŒ…è£…æ•°æ®ã€‚ å½“è¯´I/Oçš„æ—¶å€™ï¼Œ <code>return</code> ç”¨æ¥æ‹¿åˆ°çº¯æ•°æ®å¹¶æŠŠå®ƒå¸¦å…¥IO Monadã€‚</p><p>ä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦é‚£æ ·åšï¼Ÿè¿˜è®°å¾—ç»“æœä¾èµ–I/Oçš„æ‰€æœ‰ä¸œè¥¿éƒ½å¿…é¡»åœ¨ä¸€ä¸ªIO Monadé‡Œé¢å—ï¼Ÿæ‰€ä»¥å¦‚æœæˆ‘ä»¬åœ¨å†™ä¸€ä¸ªæ‰§è¡ŒI/Oçš„å‡½æ•°ï¼Œç„¶åä¸€ä¸ªçº¯çš„è®¡ç®—ï¼Œæˆ‘ä»¬éœ€è¦ç”¨ <code>return</code> æ¥è®©è¿™ä¸ªçº¯çš„è®¡ç®—èƒ½ç»™å‡½æ•°è¿”å›ä¸€ä¸ªåˆé€‚çš„å€¼ã€‚å¦åˆ™ï¼Œä¼šå‘ç”Ÿä¸€ä¸ªç±»å‹é”™è¯¯ã€‚ è¿™å„¿æœ‰ä¸€ä¸ªä¾‹å­ï¼š</p><div class="language-haskell line-numbers-mode" data-ext="haskell"><pre class="language-haskell"><code><span class="token comment">-- file: ch07/return1.hs</span>
<span class="token import-statement"><span class="token keyword">import</span> Data<span class="token punctuation">.</span>Char</span><span class="token punctuation">(</span><span class="token builtin">toUpper</span><span class="token punctuation">)</span>

<span class="token hvariable">isGreen</span> <span class="token operator">::</span> <span class="token constant">IO</span> <span class="token constant">Bool</span>
<span class="token hvariable">isGreen</span> <span class="token operator">=</span>
    <span class="token keyword">do</span> <span class="token builtin">putStrLn</span> <span class="token string">&quot;Is green your favorite color?&quot;</span>
       <span class="token hvariable">inpStr</span> <span class="token operator">&lt;-</span> <span class="token builtin">getLine</span>
       <span class="token builtin">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">toUpper</span> <span class="token operator">.</span> <span class="token builtin">head</span> <span class="token operator">$</span> <span class="token hvariable">inpStr</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token char string">&#39;Y&#39;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æˆ‘ä»¬æœ‰ä¸€ä¸ªçº¯çš„è®¡ç®—äº§ç”Ÿä¸€ä¸ª <code>Bool</code> ï¼Œè¿™ä¸ªè®¡ç®—ä¼ ç»™äº† <code>return</code> ï¼Œ <code>return</code> æŠŠå®ƒæ”¾è¿›äº† <code>IO</code> Monadã€‚ å› ä¸ºå®ƒæ˜¯ <code>do</code> ä»£ç å—çš„æœ€åä¸€ä¸ªå€¼ï¼Œæ‰€ä»¥å®ƒå˜æˆ <code>isGreen</code> çš„è¿”å›å€¼ï¼Œè€Œä¸æ˜¯å› ä¸ºæˆ‘ä»¬ç”¨äº† <code>return</code> å‡½æ•°ã€‚</p><p>è¿™æœ‰ä¸€ä¸ªç›¸åŒç¨‹åºä½†æ˜¯æŠŠçº¯è®¡ç®—ç§»åˆ°ä¸€ä¸ªå•ç‹¬çš„å‡½æ•°é‡Œçš„ç‰ˆæœ¬ã€‚è¿™å¸®åŠ©çº¯ä»£ç ä¿æŒåˆ†ç¦»ï¼Œå¹¶ä¸”è®©æ„å›¾æ›´æ¸…æ™°ã€‚</p><div class="language-haskell line-numbers-mode" data-ext="haskell"><pre class="language-haskell"><code><span class="token comment">-- file: ch07/return2.hs</span>
<span class="token import-statement"><span class="token keyword">import</span> Data<span class="token punctuation">.</span>Char</span><span class="token punctuation">(</span><span class="token builtin">toUpper</span><span class="token punctuation">)</span>

<span class="token hvariable">isYes</span> <span class="token operator">::</span> <span class="token constant">String</span> <span class="token operator">-&gt;</span> <span class="token constant">Bool</span>
<span class="token hvariable">isYes</span> <span class="token hvariable">inpStr</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token builtin">toUpper</span> <span class="token operator">.</span> <span class="token builtin">head</span> <span class="token operator">$</span> <span class="token hvariable">inpStr</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token char string">&#39;Y&#39;</span>

<span class="token hvariable">isGreen</span> <span class="token operator">::</span> <span class="token constant">IO</span> <span class="token constant">Bool</span>
<span class="token hvariable">isGreen</span> <span class="token operator">=</span>
    <span class="token keyword">do</span> <span class="token builtin">putStrLn</span> <span class="token string">&quot;Is green your favorite color?&quot;</span>
       <span class="token hvariable">inpStr</span> <span class="token operator">&lt;-</span> <span class="token builtin">getLine</span>
       <span class="token builtin">return</span> <span class="token punctuation">(</span><span class="token hvariable">isYes</span> <span class="token hvariable">inpStr</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æœ€åï¼Œæœ‰ä¸€ä¸ªäººä¸ºçš„ä¾‹å­ï¼Œè¿™ä¸ªä¾‹å­æ˜¾ç¤ºäº† <code>return</code> ç¡®å®æ²¡æœ‰åœ¨ <code>do</code> ä»£ç å—çš„ç»“å°¾å‡ºç°ã€‚ åœ¨å®è·µä¸­ï¼Œé€šå¸¸æ˜¯è¿™æ ·çš„ï¼Œä½†æ˜¯ä¸ä¸€å®šéœ€è¦è¿™æ ·ã€‚</p><div class="language-haskell line-numbers-mode" data-ext="haskell"><pre class="language-haskell"><code><span class="token comment">-- file: ch07/return3.hs</span>
<span class="token hvariable">returnTest</span> <span class="token operator">::</span> <span class="token constant">IO</span> <span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token hvariable">returnTest</span> <span class="token operator">=</span>
    <span class="token keyword">do</span> <span class="token hvariable">one</span> <span class="token operator">&lt;-</span> <span class="token builtin">return</span> <span class="token number">1</span>
       <span class="token keyword">let</span> <span class="token hvariable">two</span> <span class="token operator">=</span> <span class="token number">2</span>
       <span class="token builtin">putStrLn</span> <span class="token operator">$</span> <span class="token builtin">show</span> <span class="token punctuation">(</span><span class="token hvariable">one</span> <span class="token operator">+</span> <span class="token hvariable">two</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ³¨æ„ï¼Œæˆ‘ä»¬ç”¨äº† <code>&lt;-</code> å’Œ <code>return</code> çš„ç»„åˆï¼Œä½†æ˜¯ <code>let</code> æ˜¯å’Œç®€å•å­—é¢é‡ç»„åˆçš„ã€‚ è¿™æ˜¯å› ä¸ºæˆ‘ä»¬éœ€è¦éƒ½æ˜¯çº¯çš„å€¼æ‰èƒ½å»ç›¸åŠ å®ƒä»¬ï¼Œ <code>&lt;-</code> æŠŠä¸œè¥¿ä»Monadé‡Œé¢æ‹¿å‡ºæ¥ï¼Œå®é™…ä¸Šå°±æ˜¯ <code>return</code> çš„åä½œç”¨ã€‚ åœ¨ <strong>ghci</strong> è¿è¡Œä¸€ä¸‹ï¼Œä½ ä¼šçœ‹åˆ°å’Œé¢„æœŸä¸€æ ·æ˜¾ç¤º3ã€‚</p><h2 id="haskell-å®é™…ä¸Šæ˜¯å‘½ä»¤å¼çš„å—" tabindex="-1"><a class="header-anchor" href="#haskell-å®é™…ä¸Šæ˜¯å‘½ä»¤å¼çš„å—" aria-hidden="true">#</a> Haskell å®é™…ä¸Šæ˜¯å‘½ä»¤å¼çš„å—ï¼Ÿ</h2><p>è¿™äº› <code>do</code> ä»£ç å—å¯èƒ½çœ‹èµ·æ¥å¾ˆåƒä¸€ä¸ªå‘½ä»¤å¼è¯­è¨€ï¼Ÿæ¯•ç«Ÿå¤§éƒ¨åˆ†æ—¶é—´ä½ ç»™äº†ä¸€äº›å‘½ä»¤æŒ‰é¡ºåºè¿è¡Œã€‚</p><p>ä½†æ˜¯Haskellåœ¨å®ƒçš„æ ¸å¿ƒä¸Šæ˜¯ä¸€ä¸ªæƒ°æ€§è¯­è¨€ã€‚æ—¶å¸¸åœ¨éœ€è¦ç»™I/Oä¸²è”æ“ä½œçš„æ—¶å€™ï¼Œæ˜¯ç”±ä¸€äº›å·¥å…·å®Œæˆçš„ï¼Œè¿™äº›å·¥å…·å°±æ˜¯Haskellçš„ä¸€éƒ¨åˆ†ã€‚Haskellé€šè¿‡ <code>I/O</code> Monadå®ç°äº†å‡ºè‰²çš„I/Oå’Œè¯­è¨€å‰©ä½™éƒ¨åˆ†çš„åˆ†ç¦»ã€‚</p><h2 id="æƒ°æ€§i-oçš„å‰¯ä½œç”¨" tabindex="-1"><a class="header-anchor" href="#æƒ°æ€§i-oçš„å‰¯ä½œç”¨" aria-hidden="true">#</a> æƒ°æ€§I/Oçš„å‰¯ä½œç”¨</h2><p>æœ¬ç« å‰é¢ä½ çœ‹åˆ°äº† <code>hGetContents</code> ï¼Œæˆ‘ä»¬è§£é‡Šè¯´å®ƒè¿”å›çš„ <code>String</code> å¯ä»¥åœ¨çº¯ä»£ç ä¸­ä½¿ç”¨ã€‚</p><p>å…³äºå‰¯ä½œç”¨æˆ‘ä»¬éœ€è¦å¾—åˆ°ä¸€äº›æ›´å…·ä½“çš„ä¸œè¥¿ã€‚å½“æˆ‘ä»¬è¯´Haskellæ²¡æœ‰å‰¯ä½œç”¨ï¼Œè¿™åˆ°åº•æ„å‘³ç€ä»€ä¹ˆï¼Ÿ</p><p>åœ¨ä¸€å®šç¨‹åº¦ä¸Šï¼Œå‰¯ä½œç”¨æ€»æ˜¯å¯èƒ½çš„ã€‚ä¸€ä¸ªå†™çš„ä¸å¥½çš„å¾ªç¯ï¼Œå°±ç®—å†™æˆçº¯ä»£ç å½¢å¼çš„ï¼Œä¹Ÿä¼šé€ æˆç³»ç»Ÿå†…å­˜è€—å°½å’Œæœºå™¨å´©æºƒï¼Œæˆ–è€…å¯¼è‡´æ•°æ®äº¤æ¢åˆ°ç¡¬ç›˜ä¸Šã€‚</p><p>å½“æˆ‘ä»¬è¯´æ²¡æœ‰å‰¯ä½œç”¨çš„æ—¶å€™ï¼Œæˆ‘ä»¬æ„æ€æ˜¯ï¼ŒHaskellä¸­çš„çº¯ä»£ç ä¸èƒ½è¿è¡Œé‚£äº›èƒ½è§¦å‘å‰¯ä½œç”¨çš„å‘½ä»¤ã€‚çº¯å‡½æ•°ä¸èƒ½ä¿®æ”¹å…¨å±€å˜é‡ï¼Œè¯·æ±‚I/Oï¼Œæˆ–è€…è¿è¡Œä¸€æ¡å…³é—­ç³»ç»Ÿçš„å‘½ä»¤ã€‚</p><p>å½“ä½ æœ‰ä» <code>hGetContents</code> æ‹¿åˆ°ä¸€ä¸ª <code>String</code>ï¼Œä½ æŠŠå®ƒä¼ ç»™ä¸€ä¸ªçº¯å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°ä¸çŸ¥é“è¿™ä¸ª <code>String</code> æ˜¯ç”±ç¡¬ç›˜æ–‡ä»¶ä¸Šæ¥çš„ã€‚è¿™ä¸ªå‡½æ•°è¡¨ç°åœ°è¿˜æ˜¯å’ŒåŸæ¥ä¸€æ ·ï¼Œä½†æ˜¯å¤„ç†é‚£ä¸ª <code>String</code>çš„æ—¶å€™å¯èƒ½é€ æˆç¯å¢ƒå‘å‡ºI/Oå‘½ä»¤ã€‚çº¯å‡½æ•°æ˜¯ä¸ä¼šå‘å‡ºI/Oå‘½ä»¤çš„ï¼Œå®ƒä»¬ä½œä¸ºå¤„ç†æ­£åœ¨è¿è¡Œçš„çº¯å‡½æ•°çš„ä¸€ä¸ªç»“æœï¼Œå°±å’Œäº¤æ¢å†…å­˜åˆ°ç£ç›˜çš„ä¾‹å­ä¸€æ ·ã€‚</p><p>æœ‰æ—¶å€™ï¼Œä½ åœ¨I/Oå‘ç”Ÿæ—¶éœ€è¦æ›´å¤šçš„æ§åˆ¶ã€‚å¯èƒ½ä½ æ­£åœ¨ä»ç”¨æˆ·é‚£é‡Œäº¤äº’åœ°è¯»å–æ•°æ®ï¼Œæˆ–è€…é€šè¿‡ç®¡é“ä»å¦ä¸€ä¸ªç¨‹åºè¯»å–æ•°æ®ï¼Œä½ éœ€è¦ç›´æ¥å’Œç”¨æˆ·äº¤æµã€‚åœ¨è¿™äº›æ—¶å€™ï¼Œ <code>hGetContents</code> å¯èƒ½å°±ä¸åˆé€‚äº†ã€‚</p><h2 id="ç¼“å†²åŒº-buffering" tabindex="-1"><a class="header-anchor" href="#ç¼“å†²åŒº-buffering" aria-hidden="true">#</a> ç¼“å†²åŒºï¼ˆBufferingï¼‰</h2><p>I/Oå­ç³»ç»Ÿæ˜¯ç°ä»£è®¡ç®—æœºä¸­æœ€æ…¢çš„éƒ¨åˆ†ä¹‹ä¸€ã€‚å®Œæˆä¸€æ¬¡å†™ç£ç›˜çš„æ—¶é—´æ˜¯ä¸€æ¬¡å†™å†…å­˜çš„å‡ åƒå€ã€‚åœ¨ç½‘ç»œä¸Šçš„å†™å…¥è¿˜è¦æ…¢æˆç™¾ä¸Šåƒå€ã€‚å°±ç®—ä½ çš„æ“ä½œæ²¡æœ‰ç›´æ¥å’Œç£ç›˜é€šä¿¡ï¼Œå¯èƒ½æ•°æ®è¢«ç¼“å­˜äº†ï¼ŒI/Oè¿˜æ˜¯éœ€è¦ä¸€ä¸ªç³»ç»Ÿè°ƒç”¨ï¼Œè¿™ä¸ªä¹Ÿä¼šå‡æ…¢é€Ÿåº¦ã€‚</p><p>ç”±äºè¿™ä¸ªåŸå› ï¼Œç°ä»£æ“ä½œç³»ç»Ÿå’Œç¼–ç¨‹è¯­è¨€éƒ½æä¾›äº†å·¥å…·æ¥å¸®åŠ©ç¨‹åºå½“æ¶‰åŠåˆ°I/Oçš„æ—¶å€™æ›´å¥½åœ°è¿è¡Œã€‚æ“ä½œç³»ç»Ÿä¸€èˆ¬é‡‡ç”¨ç¼“å­˜ï¼ˆCacheï¼‰ï¼ŒæŠŠé¢‘ç¹ä½¿ç”¨çš„æ•°æ®ç‰‡æ®µä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œè¿™æ ·å°±èƒ½æ›´å¿«çš„è®¿é—®äº†ã€‚</p><p>ç¼–ç¨‹è¯­è¨€é€šå¸¸é‡‡ç”¨ç¼“å†²åŒºã€‚å°±æ˜¯è¯´ï¼Œå®ƒä»¬å¯èƒ½ä»æ“ä½œç³»ç»Ÿè¯·æ±‚ä¸€å¤§å—æ•°æ®ï¼Œå°±ç®—åº•å±‚ä»£ç æ˜¯ä¸€æ¬¡ä¸€ä¸ªå­—èŠ‚åœ°å¤„ç†æ•°æ®çš„ã€‚é€šè¿‡è¿™æ ·ï¼Œå®ƒä»¬å¯ä»¥å®ç°æ˜¾è‘—çš„æ€§èƒ½æå‡ï¼Œå› ä¸ºæ¯æ¬¡å‘æ“ä½œç³»ç»Ÿçš„I/Oè¯·æ±‚å¸¦æ¥ä¸€æ¬¡å¤„ç†å¼€é”€ã€‚ç¼“å†²åŒºå…è®¸æˆ‘ä»¬ä»¥å°‘å¾—å¤šçš„I/Oè¯·æ±‚æ¬¡æ•°å»è¯»å–ç›¸åŒæ•°é‡çš„æ•°æ®ã€‚</p><h3 id="ç¼“å†²åŒºæ¨¡å¼" tabindex="-1"><a class="header-anchor" href="#ç¼“å†²åŒºæ¨¡å¼" aria-hidden="true">#</a> ç¼“å†²åŒºæ¨¡å¼</h3><p>Haskellä¸­æœ‰3ç§ä¸åŒçš„ç¼“å†²åŒºæ¨¡å¼ï¼Œå®ƒä»¬å®šä¹‰æˆ <code>BufferMode</code> ç±»å‹ï¼š<code>NoBuffering</code> ï¼Œ <code>LineBuffering</code> å’Œ <code>BlockBuffering</code> ã€‚</p><p><code>NoBuffering</code> å°±å’Œå®ƒå¬èµ·æ¥é‚£æ ·-æ²¡æœ‰ç¼“å†²åŒºã€‚ é€šè¿‡åƒ <code>hGetLine</code> è¿™æ ·çš„å‡½æ•°è¯»å–çš„æ•°æ®æ˜¯ä»æ“ä½œç³»ç»Ÿä¸€æ¬¡ä¸€ä¸ªå­—ç¬¦è¯»å–çš„ã€‚å†™å…¥çš„æ•°æ®ä¼šç«‹å³å†™å…¥ï¼Œä¹Ÿæ˜¯ä¸€æ¬¡ä¸€ä¸ªå­—ç¬¦åœ°å†™å…¥ã€‚ å› æ­¤ï¼Œ <code>NoBuffering</code> é€šå¸¸æ€§èƒ½å¾ˆå·®ï¼Œä¸é€‚ç”¨äºä¸€èˆ¬ç›®çš„çš„ä½¿ç”¨ã€‚</p><p><code>LineBuffering</code> å½“æ¢è¡Œç¬¦è¾“å‡ºçš„æ—¶å€™ä¼šè®©è¾“å‡ºç¼“å†²åŒºå†™å…¥ï¼Œæˆ–è€…å½“ç¼“å†²åŒºå¤ªå¤§çš„æ—¶å€™ã€‚åœ¨è¾“å…¥ä¸Šï¼Œå®ƒé€šå¸¸è¯•å›¾å»è¯»å–å—ä¸Šæ‰€æœ‰å¯ç”¨çš„å­—ç¬¦ï¼Œç›´åˆ°å®ƒé¦–æ¬¡é‡åˆ°æ¢è¡Œç¬¦ã€‚å½“ä»ç»ˆç«¯è¯»å–çš„æ—¶å€™ï¼Œæ¯æ¬¡æŒ‰ä¸‹å›è½¦ä¹‹åå®ƒä¼šç«‹å³è¿”å›æ•°æ®ã€‚è¿™ä¸ªæ¨¡å¼ç»å¸¸æ˜¯é»˜è®¤æ¨¡å¼ã€‚</p><p><code>BlockBuffering</code> è®©Haskellåœ¨å¯èƒ½çš„æ—¶å€™ä»¥ä¸€ä¸ªå›ºå®šçš„å—å¤§å°è¯»å–æˆ–è€…å†™å…¥æ•°æ®ã€‚è¿™åœ¨æ‰¹å¤„ç†å¤§é‡æ•°æ®çš„æ—¶å€™æ˜¯æ€§èƒ½æœ€å¥½çš„ï¼Œå°±ç®—æ•°æ®æ˜¯ä»¥è¡Œå­˜å‚¨çš„ä¹Ÿæ˜¯ä¸€æ ·ã€‚ç„¶è€Œï¼Œè¿™ä¸ªå¯¹äºäº¤äº’ç¨‹åºä¸èƒ½ç”¨ï¼Œå› ä¸ºå®ƒä¼šé˜»å¡è¾“å…¥ç›´åˆ°ä¸€æ•´å—æ•°æ®è¢«è¯»å–ã€‚<code>BlockBuffering</code> æ¥å—ä¸€ä¸ª <code>Maybe</code> ç±»å‹çš„å‚æ•°ï¼š å¦‚æœæ˜¯ <code>Nothing</code> ï¼Œå®ƒä¼šä½¿ç”¨ä¸€ä¸ªè‡ªå®šçš„ç¼“å†²åŒºå¤§å°ï¼Œæˆ–è€…ä½ å¯ä»¥ä½¿ç”¨ä¸€ä¸ªåƒ <code>Just 4096</code> çš„è®¾å®šï¼Œè®¾ç½®ç¼“å†²åŒºå¤§å°ä¸º4096ä¸ªå­—èŠ‚ã€‚</p><p>é»˜è®¤çš„ç¼“å†²åŒºæ¨¡å¼ä¾èµ–äºæ“ä½œç³»ç»Ÿå’ŒHaskellçš„å®ç°ã€‚ ä½ å¯ä»¥é€šè¿‡è°ƒç”¨<code>hGetBuffering</code> æŸ¥çœ‹ç³»ç»Ÿçš„å½“å‰ç¼“å†²åŒºæ¨¡å¼ã€‚ å½“å‰çš„æ¨¡å¼å¯ä»¥é€šè¿‡ <code>hSetBuffering</code> æ¥è®¾ç½®ï¼Œå®ƒæ¥å—ä¸€ä¸ª <code>Handle</code> å’Œ <code>BufferMode</code> ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥å†™ <code>hSetBuffering stdin (BlockBuffering Nothing)</code> ã€‚</p><h3 id="åˆ·æ–°ç¼“å†²åŒº" tabindex="-1"><a class="header-anchor" href="#åˆ·æ–°ç¼“å†²åŒº" aria-hidden="true">#</a> åˆ·æ–°ç¼“å†²åŒº</h3><p>å¯¹äºä»»ä½•ç±»å‹çš„ç¼“å†²åŒºï¼Œä½ å¯èƒ½æœ‰æ—¶å€™éœ€è¦å¼ºåˆ¶Haskellå»å†™å‡ºæ‰€æœ‰ä¿å­˜åœ¨ç¼“å†²åŒºé‡Œçš„æ•°æ®ã€‚æœ‰äº›æ—¶å€™è¿™ä¸ªä¼šè‡ªåŠ¨å‘ç”Ÿï¼šæ¯”å¦‚ï¼Œå¯¹ <code>hClose</code> çš„è°ƒç”¨ã€‚ æœ‰æ—¶å€™ä½ å¯èƒ½éœ€è¦è°ƒç”¨ <code>hFlush</code> ä½œä¸ºä»£æ›¿ï¼Œ <code>hFlush</code> ä¼šå¼ºåˆ¶æ‰€æœ‰ç­‰å¾…çš„æ•°æ®ç«‹å³å†™å…¥ã€‚è¿™åœ¨å¥æŸ„æ˜¯ä¸€ä¸ªç½‘ç»œå¥—æ¥å­—çš„æ—¶å€™ï¼Œä½ æƒ³æ•°æ®è¢«ç«‹å³ä¼ è¾“ï¼Œæˆ–è€…ä½ æƒ³è®©ç£ç›˜çš„æ•°æ®ç»™å…¶ä»–ç¨‹åºä½¿ç”¨ï¼Œè€Œå…¶ä»–ç¨‹åºä¹Ÿæ­£åœ¨å¹¶å‘åœ°è¯»é‚£äº›æ•°æ®çš„æ—¶å€™éƒ½æ˜¯æœ‰ç”¨çš„ã€‚</p><h2 id="è¯»å–å‘½ä»¤è¡Œå‚æ•°" tabindex="-1"><a class="header-anchor" href="#è¯»å–å‘½ä»¤è¡Œå‚æ•°" aria-hidden="true">#</a> è¯»å–å‘½ä»¤è¡Œå‚æ•°</h2><p>å¾ˆå¤šå‘½ä»¤è¡Œç¨‹åºå–œæ¬¢é€šè¿‡å‘½ä»¤è¡Œæ¥ä¼ é€’å‚æ•°ã€‚<code>System.Environment.getArgs</code> è¿”å› <code>IO [String]</code> åˆ—å‡ºæ¯ä¸ªå‚æ•°ã€‚</p><p>è¿™å’ŒCè¯­è¨€çš„ <code>argv</code> ä¸€æ ·ï¼Œä» <code>argv[1]</code> å¼€å§‹ã€‚ ç¨‹åºçš„åå­—ï¼ˆCè¯­è¨€çš„ <code>argv[0]</code> ï¼‰ç”¨ <code>System.Environment.getProgName</code> å¯ä»¥å¾—åˆ°ã€‚</p><p><code>System.Console.GetOpt</code> æ¨¡å—æä¾›äº†ä¸€äº›è§£æå‘½ä»¤è¡Œé€‰é¡¹çš„å·¥å…·ã€‚å¦‚æœä½ æœ‰ä¸€ä¸ªç¨‹åºï¼Œå®ƒæœ‰å¾ˆå¤æ‚çš„é€‰é¡¹ï¼Œä½ ä¼šè§‰å¾—å®ƒå¾ˆæœ‰ç”¨ã€‚ ä½ å¯ä»¥åœ¨ <a href="">å‘½ä»¤è¡Œè§£æ</a> ä¸€èŠ‚çœ‹åˆ°ä¸€ä¸ªä¾‹å­å’Œä½¿ç”¨æ–¹æ³•ã€‚</p><h2 id="ç¯å¢ƒå˜é‡" tabindex="-1"><a class="header-anchor" href="#ç¯å¢ƒå˜é‡" aria-hidden="true">#</a> ç¯å¢ƒå˜é‡</h2><p>å¦‚æœä½ éœ€è¦é˜…è¯»ç¯å¢ƒå˜é‡ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>System.Environment</code> é‡Œé¢ä¸¤ä¸ªå‡½æ•°ä¸­çš„ä¸€ä¸ªï¼š <code>getEnv</code> æˆ–è€… <code>getEnvironment</code> ã€‚</p><p><code>getEnv</code> æŸ¥æ‰¾æŒ‡å®šçš„å˜é‡ï¼Œå¦‚æœä¸å­˜åœ¨ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚ <code>getEnvironment</code> ç”¨ä¸€ä¸ª <code>[(String, String)]</code> è¿”å›æ•´ä¸ªç¯å¢ƒï¼Œç„¶åä½ å¯ä»¥ç”¨ <code>lookup</code> è¿™æ ·çš„å‡½æ•°æ¥æ‰¾ä½ æƒ³è¦çš„ç¯å¢ƒæ¡ç›®ã€‚</p><p>åœ¨Haskellè®¾ç½®ç¯å¢ƒå˜é‡æ²¡æœ‰é‡‡ç”¨è·¨å¹³å°çš„æ–¹å¼æ¥å®šä¹‰ã€‚å¦‚æœä½ åœ¨åƒLinuxè¿™æ ·çš„POSIXå¹³å°ä¸Šï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>System.Posix.Env</code> æ¨¡å—ä¸­çš„ <code>putEnv</code> æˆ–è€… <code>setEnv</code> ã€‚ ç¯å¢ƒè®¾ç½®åœ¨Windowsä¸‹é¢æ²¡æœ‰å®šä¹‰ã€‚</p></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/vuepress-theme-hope/vuepress-theme-hope/edit/main/docs/å­¦ä¹ /Haskellä¸­æ–‡æ–‡æ¡£/7.md" rel="noopener noreferrer" target="_blank" aria-label="ç¼–è¾‘æ­¤é¡µ" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->ç¼–è¾‘æ­¤é¡µ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item git-info"><div class="update-time"><span class="label">ä¸Šæ¬¡ç¼–è¾‘äº: </span><!----></div><div class="contributors"><span class="label">è´¡çŒ®è€…: </span><!--[--><!--[--><span class="contributor" title="email: 61403802+hahg2000@users.noreply.github.com">hahg2000</span><!--]--><!--]--></div></div></footer><nav class="page-nav"><a href="/%E5%AD%A6%E4%B9%A0/Haskell%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/6.html" class="nav-link prev" aria-label="ç¬¬ 6 ç« ï¼šä½¿ç”¨ç±»å‹ç±»"><div class="hint"><span class="arrow start"></span>ä¸Šä¸€é¡µ</div><div class="link"><!---->ç¬¬ 6 ç« ï¼šä½¿ç”¨ç±»å‹ç±»</div></a><a href="/%E5%AD%A6%E4%B9%A0/Haskell%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/8.html" class="nav-link next" aria-label="ç¬¬ 8 ç« ï¼šé«˜æ•ˆæ–‡ä»¶å¤„ç†ã€æ­£åˆ™è¡¨è¾¾å¼ã€æ–‡ä»¶ååŒ¹é…"><div class="hint">ä¸‹ä¸€é¡µ<span class="arrow end"></span></div><div class="link">ç¬¬ 8 ç« ï¼šé«˜æ•ˆæ–‡ä»¶å¤„ç†ã€æ­£åˆ™è¡¨è¾¾å¼ã€æ–‡ä»¶ååŒ¹é…<!----></div></a></nav><div class="giscus-wrapper input-top" id="comment" style="display:block;"><div class="loading-icon-wrapper" style="display:flex;align-items:center;justify-content:center;height:96px"><svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" preserveAspectRatio="xMidYMid" viewBox="25 25 50 50"><animateTransform attributeName="transform" type="rotate" dur="2s" keyTimes="0;1" repeatCount="indefinite" values="0;360"></animateTransform><circle cx="50" cy="50" r="20" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round"><animate attributeName="stroke-dasharray" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="1,200;90,200;1,200"></animate><animate attributeName="stroke-dashoffset" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="0;-35px;-125px"></animate></circle></svg></div></div><!----><!--]--></main><!--]--><!----></div><!--]--><!--]--><!----><!--]--></div>
    <script type="module" src="/assets/app-2f283e0c.js" defer></script>
  </body>
</html>
