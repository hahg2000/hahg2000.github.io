# 错题一

## 一、可以继承的CSS属性

原题链接：https://www.nowcoder.com/questionTerminal/7642837ccba6435baedbe62cfb4ed187

>下列哪些属性是不可以被继承的()
>
>A. margin
>
>B. position
>
>C. float
>
>D. font-size

答案：ABC 

----

题目的意思是：当父元素设置为以下哪个属性时，其子元素不会有影响

A 选项：设置的是 `margin` ，而子元素在内容区域，设置 `margin` 不会影响子元素，子元素也不会继承

B 选项：如果父元素设置了 `position: absolute` ，其子元素设置定位位置 `top: 300px;` 是没有用的，依然要在子元素设置 `position` 属性

C 选项：父元素设置了浮动，不会影响子元素的浮动状态

D 选项：当父元素设置字体大小，其子元素不设置字体大小，则会自动继承父元素的字体大小

## 二、标签嵌套规范

原题链接：https://www.nowcoder.com/questionTerminal/928c7583fc3b4084929504a69ef6c856

>  下列HTML代码中符合HTML5嵌套规范的是 ：

```html
A. 
<p>
  <a href="some link">
    <p>some text</p>
  </a>
</p>
```

```html
B.
<button type="submit">
  <a href="some link">some text</a>
</button>
```

```html
C.
<table>
  <caption>some title</caption>
  <tbody>
    <tr>
      <th>some text</th>
      <td>some text</td>
    </tr>
  </tbody>
</table>
```

```html
D.
<dl>
  <dt>
    <h1>some title</h1>
  </dt>
  <dd>
    <p>some text</p>
    <p>some text</p>
  </dd>
</dl>
```

答案：C

----

A 选项：`<p>` 里面不能有 `<p>`，如果这样写的话，浏览器不会按照写的显示 HTML 元素。

```html
<!-- 错误写法
<p>
	<p>some text</p>
</p> 
-->

<!-- 显示效果 -->
<p> </p>
<p>some text</p>
```

B 选项：`<button>` 里不推荐使用 `<a>` ，因为样式看起来会冲突，按钮里面的字体是链接样式。而如果换过来，就只会有按钮的样式。

```html
<a href="https://www.baidu.com/">
  <button>百度</button>
</a>
```

D 选项：`<dt>`、`<th>` 不推荐嵌套`<header>`、`<footer>`、区块型元素(sectioning content)、标题型元素(heading content)

## 三、jQuery的滑入滑出

原题链接：https://www.nowcoder.com/questionTerminal/7213136dc8fc4474b2b613377c59c091

> 如果想要让一个 p 标签，在1s内缓慢的以滑动方式隐藏，要怎么实现：
>
> ```js
> A. $("p").slideUp(1000);
> B. $("p").slideDown(1000);
> C. $("p").mergeUp(1000);
> D. $("p").mergeDown(1000); 
> ```

A. `slideUp`  通过高度变化（向上减小）来隐藏元素

B. `slideDown` 通过高度变化（向下增大）来显示元素  

`slideToggle` ： 通过高度变化来切换元素的可见性 

## 四、已废弃的acronym

原题链接：https://www.nowcoder.com/questionTerminal/5f8173bcbb36406287844f7edcb9515d

>  HTML5 中不再支持下面哪个元素？ 
>
> ```html
> A. <cite>
> B. <acronym>
> C. <abbr>
> D. <base>
> ```

A 选项： `<cite>` 表示一个作品的引用，且必须包含作品的标题，样式是斜体。

B 和 C 选项：都表明该标签里的单词构成缩写或简略语， `<acronym>` 被弃用，改成使用 `<abbr>`

D 选项：`<base>`  定义一个文档中所有相对 URL 的根 URL 。

## 五、jQuery查找所有子孙节点

原题链接：https://www.nowcoder.com/questionTerminal/fab75dedaee14a08ab1eb08c266aee88

> 给定下面代码： 怎么能够取得 ”wrapper” 中全部项的集合？ 
>
> A. `$('#wrapper').children();`
>
> B. `$('#wrapper').html();`
>
> C. `$('#wrapper').contents();`
>
> D. `$('#wrapper').find('all');`

```html
<div id="wrapper">
  <div class="wText">
    <div>a</div>
    <div>b</div>
  </div>

  <div class="wImg">
    <div>a</div>
    <div>b</div>
  </div>

  <div class="wVideo">
    <div>a</div>
    <div>b</div>
  </div>
</div>
```

---

答：C

解析：

+ A 选项：`$('#wrapper').children();` ，只能获取到所有子节点，子孙节点获取不到
+ B 选项：`$('#wrapper').html();` ，可以获取到所有子孙节点，但只是返回字符串
+ C 选项：`$('#wrapper').contents();` ，可以获取到所有子孙节点，也包括文本节点
+ D 选项：`$('#wrapper').find('all');` ；`find()` 方法是用来查找指定的子节点

## 六、空元素

> 以下不属于空元素（void elements）的是： 
>
> A. `embed`
>
> B.  `img`
>
> C.  `address`
>
> D.  `wbr`

---

答案：C

解析：空元素的详细定义：一个空元素（empty element）可能是 HTML，SVG，或者 MathML 里的一个**不能存在子节点**（例如内嵌的元素或者元素内的文本）的element。

简单来说就是不用闭合的标签。例如最常见的 `<input>` 。

而 `<address>` 标签代表 某个人或某个组织（等等）的联系信息，因为联系方式不止一种，所以需要闭合标签，标签里面有多个子标签来代表联系方式。

```html
<p>Contact the author of this page:</p>

<address>
  <a href="mailto:jim@rock.com">jim@rock.com</a><br>
  <a href="tel:+13115552368">(311) 555-2368</a>
</address>
```

## 七、重绘和回流

HTML 在解析时，会同时解析 HTML 文件和 CSS 文件，然后将解析成的 DOM 和 CSSOM 合并成渲染数 Render Tree，接着将每个元素在页面上进行排列，最后将排列的结果显示出来。例如下面流程图。

```flow
st=>start: 开始
HTML=>operation: 解析HTML文件
CSS=>operation: 解析CSS文件
DOM=>operation: 生成DOM
CSSOM=>operation: 生成CSSOM
RT=>operation: 合并成渲染树
Layout=>operation: 进行元素排列
Paint=>operation: 进行页面绘制
e=>end: 结束
para=>parallel: 解析文件

st->para
para(path1, bottom)->CSS
para(path2)->HTML
HTML->DOM
CSS->CSSOM
DOM->RT
CSSOM->RT
RT->Layout
Layout->Paint
Paint->e
```

+ 回流
  - 当更改影响布局时发生，对元素进行重新排列。
  - 触发示例：`width` ， `position` ， `float`.
  - 重新计算位置和尺寸。
  - 影响更大，更改单个元素会影响所有子元素、祖先元素和兄弟姐妹或整个文档。
+ 重绘
  - 当更改影响可见性时发生，对元素重新绘制。
  - 触发示例：`opacity` ， `color`, ，`background-color` ， `visibility` 。

根据上面流程图可知，当触发回流时，也会触发重绘，所以我们要尽量避免回流。避免最大程度的回流的方法：

1. 一次性获取或者修改 CSS 样式

由于每次重排都会造成额外的计算消耗，因此大多数浏览器都会通过队列化修改并批量执行来优化重排过程，简单来说就是先缓存一些修改然后再一次性重排。但当获取到一些 CSS 样式属性时，会直接清空缓存进行重排，以免获取到不正确的值。

获取或者修改下面属性，会强制让页面回流。

- `offsetTop、offsetLeft、offsetWidth、offsetHeight`
- `scrollTop、scrollLeft、scrollWidth、scrollHeight`
- `clientTop、clientLeft、clientWidth、clientHeight`
- `getComputedStyle()`
-  。。。。。
- 详细的可见：https://gist.github.com/paulirish/5d52fb081b3570c81e3a

----

我们应该像下面这样做，一次性获取上面属性，一次性修改上面属性。

参考链接：https://gist.github.com/faressoft/36cdd64faae21ed22948b458e6bf04d5

```js
// 不推荐的修改方式，会触发6次回流
var box1Height = document.getElementById('box1').clientHeight;
document.getElementById('box1').style.height = box1Height + 10 + 'px';

var box2Height = document.getElementById('box2').clientHeight;
document.getElementById('box2').style.height = box2Height + 10 + 'px';

var box3Height = document.getElementById('box3').clientHeight;
document.getElementById('box3').style.height = box3Height + 10 + 'px';

var box4Height = document.getElementById('box4').clientHeight;
document.getElementById('box4').style.height = box4Height + 10 + 'px';

var box5Height = document.getElementById('box5').clientHeight;
document.getElementById('box5').style.height = box5Height + 10 + 'px';

var box6Height = document.getElementById('box6').clientHeight;
document.getElementById('box6').style.height = box6Height + 10 + 'px';

// 推荐的方式，只会触发1次回流
var box1Height = document.getElementById('box1').clientHeight;
var box2Height = document.getElementById('box2').clientHeight;
var box3Height = document.getElementById('box3').clientHeight;
var box4Height = document.getElementById('box4').clientHeight;
var box5Height = document.getElementById('box5').clientHeight;
var box6Height = document.getElementById('box6').clientHeight;

document.getElementById('box1').style.height = box1Height + 10 + 'px';
document.getElementById('box2').style.height = box2Height + 10 + 'px';
document.getElementById('box3').style.height = box3Height + 10 + 'px';
document.getElementById('box4').style.height = box4Height + 10 + 'px';
document.getElementById('box5').style.height = box5Height + 10 + 'px';
document.getElementById('box6').style.height = box6Height + 10 + 'px';
```

也可以直接替换类，而不是一个个替换样式

```js
// 不推荐，虽然现代浏览器都对其做了优化，只会触发一次重排
const el = document.getElementById('test');
el.style.padding = '5px';
el.style.borderLeft = '1px';
el.style.borderRight = '2px';

// 推荐，修改类直接修改多个样式
const el = document.getElementById('test');
el.className += ' active';
```

如果每次我们不需要最新的属性值，可以将循环里的获取属性值的操作提取出来。

```js
// 不推荐写法
function initP() {
    for (let i = 0; i < paragraphs.length; i++) {
        paragraphs[i].style.width = box.offsetWidth + 'px';
    }
}

// 推荐写法
const width = box.offsetWidth;
function initP() {
    for (let i = 0; i < paragraphs.length; i++) {
        paragraphs[i].style.width = width + 'px';
    }
}
```

2. 批量修改 DOM

参考链接：https://segmentfault.com/a/1190000017329980

如果要修改 DOM 的时候，尽量批量修改 DOM，或者在修改 DOM 时隐藏元素

+ 在修改 DOM 时隐藏元素

```js
const ul = document.getElementById('list');
ul.style.display = 'none';
appendDataToElement(ul, data);
ul.style.display = 'block';
```

+ 批量修改 DOM，使用文档碎片（fragment）或者克隆一个脱离文档的节点

```js
const fragment = document.createDocumentFragment();
appendDataToElement(fragment, data);
ul.appendChild(fragment);

const clone = ul.cloneNode(true);
appendDataToElement(clone, data);
ul.parentNode.replaceChild(clone, ul);
```

3. 使用绝对定位让其脱离文档流

对于复杂动画效果，我们可以使用绝对定位，让它脱离文档流。

4. css3硬件加速（GPU加速）

使用 css3 硬件加速，可以让 `transform`、`opacity`、`filters` 这些动画不会引起回流重绘 。但是对于动画的其它属性，比如 `background-color` 这些，还是会引起回流重绘的

## 八、CSS 优先级

>  基于以下 HTML 结构和 CSS 样式，文本 Dijkstra的颜色应该是？ 
>
> ```html
> <ul class="authors" id="favorite">
>   <li><span>Martin</span></li>
>   <li id="related"><span class="highlight"> Dijkstra </span></li>
> </ul>
> <style>
>   ul#related span {
>     color: red;
>   }
> 
>   #favorite .highlight {
>     color: orange;
>   }
> 
>   .highlight {
>     color: black;
>   }
> </style>
> ```

---

答：`orange`

解析：可以参考：https://specifishity.com/

+ 标签选择器、 伪元素选择器 ：0-0-1，每多一个标签选择器就加一，0-0-N
+ 类选择器、属性选择器、 伪类选择器 ：0-1-0
+ ID 选择器：1-0-0
+ 注意计算优先级不进位

根据上面可以计算出：

+ `red` ：1-0-2
+ `orange` ：1-1-0
+ `black` ：0-1-0

